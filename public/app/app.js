/**
 * Copyright Â© 2026, PhotoStructure Inc. All rights reserved.
 *
 * BY USING THIS SOFTWARE, YOU ACCEPT ALL OF THE TERMS IN
 * https://photostructure.com/eula
 * IF YOU DO NOT ACCEPT THESE TERMS, DO NOT USE THIS SOFTWARE
 */
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["Tag.js","Touch.js","Blank.js","Lazy.js","Maybe.js","TagBreadcrumb.vue_vue_type_script_setup_true_lang.js","fe.js","StickyHeader.js","DropDown.vue_vue_type_script_setup_true_lang.js","AssetQuery.js","NavMenuButton.vue_vue_type_script_setup_true_lang.js","Random.js","Asset.js","AssetThumb.vue_vue_type_script_setup_true_lang.js","Search.js"])))=>i.map(i=>d[i]);
import{s as As,d as Ne,u as R,a as Cs,c as L,p as wt,r as T,w as zt,h as Un,n as _s,i as we,b as Is,e as be,f as at,g as Qe,j as $,T as Ps,k as q,l as K,m as g,o as Ie,q as Ts,t as Pe,v as Ls,x as xs,y as Ns,z as je,A as it,_ as x,B as V,C as Ht,D as jt,E as k,F as Gn,G as Os,H as Ds,I as Ms,J as Vs,K as Fs,L as qs,M as Bs,N as Us,O as Gs,P as en,Q as tn,R as Tt,S as zs,U as Hs,V as js,W as Ws,X as Ks,Y as $s,Z as Qs,$ as Ys,a0 as Xs,a1 as Zs}from"./Touch.js";import{i as Js,a as eo,t as zn,b as Hn,c as to,u as nn,d as no,S as so}from"./StickyHeader.js";import{t as sn,b as pe,a as jn,c as Ee,d as ct,i as Lt,e as oo,n as Je,f as ro,g as io,h as lo,m as Wn,r as ao,j as uo,k as xt,l as Te,o as ze,p as co,q as fo,s as ho,u as mo,v as po,w as vo,x as go,y as yo,z as wo,A as Eo,B as bo,C as on,D as ie,E as So,F as Ro,G as ko}from"./Blank.js";import{s as Se,l as le,a as et,b as Ao,d as Co,f as _o}from"./Lazy.js";import{r as Io}from"./Random.js";import{q as Po}from"./fe.js";import{m as te,a as He,b as Et,n as ot,o as rn}from"./Maybe.js";const _e=typeof document<"u";function Kn(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function To(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Kn(e.default)}const D=Object.assign;function bt(e,t){const n={};for(const s in t){const o=t[s];n[s]=ne(o)?o.map(e):e(o)}return n}const We=()=>{},ne=Array.isArray;function ln(e,t){const n={};for(const s in e)n[s]=s in t?t[s]:e[s];return n}const $n=/#/g,Lo=/&/g,xo=/\//g,No=/=/g,Oo=/\?/g,Qn=/\+/g,Do=/%5B/g,Mo=/%5D/g,Yn=/%5E/g,Vo=/%60/g,Xn=/%7B/g,Fo=/%7C/g,Zn=/%7D/g,qo=/%20/g;function Wt(e){return e==null?"":encodeURI(""+e).replace(Fo,"|").replace(Do,"[").replace(Mo,"]")}function Bo(e){return Wt(e).replace(Xn,"{").replace(Zn,"}").replace(Yn,"^")}function Nt(e){return Wt(e).replace(Qn,"%2B").replace(qo,"+").replace($n,"%23").replace(Lo,"%26").replace(Vo,"`").replace(Xn,"{").replace(Zn,"}").replace(Yn,"^")}function Uo(e){return Nt(e).replace(No,"%3D")}function Go(e){return Wt(e).replace($n,"%23").replace(Oo,"%3F")}function zo(e){return Go(e).replace(xo,"%2F")}function Ye(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Ho=/\/$/,jo=e=>e.replace(Ho,"");function St(e,t,n="/"){let s,o={},f="",u="";const v=t.indexOf("#");let r=t.indexOf("?");return r=v>=0&&r>v?-1:r,r>=0&&(s=t.slice(0,r),f=t.slice(r,v>0?v:t.length),o=e(f.slice(1))),v>=0&&(s=s||t.slice(0,v),u=t.slice(v,t.length)),s=Qo(s??t,n),{fullPath:s+f+u,path:s,query:o,hash:Ye(u)}}function Wo(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function an(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Ko(e,t,n){const s=t.matched.length-1,o=n.matched.length-1;return s>-1&&s===o&&Le(t.matched[s],n.matched[o])&&Jn(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function Le(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Jn(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(!$o(e[n],t[n]))return!1;return!0}function $o(e,t){return ne(e)?un(e,t):ne(t)?un(t,e):e?.valueOf()===t?.valueOf()}function un(e,t){return ne(t)?e.length===t.length&&e.every((n,s)=>n===t[s]):e.length===1&&e[0]===t}function Qo(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),s=e.split("/"),o=s[s.length-1];(o===".."||o===".")&&s.push("");let f=n.length-1,u,v;for(u=0;u<s.length;u++)if(v=s[u],v!==".")if(v==="..")f>1&&f--;else break;return n.slice(0,f).join("/")+"/"+s.slice(u).join("/")}const de={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Ot=(function(e){return e.pop="pop",e.push="push",e})({}),Rt=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Yo(e){if(!e)if(_e){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),jo(e)}const Xo=/^[^#]+#/;function Zo(e,t){return e.replace(Xo,"#")+t}function Jo(e,t){const n=document.documentElement.getBoundingClientRect(),s=e.getBoundingClientRect();return{behavior:t.behavior,left:s.left-n.left-(t.left||0),top:s.top-n.top-(t.top||0)}}const ft=()=>({left:window.scrollX,top:window.scrollY});function er(e){let t;if("el"in e){const n=e.el,s=typeof n=="string"&&n.startsWith("#"),o=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;t=Jo(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function cn(e,t){return(history.state?history.state.position-t:-1)+e}const Dt=new Map;function tr(e,t){Dt.set(e,t)}function nr(e){const t=Dt.get(e);return Dt.delete(e),t}function sr(e){return typeof e=="string"||e&&typeof e=="object"}function es(e){return typeof e=="string"||typeof e=="symbol"}let G=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const ts=Symbol("");G.MATCHER_NOT_FOUND+"",G.NAVIGATION_GUARD_REDIRECT+"",G.NAVIGATION_ABORTED+"",G.NAVIGATION_CANCELLED+"",G.NAVIGATION_DUPLICATED+"";function xe(e,t){return D(new Error,{type:e,[ts]:!0},t)}function re(e,t){return e instanceof Error&&ts in e&&(t==null||!!(e.type&t))}const or=["params","query","hash"];function rr(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const n of or)n in e&&(t[n]=e[n]);return JSON.stringify(t,null,2)}function ir(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let s=0;s<n.length;++s){const o=n[s].replace(Qn," "),f=o.indexOf("="),u=Ye(f<0?o:o.slice(0,f)),v=f<0?null:Ye(o.slice(f+1));if(u in t){let r=t[u];ne(r)||(r=t[u]=[r]),r.push(v)}else t[u]=v}return t}function fn(e){let t="";for(let n in e){const s=e[n];if(n=Uo(n),s==null){s!==void 0&&(t+=(t.length?"&":"")+n);continue}(ne(s)?s.map(o=>o&&Nt(o)):[s&&Nt(s)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+n,o!=null&&(t+="="+o))})}return t}function lr(e){const t={};for(const n in e){const s=e[n];s!==void 0&&(t[n]=ne(s)?s.map(o=>o==null?null:""+o):s==null?s:""+s)}return t}const ar=Symbol(""),dn=Symbol(""),dt=Symbol(""),Kt=Symbol(""),Mt=Symbol("");function Ue(){let e=[];function t(s){return e.push(s),()=>{const o=e.indexOf(s);o>-1&&e.splice(o,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function he(e,t,n,s,o,f=u=>u()){const u=s&&(s.enterCallbacks[o]=s.enterCallbacks[o]||[]);return()=>new Promise((v,r)=>{const h=l=>{l===!1?r(xe(G.NAVIGATION_ABORTED,{from:n,to:t})):l instanceof Error?r(l):sr(l)?r(xe(G.NAVIGATION_GUARD_REDIRECT,{from:t,to:l})):(u&&s.enterCallbacks[o]===u&&typeof l=="function"&&u.push(l),v())},m=f(()=>e.call(s&&s.instances[o],t,n,h));let i=Promise.resolve(m);e.length<3&&(i=i.then(h)),i.catch(l=>r(l))})}function kt(e,t,n,s,o=f=>f()){const f=[];for(const u of e)for(const v in u.components){let r=u.components[v];if(!(t!=="beforeRouteEnter"&&!u.instances[v]))if(Kn(r)){const h=(r.__vccOpts||r)[t];h&&f.push(he(h,n,s,u,v,o))}else{let h=r();f.push(()=>h.then(m=>{if(!m)throw new Error(`Couldn't resolve component "${v}" at "${u.path}"`);const i=To(m)?m.default:m;u.mods[v]=m,u.components[v]=i;const l=(i.__vccOpts||i)[t];return l&&he(l,n,s,u,v,o)()}))}}return f}function ur(e,t){const n=[],s=[],o=[],f=Math.max(t.matched.length,e.matched.length);for(let u=0;u<f;u++){const v=t.matched[u];v&&(e.matched.find(h=>Le(h,v))?s.push(v):n.push(v));const r=e.matched[u];r&&(t.matched.find(h=>Le(h,r))||o.push(r))}return[n,s,o]}let cr=()=>location.protocol+"//"+location.host;function ns(e,t){const{pathname:n,search:s,hash:o}=t,f=e.indexOf("#");if(f>-1){let u=o.includes(e.slice(f))?e.slice(f).length:1,v=o.slice(u);return v[0]!=="/"&&(v="/"+v),an(v,"")}return an(n,e)+s+o}function fr(e,t,n,s){let o=[],f=[],u=null;const v=({state:l})=>{const c=ns(e,location),E=n.value,A=t.value;let P=0;if(l){if(n.value=c,t.value=l,u&&u===E){u=null;return}P=A?l.position-A.position:0}else s(c);o.forEach(C=>{C(n.value,E,{delta:P,type:Ot.pop,direction:P?P>0?Rt.forward:Rt.back:Rt.unknown})})};function r(){u=n.value}function h(l){o.push(l);const c=()=>{const E=o.indexOf(l);E>-1&&o.splice(E,1)};return f.push(c),c}function m(){if(document.visibilityState==="hidden"){const{history:l}=window;if(!l.state)return;l.replaceState(D({},l.state,{scroll:ft()}),"")}}function i(){for(const l of f)l();f=[],window.removeEventListener("popstate",v),window.removeEventListener("pagehide",m),document.removeEventListener("visibilitychange",m)}return window.addEventListener("popstate",v),window.addEventListener("pagehide",m),document.addEventListener("visibilitychange",m),{pauseListeners:r,listen:h,destroy:i}}function hn(e,t,n,s=!1,o=!1){return{back:e,current:t,forward:n,replaced:s,position:window.history.length,scroll:o?ft():null}}function dr(e){const{history:t,location:n}=window,s={value:ns(e,n)},o={value:t.state};o.value||f(s.value,{back:null,current:s.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function f(r,h,m){const i=e.indexOf("#"),l=i>-1?(n.host&&document.querySelector("base")?e:e.slice(i))+r:cr()+e+r;try{t[m?"replaceState":"pushState"](h,"",l),o.value=h}catch(c){console.error(c),n[m?"replace":"assign"](l)}}function u(r,h){f(r,D({},t.state,hn(o.value.back,r,o.value.forward,!0),h,{position:o.value.position}),!0),s.value=r}function v(r,h){const m=D({},o.value,t.state,{forward:r,scroll:ft()});f(m.current,m,!0),f(r,D({},hn(s.value,r,null),{position:m.position+1},h),!1),s.value=r}return{location:s,state:o,push:v,replace:u}}function hr(e){e=Yo(e);const t=dr(e),n=fr(e,t.state,t.location,t.replace);function s(f,u=!0){u||n.pauseListeners(),history.go(f)}const o=D({location:"",base:e,go:s,createHref:Zo.bind(null,e)},t,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}let ye=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var H=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(H||{});const mr={type:ye.Static,value:""},pr=/[a-zA-Z0-9_]/;function vr(e){if(!e)return[[]];if(e==="/")return[[mr]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(c){throw new Error(`ERR (${n})/"${h}": ${c}`)}let n=H.Static,s=n;const o=[];let f;function u(){f&&o.push(f),f=[]}let v=0,r,h="",m="";function i(){h&&(n===H.Static?f.push({type:ye.Static,value:h}):n===H.Param||n===H.ParamRegExp||n===H.ParamRegExpEnd?(f.length>1&&(r==="*"||r==="+")&&t(`A repeatable param (${h}) must be alone in its segment. eg: '/:ids+.`),f.push({type:ye.Param,value:h,regexp:m,repeatable:r==="*"||r==="+",optional:r==="*"||r==="?"})):t("Invalid state to consume buffer"),h="")}function l(){h+=r}for(;v<e.length;){if(r=e[v++],r==="\\"&&n!==H.ParamRegExp){s=n,n=H.EscapeNext;continue}switch(n){case H.Static:r==="/"?(h&&i(),u()):r===":"?(i(),n=H.Param):l();break;case H.EscapeNext:l(),n=s;break;case H.Param:r==="("?n=H.ParamRegExp:pr.test(r)?l():(i(),n=H.Static,r!=="*"&&r!=="?"&&r!=="+"&&v--);break;case H.ParamRegExp:r===")"?m[m.length-1]=="\\"?m=m.slice(0,-1)+r:n=H.ParamRegExpEnd:m+=r;break;case H.ParamRegExpEnd:i(),n=H.Static,r!=="*"&&r!=="?"&&r!=="+"&&v--,m="";break;default:t("Unknown state");break}}return n===H.ParamRegExp&&t(`Unfinished custom RegExp for param "${h}"`),i(),u(),o}const mn="[^/]+?",gr={sensitive:!1,strict:!1,start:!0,end:!0};var Q=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Q||{});const yr=/[.+*?^${}()[\]/\\]/g;function wr(e,t){const n=D({},gr,t),s=[];let o=n.start?"^":"";const f=[];for(const h of e){const m=h.length?[]:[Q.Root];n.strict&&!h.length&&(o+="/");for(let i=0;i<h.length;i++){const l=h[i];let c=Q.Segment+(n.sensitive?Q.BonusCaseSensitive:0);if(l.type===ye.Static)i||(o+="/"),o+=l.value.replace(yr,"\\$&"),c+=Q.Static;else if(l.type===ye.Param){const{value:E,repeatable:A,optional:P,regexp:C}=l;f.push({name:E,repeatable:A,optional:P});const S=C||mn;if(S!==mn){c+=Q.BonusCustomRegExp;try{`${S}`}catch(y){throw new Error(`Invalid custom RegExp for param "${E}" (${S}): `+y.message)}}let a=A?`((?:${S})(?:/(?:${S}))*)`:`(${S})`;i||(a=P&&h.length<2?`(?:/${a})`:"/"+a),P&&(a+="?"),o+=a,c+=Q.Dynamic,P&&(c+=Q.BonusOptional),A&&(c+=Q.BonusRepeatable),S===".*"&&(c+=Q.BonusWildcard)}m.push(c)}s.push(m)}if(n.strict&&n.end){const h=s.length-1;s[h][s[h].length-1]+=Q.BonusStrict}n.strict||(o+="/?"),n.end?o+="$":n.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const u=new RegExp(o,n.sensitive?"":"i");function v(h){const m=h.match(u),i={};if(!m)return null;for(let l=1;l<m.length;l++){const c=m[l]||"",E=f[l-1];i[E.name]=c&&E.repeatable?c.split("/"):c}return i}function r(h){let m="",i=!1;for(const l of e){(!i||!m.endsWith("/"))&&(m+="/"),i=!1;for(const c of l)if(c.type===ye.Static)m+=c.value;else if(c.type===ye.Param){const{value:E,repeatable:A,optional:P}=c,C=E in h?h[E]:"";if(ne(C)&&!A)throw new Error(`Provided param "${E}" is an array but it is not repeatable (* or + modifiers)`);const S=ne(C)?C.join("/"):C;if(!S)if(P)l.length<2&&(m.endsWith("/")?m=m.slice(0,-1):i=!0);else throw new Error(`Missing required param "${E}"`);m+=S}}return m||"/"}return{re:u,score:s,keys:f,parse:v,stringify:r}}function Er(e,t){let n=0;for(;n<e.length&&n<t.length;){const s=t[n]-e[n];if(s)return s;n++}return e.length<t.length?e.length===1&&e[0]===Q.Static+Q.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Q.Static+Q.Segment?1:-1:0}function ss(e,t){let n=0;const s=e.score,o=t.score;for(;n<s.length&&n<o.length;){const f=Er(s[n],o[n]);if(f)return f;n++}if(Math.abs(o.length-s.length)===1){if(pn(s))return 1;if(pn(o))return-1}return o.length-s.length}function pn(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const br={strict:!1,end:!0,sensitive:!1};function Sr(e,t,n){const s=wr(vr(e.path),n),o=D(s,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function Rr(e,t){const n=[],s=new Map;t=ln(br,t);function o(i){return s.get(i)}function f(i,l,c){const E=!c,A=gn(i);A.aliasOf=c&&c.record;const P=ln(t,i),C=[A];if("alias"in i){const y=typeof i.alias=="string"?[i.alias]:i.alias;for(const M of y)C.push(gn(D({},A,{components:c?c.record.components:A.components,path:M,aliasOf:c?c.record:A})))}let S,a;for(const y of C){const{path:M}=y;if(l&&M[0]!=="/"){const B=l.record.path,j=B[B.length-1]==="/"?"":"/";y.path=l.record.path+(M&&j+M)}if(S=Sr(y,l,P),c?c.alias.push(S):(a=a||S,a!==S&&a.alias.push(S),E&&i.name&&!yn(S)&&u(i.name)),os(S)&&r(S),A.children){const B=A.children;for(let j=0;j<B.length;j++)f(B[j],S,c&&c.children[j])}c=c||S}return a?()=>{u(a)}:We}function u(i){if(es(i)){const l=s.get(i);l&&(s.delete(i),n.splice(n.indexOf(l),1),l.children.forEach(u),l.alias.forEach(u))}else{const l=n.indexOf(i);l>-1&&(n.splice(l,1),i.record.name&&s.delete(i.record.name),i.children.forEach(u),i.alias.forEach(u))}}function v(){return n}function r(i){const l=Cr(i,n);n.splice(l,0,i),i.record.name&&!yn(i)&&s.set(i.record.name,i)}function h(i,l){let c,E={},A,P;if("name"in i&&i.name){if(c=s.get(i.name),!c)throw xe(G.MATCHER_NOT_FOUND,{location:i});P=c.record.name,E=D(vn(l.params,c.keys.filter(a=>!a.optional).concat(c.parent?c.parent.keys.filter(a=>a.optional):[]).map(a=>a.name)),i.params&&vn(i.params,c.keys.map(a=>a.name))),A=c.stringify(E)}else if(i.path!=null)A=i.path,c=n.find(a=>a.re.test(A)),c&&(E=c.parse(A),P=c.record.name);else{if(c=l.name?s.get(l.name):n.find(a=>a.re.test(l.path)),!c)throw xe(G.MATCHER_NOT_FOUND,{location:i,currentLocation:l});P=c.record.name,E=D({},l.params,i.params),A=c.stringify(E)}const C=[];let S=c;for(;S;)C.unshift(S.record),S=S.parent;return{name:P,path:A,params:E,matched:C,meta:Ar(C)}}e.forEach(i=>f(i));function m(){n.length=0,s.clear()}return{addRoute:f,resolve:h,removeRoute:u,clearRoutes:m,getRoutes:v,getRecordMatcher:o}}function vn(e,t){const n={};for(const s of t)s in e&&(n[s]=e[s]);return n}function gn(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:kr(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function kr(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const s in e.components)t[s]=typeof n=="object"?n[s]:n;return t}function yn(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Ar(e){return e.reduce((t,n)=>D(t,n.meta),{})}function Cr(e,t){let n=0,s=t.length;for(;n!==s;){const f=n+s>>1;ss(e,t[f])<0?s=f:n=f+1}const o=_r(e);return o&&(s=t.lastIndexOf(o,s-1)),s}function _r(e){let t=e;for(;t=t.parent;)if(os(t)&&ss(e,t)===0)return t}function os({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function wn(e){const t=we(dt),n=we(Kt),s=L(()=>{const r=R(e.to);return t.resolve(r)}),o=L(()=>{const{matched:r}=s.value,{length:h}=r,m=r[h-1],i=n.matched;if(!m||!i.length)return-1;const l=i.findIndex(Le.bind(null,m));if(l>-1)return l;const c=En(r[h-2]);return h>1&&En(m)===c&&i[i.length-1].path!==c?i.findIndex(Le.bind(null,r[h-2])):l}),f=L(()=>o.value>-1&&xr(n.params,s.value.params)),u=L(()=>o.value>-1&&o.value===n.matched.length-1&&Jn(n.params,s.value.params));function v(r={}){if(Lr(r)){const h=t[R(e.replace)?"replace":"push"](R(e.to)).catch(We);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>h),h}return Promise.resolve()}return{route:s,href:L(()=>s.value.href),isActive:f,isExactActive:u,navigate:v}}function Ir(e){return e.length===1?e[0]:e}const Pr=Ne({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:wn,setup(e,{slots:t}){const n=Is(wn(e)),{options:s}=we(dt),o=L(()=>({[bn(e.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[bn(e.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const f=t.default&&Ir(t.default(n));return e.custom?f:Un("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},f)}}}),Tr=Pr;function Lr(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function xr(e,t){for(const n in t){const s=t[n],o=e[n];if(typeof s=="string"){if(s!==o)return!1}else if(!ne(o)||o.length!==s.length||s.some((f,u)=>f.valueOf()!==o[u].valueOf()))return!1}return!0}function En(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const bn=(e,t,n)=>e??t??n,Nr=Ne({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const s=we(Mt),o=L(()=>e.route||s.value),f=we(dn,0),u=L(()=>{let h=R(f);const{matched:m}=o.value;let i;for(;(i=m[h])&&!i.components;)h++;return h}),v=L(()=>o.value.matched[u.value]);wt(dn,L(()=>u.value+1)),wt(ar,v),wt(Mt,o);const r=T();return zt(()=>[r.value,v.value,e.name],([h,m,i],[l,c,E])=>{m&&(m.instances[i]=h,c&&c!==m&&h&&h===l&&(m.leaveGuards.size||(m.leaveGuards=c.leaveGuards),m.updateGuards.size||(m.updateGuards=c.updateGuards))),h&&m&&(!c||!Le(m,c)||!l)&&(m.enterCallbacks[i]||[]).forEach(A=>A(h))},{flush:"post"}),()=>{const h=o.value,m=e.name,i=v.value,l=i&&i.components[m];if(!l)return Sn(n.default,{Component:l,route:h});const c=i.props[m],E=c?c===!0?h.params:typeof c=="function"?c(h):c:null,P=Un(l,D({},E,t,{onVnodeUnmounted:C=>{C.component.isUnmounted&&(i.instances[m]=null)},ref:r}));return Sn(n.default,{Component:P,route:h})||P}}});function Sn(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const Or=Nr;function Dr(e){const t=Rr(e.routes,e),n=e.parseQuery||ir,s=e.stringifyQuery||fn,o=e.history,f=Ue(),u=Ue(),v=Ue(),r=As(de);let h=de;_e&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const m=bt.bind(null,p=>""+p),i=bt.bind(null,zo),l=bt.bind(null,Ye);function c(p,b){let w,_;return es(p)?(w=t.getRecordMatcher(p),_=b):_=p,t.addRoute(_,w)}function E(p){const b=t.getRecordMatcher(p);b&&t.removeRoute(b)}function A(){return t.getRoutes().map(p=>p.record)}function P(p){return!!t.getRecordMatcher(p)}function C(p,b){if(b=D({},b||r.value),typeof p=="string"){const d=St(n,p,b.path),I=t.resolve({path:d.path},b),W=o.createHref(d.fullPath);return D(d,I,{params:l(I.params),hash:Ye(d.hash),redirectedFrom:void 0,href:W})}let w;if(p.path!=null)w=D({},p,{path:St(n,p.path,b.path).path});else{const d=D({},p.params);for(const I in d)d[I]==null&&delete d[I];w=D({},p,{params:i(d)}),b.params=i(b.params)}const _=t.resolve(w,b),O=p.hash||"";_.params=m(l(_.params));const U=Wo(s,D({},p,{hash:Bo(O),path:_.path})),N=o.createHref(U);return D({fullPath:U,hash:O,query:s===fn?lr(p.query):p.query||{}},_,{redirectedFrom:void 0,href:N})}function S(p){return typeof p=="string"?St(n,p,r.value.path):D({},p)}function a(p,b){if(h!==p)return xe(G.NAVIGATION_CANCELLED,{from:b,to:p})}function y(p){return j(p)}function M(p){return y(D(S(p),{replace:!0}))}function B(p,b){const w=p.matched[p.matched.length-1];if(w&&w.redirect){const{redirect:_}=w;let O=typeof _=="function"?_(p,b):_;return typeof O=="string"&&(O=O.includes("?")||O.includes("#")?O=S(O):{path:O},O.params={}),D({query:p.query,hash:p.hash,params:O.path!=null?{}:p.params},O)}}function j(p,b){const w=h=C(p),_=r.value,O=p.state,U=p.force,N=p.replace===!0,d=B(w,_);if(d)return j(D(S(d),{state:typeof d=="object"?D({},O,d.state):O,force:U,replace:N}),b||w);const I=w;I.redirectedFrom=b;let W;return!U&&Ko(s,_,w)&&(W=xe(G.NAVIGATION_DUPLICATED,{to:I,from:_}),ve(_,_,!0,!1)),(W?Promise.resolve(W):nt(I,_)).catch(F=>re(F)?re(F,G.NAVIGATION_GUARD_REDIRECT)?F:se(F):Fe(F,I,_)).then(F=>{if(F){if(re(F,G.NAVIGATION_GUARD_REDIRECT))return j(D({replace:N},S(F.to),{state:typeof F.to=="object"?D({},O,F.to.state):O,force:U}),b||I)}else F=Me(I,_,!0,N,O);return st(I,_,F),F})}function mt(p,b){const w=a(p,b);return w?Promise.reject(w):Promise.resolve()}function De(p){const b=ke.values().next().value;return b&&typeof b.runWithContext=="function"?b.runWithContext(p):p()}function nt(p,b){let w;const[_,O,U]=ur(p,b);w=kt(_.reverse(),"beforeRouteLeave",p,b);for(const d of _)d.leaveGuards.forEach(I=>{w.push(he(I,p,b))});const N=mt.bind(null,p,b);return w.push(N),fe(w).then(()=>{w=[];for(const d of f.list())w.push(he(d,p,b));return w.push(N),fe(w)}).then(()=>{w=kt(O,"beforeRouteUpdate",p,b);for(const d of O)d.updateGuards.forEach(I=>{w.push(he(I,p,b))});return w.push(N),fe(w)}).then(()=>{w=[];for(const d of U)if(d.beforeEnter)if(ne(d.beforeEnter))for(const I of d.beforeEnter)w.push(he(I,p,b));else w.push(he(d.beforeEnter,p,b));return w.push(N),fe(w)}).then(()=>(p.matched.forEach(d=>d.enterCallbacks={}),w=kt(U,"beforeRouteEnter",p,b,De),w.push(N),fe(w))).then(()=>{w=[];for(const d of u.list())w.push(he(d,p,b));return w.push(N),fe(w)}).catch(d=>re(d,G.NAVIGATION_CANCELLED)?d:Promise.reject(d))}function st(p,b,w){v.list().forEach(_=>De(()=>_(p,b,w)))}function Me(p,b,w,_,O){const U=a(p,b);if(U)return U;const N=b===de,d=_e?history.state:{};w&&(_||N?o.replace(p.fullPath,D({scroll:N&&d&&d.scroll},O)):o.push(p.fullPath,O)),r.value=p,ve(p,b,w,N),se()}let ae;function pt(){ae||(ae=o.listen((p,b,w)=>{if(!ee.listening)return;const _=C(p),O=B(_,ee.currentRoute.value);if(O){j(D(O,{replace:!0,force:!0}),_).catch(We);return}h=_;const U=r.value;_e&&tr(cn(U.fullPath,w.delta),ft()),nt(_,U).catch(N=>re(N,G.NAVIGATION_ABORTED|G.NAVIGATION_CANCELLED)?N:re(N,G.NAVIGATION_GUARD_REDIRECT)?(j(D(S(N.to),{force:!0}),_).then(d=>{re(d,G.NAVIGATION_ABORTED|G.NAVIGATION_DUPLICATED)&&!w.delta&&w.type===Ot.pop&&o.go(-1,!1)}).catch(We),Promise.reject()):(w.delta&&o.go(-w.delta,!1),Fe(N,_,U))).then(N=>{N=N||Me(_,U,!1),N&&(w.delta&&!re(N,G.NAVIGATION_CANCELLED)?o.go(-w.delta,!1):w.type===Ot.pop&&re(N,G.NAVIGATION_ABORTED|G.NAVIGATION_DUPLICATED)&&o.go(-1,!1)),st(_,U,N)}).catch(We)}))}let ue=Ue(),Ve=Ue(),ce;function Fe(p,b,w){se(p);const _=Ve.list();return _.length?_.forEach(O=>O(p,b,w)):console.error(p),Promise.reject(p)}function vt(){return ce&&r.value!==de?Promise.resolve():new Promise((p,b)=>{ue.add([p,b])})}function se(p){return ce||(ce=!p,pt(),ue.list().forEach(([b,w])=>p?w(p):b()),ue.reset()),p}function ve(p,b,w,_){const{scrollBehavior:O}=e;if(!_e||!O)return Promise.resolve();const U=!w&&nr(cn(p.fullPath,0))||(_||!w)&&history.state&&history.state.scroll||null;return _s().then(()=>O(p,b,U)).then(N=>N&&er(N)).catch(N=>Fe(N,p,b))}const Re=p=>o.go(p);let qe;const ke=new Set,ee={currentRoute:r,listening:!0,addRoute:c,removeRoute:E,clearRoutes:t.clearRoutes,hasRoute:P,getRoutes:A,resolve:C,options:e,push:y,replace:M,go:Re,back:()=>Re(-1),forward:()=>Re(1),beforeEach:f.add,beforeResolve:u.add,afterEach:v.add,onError:Ve.add,isReady:vt,install(p){p.component("RouterLink",Tr),p.component("RouterView",Or),p.config.globalProperties.$router=ee,Object.defineProperty(p.config.globalProperties,"$route",{enumerable:!0,get:()=>R(r)}),_e&&!qe&&r.value===de&&(qe=!0,y(o.location).catch(_=>{}));const b={};for(const _ in de)Object.defineProperty(b,_,{get:()=>r.value[_],enumerable:!0});p.provide(dt,ee),p.provide(Kt,Cs(b)),p.provide(Mt,r);const w=p.unmount;ke.add(p),p.unmount=function(){ke.delete(p),ke.size<1&&(h=de,ae&&ae(),ae=null,r.value=de,qe=!1,ce=!1),w()}}};function fe(p){return p.reduce((b,w)=>b.then(()=>De(w)),Promise.resolve())}return ee}function Bl(){return we(dt)}function rs(e){return we(Kt)}function Mr(e,t=[]){for(const n of sn(e))if(n!=null)for(const s of sn(n))s!=null&&t.push(s);return t}function Ae(e,t){const n=e.toLowerCase(),s=n!==e||t.shiftKey,o=new Event("click");o.shiftKey=s;for(const f of["data-key0","data-key","data-key2","data-key3","data-key4"]){const u=document.querySelector(`[${f}="${e}"]`)??(s?document.querySelector(`[${f}="${n}"]`):void 0);if(u!=null){t.preventDefault(),u.dispatchEvent(o);return}}}function At(){return document.body.classList.contains("pause")}function is(e){if(e.defaultPrevented)return;const t=e.target?.tagName?.toLowerCase();if(["Alt","Control","Shift","ScrollLock"," "].includes(e.key)){const n=e.key.toLowerCase();document.body.classList.add(n);const s=o=>{o.key===e.key&&(document.body.classList.remove(n),window.removeEventListener("keyup",s))};window.addEventListener("keyup",s);return}if(t!=="input"){if(e.key==="p"||e.key==="Pause"){document.body.classList.toggle("pause");return}if(Js()&&(eo()&&e.metaKey||e.altKey))switch(e.key){case"ArrowLeft":e.preventDefault(),window.history.back();return;case"ArrowRight":e.preventDefault(),window.history.forward();return;case"r":e.preventDefault(),window.location.reload();return;default:return}if(!(e.altKey||e.ctrlKey||e.metaKey))switch(e.key){case"Left":case"ArrowLeft":return Ae("left",e);case"Right":case"ArrowRight":return Ae("right",e);case"Escape":return Ae("esc",e);case"Enter":return Ae("enter",e);case"Backspace":return Ae("backspace",e);default:return Ae(e.key,e)}}}function Vr(){window.addEventListener("keydown",is)}function Fr(){window.removeEventListener("keydown",is)}function qr(e){try{return pe(e)?void 0:JSON.parse(atob(e))}catch{return}}const Ce=Se("pending","resolved","rejected");class Ke{constructor(t){this.id=t,this.promise=new Promise((n,s)=>{this._resolve=n,this._reject=s})}static observe(t){return new Ke().observe(t)}[Symbol.toStringTag]="Deferred";promise;startedAt=Date.now();settledAt=void 0;_resolve;_reject;_state=Ce.pending;get state(){return this._state}get elapsedMs(){return(this.settledAt??Date.now())-this.startedAt}isPending(){return this._state===Ce.pending}isResolved(){return this._state===Ce.resolved}isRejected(){return this._state===Ce.rejected}isSettled(){return!this.isPending()}then(t,n){return this.promise.then(t,n)}catch(t){return this.promise.catch(t)}finally(t){return this.promise.finally(t)}resolve(t){return this.isSettled()?!1:(this._state=Ce.resolved,this.settledAt??=Date.now(),this._resolve(t),!0)}reject(t){return this.isSettled()?!1:(this._state=Ce.rejected,this.settledAt??=Date.now(),this._reject(t),!0)}async observeFn(t){try{const n=await t();return this.resolve(n),n}catch(n){throw this.reject(jn(n)),n}}observe(t){return t.then(n=>this.resolve(n),n=>this.reject(n)),this}observeQuietly(t){return t==null?this.resolve(void 0):t.then(n=>this.resolve(n),()=>this.resolve(void 0)),this}toJSON(){return{$ctor:"fe.Deferred",...this.id==null?{}:{id:this.id},state:this._state,elapsedMs:this.elapsedMs}}}function Br(){return{title:null,message:null,showPrompt:null,promptType:"text",promptPlaceholder:"",showCancel:null,okText:"OK",okClass:"info",okIcon:null}}const Ur=be("modal",()=>{const e=T(!1),t=T(null),n=T(null),s=T(null),o=T("text"),f=T(""),u=T(null),v=T("OK"),r=T("info"),h=T(null),m=T("");let i=null;zt(e,y=>{y?document.body.classList.add("modal-shown"):document.body.classList.remove("modal-shown")});function l(){const y=Br();t.value=y.title,n.value=y.message,s.value=null,o.value=y.promptType,f.value=y.promptPlaceholder,u.value=null,v.value=y.okText,r.value=y.okClass,h.value=null,m.value=""}function c(y){e.value=!1,i?.(y),i=null}function E(){c({ok:!1})}function A(){c({ok:!1})}function P(){c({ok:!0,prompt:m.value})}function C(y,M){l(),t.value=y,n.value=M,s.value=!1,u.value=!1,e.value=!0;const B=new Ke;return i=()=>B.resolve(),B}function S(y,M){l(),t.value=y,n.value=M,s.value=!1,u.value=!0,e.value=!0;const B=new Ke;return i=j=>B.resolve(j.ok),B}function a(y){l(),t.value=y.title,n.value=y.message,s.value=y.showPrompt??!0,o.value=y.promptType??"text",f.value=y.promptPlaceholder??"",u.value=y.showCancel??!0,v.value=y.okText??"OK",r.value=y.okClass??"info",h.value=y.okIcon??null,e.value=!0;const M=new Ke;return i=B=>M.resolve(B),M}return{show:e,title:t,message:n,showPrompt:s,promptType:o,promptPlaceholder:f,showCancel:u,okText:v,okClass:r,okIcon:h,promptValue:m,dismiss:c,onScrimClick:E,onCancelClick:A,onOkClick:P,alert:C,confirm:S,promptModal:a}}),Gr={key:0,class:"modal"},zr={class:"dialog reveal"},Hr={key:0,class:"header"},jr=["innerHTML"],Wr=["type","placeholder"],Kr={class:"footer"},$r=Ne({__name:"Modal",setup(e){const t=Ur(),{show:n,title:s,message:o,showPrompt:f,promptType:u,promptPlaceholder:v,showCancel:r,okText:h,okClass:m,okIcon:i,promptValue:l}=at(t),{onScrimClick:c,onCancelClick:E,onOkClick:A}=t;return(P,C)=>(V(),Qe(Ps,{name:"fade"},{default:$(()=>[R(n)?(V(),q("div",Gr,[g("div",{class:"scrim",onClick:C[0]||(C[0]=Ie((...S)=>R(c)&&R(c)(...S),["stop"]))}),g("div",zr,[R(s)?(V(),q("h2",Hr,Pe(R(s)),1)):K("",!0),g("div",{class:"body",innerHTML:R(o)},null,8,jr),R(f)?Ts((V(),q("input",{key:1,class:"prompt","onUpdate:modelValue":C[1]||(C[1]=S=>Ns(l)?l.value=S:null),type:R(u)??"text",placeholder:R(v)??"",onKeyup:C[2]||(C[2]=xs((...S)=>R(A)&&R(A)(...S),["enter"]))},null,40,Wr)),[[Ls,R(l)]]):K("",!0),g("div",Kr,[R(r)?(V(),q("button",{key:0,class:"cancel btn grey",onClick:C[3]||(C[3]=(...S)=>R(E)&&R(E)(...S)),"data-key":"esc"}," Cancel ")):K("",!0),g("button",{class:je(["btn",R(m)]),onClick:C[4]||(C[4]=(...S)=>R(A)&&R(A)(...S)),"data-key":"enter"},[R(i)?(V(),Qe(x,{key:0,icon:R(i)},null,8,["icon"])):K("",!0),it(" "+Pe(R(h)),1)],2)])])])):K("",!0)]),_:1}))}}),Qr=le(()=>Ht("/api/system/state"),et),Yr=1e3;function Xr(){return Io(0,Yr)}function Zr(e){return e?.constructor?.name==="URLSearchParams"}function ls(e){return e==null?void 0:Zr(e)?e:new URLSearchParams(e)}function $t(...e){const t=ct(e.map(ls)),n=t.shift();if(n!=null){for(const s of t)for(const[o,f]of s.entries())n.set(o,f);return n}}function Oe(e,...t){const n=Ee($t(...t));return e+(pe(n)?"":"?"+n)}function Ul(e,...t){const n=Ee($t(...t));return pe(n)?e:e+(e.includes("?")?"&":"?")+n}const Jr=le(Xr,100);function ei(e,t){const n=ls(e);if(t||!oo(n?.get("seed"))){const s=Jr().toString();return n?.set("seed",s),n??{seed:s}}return n}function ti(e){return ni([],e,!0)}function ni(e,t,n=!1){const s=si(e,t,n);return Oe(s.path,s.query)}function si(e,t,n=!1){return{path:"/tag/"+(Lt(e)?"":e.map(encodeURIComponent).join("/")),query:ei(t,n)}}const oi=be("menu",()=>{const e=T(!1);function t(){e.value=!0,document.body.classList.add("menu-shown")}function n(){e.value=!1,document.body.classList.remove("menu-shown")}function s(){e.value?n():t()}return{visible:e,show:t,hide:n,toggle:s}});let Ct;function ri(e){Je(e)&&(Ct==null?Ct=e:Ct!==e&&jt().show({text:"A new version of PhotoStructure is ready",details:"Version "+e,type:"info",uuid:"new-version",timeout:!1,buttons:[{text:"Details",class:"text",title:"Open the latest release notes in a new window",onClick:()=>window.open("https://photostructure.com/about/release-notes/","_blank")},{text:"Refresh",class:"info",onClick:()=>window.location.reload()}],onClick:()=>window.location.reload()}))}const ii=le(()=>!1,10*et),Gl=le(()=>new us("img[data-src]",e=>{["src","srcSet"].forEach(t=>{const n="data-"+t;te(e.getAttribute(n),s=>{e.setAttribute(t,s),e.removeAttribute(n),e.classList.add("lazy-loaded")})})})),zl=le(()=>new us("div[data-url]",e=>e.click())),Rn=["scroll","wheel","resize","touchmove","touchend"],as=[];function li(){as.forEach(e=>e.onChange())}class us{constructor(t,n){this.selector=t,this.visibilityHandler=n,this.callback=()=>{ro(5,s=>setTimeout(()=>this.check(),s*et))},as.push(this)}arr=[];callback;onChange(){this.findElements(),this._check()}findElements(){this.arr.length=0,Po(this.selector).forEach(t=>this.arr.push(t)),Lt(this.arr)?this.removeListenersIfEmpty():this.addListeners()}check=zn({f:this._check.bind(this),minCallDelayMs:100});_check(){io(this.arr,t=>{const n=ai(t);return n&&this.visibilityHandler(t),!n}),this.removeListenersIfEmpty()}addListeners(){if(this.arr.length>0)for(const t of Rn)window.addEventListener(t,this.callback,{passive:!0})}removeListenersIfEmpty(){if(Lt(this.arr))for(const t of Rn)window.removeEventListener(t,this.callback)}}const cs=le(()=>50);function ai(e){if(document.documentElement==null)return!1;const t=e.getBoundingClientRect(),n=cs()/100*document.documentElement.clientHeight;return t.bottom>=-n&&t.right>=-n&&t.top<=document.documentElement.clientHeight+n&&t.left<=document.documentElement.clientWidth+n}const ui="2026.1.0-beta",kn=le(()=>Hn("is-plus")),An=le(()=>Hn("is-paused")),fs=be("system",()=>{const e=T(kn()),t=L(()=>!e.value),n=T(An()),s=T(ui);function o(f){if(f!=null&&ii.set(!1),Je(f?.tier)){const u=f?.tier==="plus";kn.set(u),e.value=u}if(typeof f?.paused=="boolean"){const u=f?.paused===!0;An.set(u),n.value=u}lo(f?.ll_vh)&&cs.set(f.ll_vh),Wn(f?.ver,u=>{s.value=u,ri(u)})}return{plus:e,lite:t,paused:n,version:s,set:o}}),ci={class:"top left-middle-right"},fi=["title"],di={key:0,class:"plus"},hi={key:1,class:"lite"},mi={class:"menu-items"},pi={href:"/settings",title:"Change settings for your library"},vi={key:0},gi={key:1},yi={key:2},wi={href:"/about",target:"_blank",title:"View version, system, and licensing details."},Ei={href:"/health",title:"View your library's health checks"},bi={href:"https://photostructure.com/whats-new/",target:"_blank",title:"See what's new in this version of PhotoStructure"},Si={href:"https://photostructure.com/about/release-notes/",target:"_blank",title:"View a detailed list of changes for every version of PhotoStructure"},Ri={href:"https://photostructure.com/user-guide/",target:"_blank",title:"A guided path of documentation in using PhotoStructure"},ki={href:"https://forum.photostructure.com/",target:"_blank",title:"Visit the PhotoStructure Forum to get support and share feedback"},Ai={href:"https://photostructure.com/go/discord",target:"_blank",title:"Chat with the author and community in the official PhotoStructure Discord channel"},Ci={key:0,class:"bottom"},_i=["href"],Ii=Ne({__name:"NavMenu",setup(e){const t=rs(),n=oi(),s=fs(),{visible:o}=at(n),{hide:f}=n,{plus:u,lite:v,version:r,paused:h}=at(s),m=L(()=>({visible:o.value===!0}));zt(o,()=>{Qr()});function i(){return ti(t.query)}function l(){Ds()}function c(){Ms()}function E(){Vs()}function A(){Fs()}function P(){qs()}function C(){window.confirm(["This will re-import every file in your library.","",'- Progress will show this as "Updating metadata" and "regrouping assets."',"- You should attach all external hard drives that include library assets before starting.","- Depending on your library size and your computer, this may take hours (or days!).","","Are you sure you want rebuild your library?"].join(`
`))&&Bs()}return(S,a)=>{const y=Gn("router-link");return V(),q("div",null,[R(o)?(V(),q("div",{key:0,id:"full-page-scrim",onClick:a[0]||(a[0]=M=>R(f)())})):K("",!0),g("nav",{class:je(["nav-menu",m.value]),id:"nav-menu",onClick:a[10]||(a[10]=M=>R(f)())},[g("div",ci,[g("div",{class:"center",title:R(u)?"Thanks for supporting PhotoStructure with your subscription!":R(v)?"This is the free version of PhotoStructure with limited features.":""},[a[11]||(a[11]=g("img",{class:"logo",src:"/images/logo-horizontal-white.svg",alt:"PhotoStructure logo"},null,-1)),R(u)?(V(),q("div",di,"plus")):K("",!0),R(v)?(V(),q("div",hi,"lite")):K("",!0)],8,fi),R(o)?(V(),q("a",{key:0,class:"vicon right",title:"Close",onClick:a[1]||(a[1]=M=>R(f)()),"data-key2":"esc"},[k(x,{icon:"close"})])):K("",!0)]),g("div",mi,[g("ol",null,[g("li",null,[k(y,{to:i(),title:"View all root tags"},{default:$(()=>[k(x,{icon:"home"}),a[12]||(a[12]=g("span",null,"Home",-1))]),_:1},8,["to"])]),g("li",null,[k(y,{to:"/search",title:"Search"},{default:$(()=>[k(x,{icon:"search"}),a[13]||(a[13]=g("span",null,"Search",-1))]),_:1})]),g("li",null,[k(y,{to:"/tag/When",title:"View by year and month"},{default:$(()=>[k(x,{icon:"event"}),a[14]||(a[14]=g("span",null,"View by date",-1))]),_:1})]),g("li",null,[k(y,{to:"/tag/fs",title:"Browse by folders on your filesystem"},{default:$(()=>[k(x,{icon:"folder"}),a[15]||(a[15]=g("span",null,"View by folder",-1))]),_:1})]),g("li",null,[k(y,{to:"/search?q=liked:true",title:"View liked photos and videos"},{default:$(()=>[k(x,{icon:"favorite"}),a[16]||(a[16]=g("span",null,"View liked",-1))]),_:1})]),g("li",null,[k(y,{to:"/tag/Where",title:"View by location"},{default:$(()=>[k(x,{icon:"globe"}),a[17]||(a[17]=g("span",null,"View by location",-1))]),_:1})]),g("li",null,[k(y,{to:"/tag/Camera",title:"View by camera make and model"},{default:$(()=>[k(x,{icon:"camera_alt"}),a[18]||(a[18]=g("span",null,"View by camera",-1))]),_:1})]),g("li",null,[k(y,{to:"/tag/Lens",title:"View by camera lens"},{default:$(()=>[k(x,{icon:"camera"}),a[19]||(a[19]=g("span",null,"View by lens",-1))]),_:1})]),g("li",null,[k(y,{to:"/tag/Keywords",title:"View by keyword"},{default:$(()=>[k(x,{icon:"label"}),a[20]||(a[20]=g("span",null,"View by keywords",-1))]),_:1})]),g("li",null,[k(y,{to:"/tag/Type",title:"View by image or video types"},{default:$(()=>[k(x,{icon:"file"}),a[21]||(a[21]=g("span",null,"View by file type",-1))]),_:1})]),a[38]||(a[38]=g("hr",null,null,-1)),g("li",null,[k(y,{to:"/search?q=archived:true",title:"View archived assets. These photos and videos are hidden from tag galleries and most searches."},{default:$(()=>[k(x,{icon:"archive"}),a[22]||(a[22]=g("span",null,"View archived",-1))]),_:1})]),g("li",null,[k(y,{to:"/search?q=removed:true",title:"View recently removed assets. These photos and videos will be removed from the library, but their files remain on disk."},{default:$(()=>[k(x,{icon:"library_remove"}),a[23]||(a[23]=g("span",null,"View removed",-1))]),_:1})]),g("li",null,[k(y,{to:"/search?q=trashed:true",title:"View recently trashed assets. These photos and videos will be removed from the library and all file variations will be deleted."},{default:$(()=>[k(x,{icon:"trash"}),a[24]||(a[24]=g("span",null,"View trash",-1))]),_:1})]),a[39]||(a[39]=g("hr",null,null,-1)),g("li",null,[g("a",pi,[k(x,{icon:"settings"}),a[25]||(a[25]=g("span",null,"Settings",-1))])]),R(h)===!0?(V(),q("li",vi,[g("a",{onClick:a[2]||(a[2]=M=>c()),title:"Resume currently scheduled sync"},[k(x,{icon:"play_circle"}),a[26]||(a[26]=g("span",null,"Resume sync",-1))])])):K("",!0),R(h)===!1?(V(),q("li",gi,[g("a",{onClick:a[3]||(a[3]=M=>l()),title:"Pause any currently running sync"},[k(x,{icon:"pause_circle"}),a[27]||(a[27]=g("span",null,"Pause sync",-1))])])):K("",!0),g("li",null,[g("a",{onClick:a[5]||(a[5]=M=>E()),title:"Re-scan your drives for changed photos or videos"},[k(x,{icon:"refresh"}),a[28]||(a[28]=g("span",null,"Restart sync",-1)),g("a",{href:"https://photostructure.com/go/sync",title:"Read about PhotoStructure's sync process",onClick:a[4]||(a[4]=Ie(()=>{},["stop"]))},[k(x,{icon:"help_outline"})])])]),g("li",null,[g("a",{onClick:a[7]||(a[7]=M=>C()),title:"Rebuild your library by re-importing all your photos and videos"},[k(x,{icon:"update"}),a[29]||(a[29]=g("span",null,"Rebuild (slow)",-1)),g("a",{href:"https://photostructure.com/go/rebuild",title:"Read about library rebuilds",onClick:a[6]||(a[6]=Ie(()=>{},["stop"]))},[k(x,{icon:"help_outline"})])])]),R(to)()?(V(),q("li",yi,[g("a",{onClick:a[8]||(a[8]=M=>A()),title:"Open your sync reports directory"},[k(x,{icon:"summarize"}),a[30]||(a[30]=g("span",null,"Open sync reports",-1))])])):K("",!0),g("li",null,[g("a",{onClick:a[9]||(a[9]=M=>P()),title:"Shut down PhotoStructure. Your library will no longer be accessible until you re-launch PhotoStructure."},[k(x,{icon:"power"}),a[31]||(a[31]=g("span",null,"Shut down",-1))])]),a[40]||(a[40]=g("hr",null,null,-1)),g("li",null,[g("a",wi,[k(x,{icon:"logo"}),g("span",null,"About version "+Pe(R(r)),1)])]),g("li",null,[g("a",Ei,[k(x,{icon:"health"}),a[32]||(a[32]=g("span",null,"Health checks",-1))])]),g("li",null,[g("a",bi,[k(x,{icon:"gift"}),a[33]||(a[33]=g("span",null,"What's new?",-1))])]),g("li",null,[g("a",Si,[k(x,{icon:"document"}),a[34]||(a[34]=g("span",null,"Release notes",-1))])]),g("li",null,[g("a",Ri,[k(x,{icon:"docs"}),a[35]||(a[35]=g("span",null,"User guide",-1))])]),g("li",null,[g("a",ki,[k(x,{icon:"forum"}),a[36]||(a[36]=g("span",null,"Forum",-1))])]),g("li",null,[g("a",Ai,[k(x,{icon:"discord"}),a[37]||(a[37]=g("span",null,"Discord",-1))])])])]),R(v)?(V(),q("div",Ci,[a[41]||(a[41]=it(" You deserve PhotoStructure ",-1)),a[42]||(a[42]=g("span",{class:"plus"},"PLUS",-1)),a[43]||(a[43]=it("!",-1)),a[44]||(a[44]=g("br",null,null,-1)),g("a",{href:R(Os)()},"Try it for free for 15 days",8,_i),a[45]||(a[45]=it(". ",-1))])):K("",!0)],2)])}}}),Pi=["onClick"],Ti={class:"toast-content"},Li={class:"toast-text"},xi={key:0,class:"toast-details"},Ni={key:0,class:"toast-buttons"},Oi=["title","onClick"],Di={class:"toast-picons"},Mi=["title","onClick"],Vi=["onClick"],Fi=Ne({__name:"ToastContainer",setup(e){const t=jt(),{toasts:n}=at(t),{dismiss:s,pauseTimers:o,resumeTimers:f}=t,u=T(null);function v(l){l.onClick!=null?l.onClick(()=>s(l.id)):s(l.id)}function r(l,c){c.onClick(()=>s(l.id))}function h(l){const c=[l.text];return pe(l.details)||c.push("Details: "+l.details),l.createdAt>0&&c.push("Created at: "+new Date(l.createdAt).toLocaleString()),c.join(`

`)}async function m(l){try{await navigator.clipboard.writeText(h(l)),u.value=l.id,setTimeout(()=>{u.value===l.id&&(u.value=null)},1500)}catch{}}function i(){return navigator?.clipboard?.writeText!=null}return(l,c)=>(V(),Qe(Gs,{to:"body"},[R(n).length>0?(V(),q("div",{key:0,class:"toast-container",onMouseenter:c[0]||(c[0]=(...E)=>R(o)&&R(o)(...E)),onMouseleave:c[1]||(c[1]=(...E)=>R(f)&&R(f)(...E))},[k(Us,{name:"toast"},{default:$(()=>[(V(!0),q(en,null,tn(R(n),E=>(V(),q("div",{key:E.id,class:je(["toast",["toast-"+E.type]]),onClick:A=>v(E)},[g("div",Ti,[g("div",Li,Pe(E.text),1),E.details?(V(),q("div",xi,Pe(E.details),1)):K("",!0)]),E.buttons?.length?(V(),q("div",Ni,[(V(!0),q(en,null,tn(E.buttons,(A,P)=>(V(),q("button",{key:P,class:je(["btn small",A.class]),title:A.title,onClick:Ie(C=>r(E,A),["stop"])},Pe(A.text),11,Oi))),128))])):K("",!0),g("div",Di,[i()?(V(),q("button",{key:0,class:je(["toast-picon toast-copy",{copied:u.value===E.id}]),title:u.value===E.id?"Copied!":"Copy to clipboard",onClick:Ie(A=>m(E),["stop"])},[k(x,{icon:u.value===E.id?"check":"content_paste"},null,8,["icon"])],10,Mi)):K("",!0),g("button",{class:"toast-picon toast-close",title:"Dismiss",onClick:Ie(A=>R(s)(E.id),["stop"])},[k(x,{icon:"close"})],8,Vi)])],10,Pi))),128))]),_:1})],32)):K("",!0)]))}}),ds=(e,t)=>{const n=e.__vccOpts||e;for(const[s,o]of t)n[s]=o;return n},qi=ds(Fi,[["__scopeId","data-v-d55ccdfc"]]);function hs(e,t){let n,s=[];const o=(...f)=>{s=f,n!=null&&clearTimeout(n),n=setTimeout(()=>e(...s),t)};return o.reset=()=>{n!=null&&clearTimeout(n),n=void 0},o.now=()=>{o.reset(),e()},o}var Z={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},Cn=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],_n=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],In=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],Y=typeof window<"u"&&typeof window.document<"u"?window.document:{},J="fullscreenEnabled"in Y&&Object.keys(Z)||Cn[0]in Y&&Cn||_n[0]in Y&&_n||In[0]in Y&&In||[],Xe={requestFullscreen:function(e){return e[J[Z.requestFullscreen]]()},requestFullscreenFunction:function(e){return e[J[Z.requestFullscreen]]},get exitFullscreen(){return Y[J[Z.exitFullscreen]].bind(Y)},get fullscreenPseudoClass(){return":"+J[Z.fullscreen]},addEventListener:function(e,t,n){return Y.addEventListener(J[Z[e]],t,n)},removeEventListener:function(e,t,n){return Y.removeEventListener(J[Z[e]],t,n)},get fullscreenEnabled(){return!!Y[J[Z.fullscreenEnabled]]},set fullscreenEnabled(e){},get fullscreenElement(){return Y[J[Z.fullscreenElement]]},set fullscreenElement(e){},get onfullscreenchange(){return Y[("on"+J[Z.fullscreenchange]).toLowerCase()]},set onfullscreenchange(e){return Y[("on"+J[Z.fullscreenchange]).toLowerCase()]=e},get onfullscreenerror(){return Y[("on"+J[Z.fullscreenerror]).toLowerCase()]},set onfullscreenerror(e){return Y[("on"+J[Z.fullscreenerror]).toLowerCase()]=e}};const Hl=Xe.fullscreenEnabled;function Ze(){return Xe.fullscreenElement!=null}const Qt=[];function ms(e){ps(),Qt.push(e)}function Bi(e){ao(Qt,e)}function ps(){const e=Ze(),t=document.body.classList;t.remove(e?"not-fs":"fs"),t.add(e?"fs":"not-fs");for(const n of Qt)n(e)}function Ui(){Xe.addEventListener("fullscreenchange",ps)}function Gi(){Ze()?Xe.exitFullscreen():Xe.requestFullscreen(document.body)}const Pn=["resize","scroll"],Tn=["DOMMouseScroll","keydown","mousedown","mousemove","mousewheel","touchstart","wheel"],zi=()=>document.body.classList.remove("idle"),Hi=()=>document.body.classList.add("idle");class ji{constructor(t=4e3,n=zi,s=Hi){this.idleMs=t,this.activate=n,this.deactivate=s,this.onIdle=hs(()=>this._onIdle(),t)}paused=!0;active=!0;onIdle;onActive=()=>{this.onIdle(),!this.active&&(this.active=!0,this.activate())};_onIdle(){this.active&&(this.active=!1,this.deactivate())}resume(){if(this.paused){this.paused=!1;for(const t of Pn)window.addEventListener(t,this.onActive,{passive:!0});for(const t of Tn)document.addEventListener(t,this.onActive,{passive:!0});this.onIdle.reset(),this.onActive()}}pause(){if(!this.paused){this.paused=!0;for(const t of Pn)window.removeEventListener(t,this.onActive);for(const t of Tn)document.removeEventListener(t,this.onActive);this.onActive(),this.onIdle.reset()}}}const Wi="modulepreload",Ki=function(e){return"/app/"+e},Ln={},_t=function(t,n,s){let o=Promise.resolve();if(n&&n.length>0){let r=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(i=>({status:"fulfilled",value:i}),i=>({status:"rejected",reason:i}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),v=u?.nonce||u?.getAttribute("nonce");o=r(n.map(h=>{if(h=Ki(h),h in Ln)return;Ln[h]=!0;const m=h.endsWith(".css"),i=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${i}`))return;const l=document.createElement("link");if(l.rel=m?"stylesheet":Wi,m||(l.as="script"),l.crossOrigin="",l.href=h,v&&l.setAttribute("nonce",v),document.head.appendChild(l),m)return new Promise((c,E)=>{l.addEventListener("load",c),l.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${h}`)))})}))}function f(u){const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=u,window.dispatchEvent(v),!v.defaultPrevented)throw u}return o.then(u=>{for(const v of u||[])v.status==="rejected"&&f(v.reason);return t().catch(f)})},$i="/sse/progress";let me,ut;function Qi(){return me==null}function Vt(){const e=me,t=ut;me=void 0,ut=void 0,e!=null&&t!=null&&e.removeEventListener("message",t),e?.close()}const Yi=le(()=>{window.addEventListener("beforeunload",Vt)}),xn=3500,vs=be("progress",()=>{const e=T(!0),t=T([]);let n=0;const s=T(null);function o(i){s.value=i,n>0&&Date.now()-n<5e3&&i()}function f(){s.value=null}const u=zn({f:()=>{s.value?.()},minCallDelayMs:xn});function v(i){t.value=He(i,l=>l.states,[]),t.value?.some(l=>uo(l.recentAssetIds))&&(n=Date.now(),u(),Ao(()=>u(),xn*3))}function r(){if(!(e.value||me!=null&&me.readyState===me.OPEN))try{const i=me=new EventSource($i);ut=l=>{try{if(pe(l.data))return;const c=JSON.parse(l.data);v(c)}catch(c){Tt({text:"Failed to parse progress from server",error:jn(c)})}},i.addEventListener("message",ut)}catch{if(me==null||e.value)return}}function h(){return Yi(),Vt(),n=0,e.value=!1,r()}function m(){e.value=!0,Vt()}return{paused:e,states:t,resumeSSE:h,pauseSSE:m,registerTagsRefreshCallback:o,unregisterTagsRefreshCallback:f}}),gs=new Map,tt=Dr({history:hr(),routes:[{name:"tag",path:"/tag/:path*",component:()=>_t(()=>import("./Tag.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])),props:e=>({fullPath:e.fullPath})},{name:"asset",path:"/asset/:assetId",component:()=>_t(()=>import("./Asset.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,13,10,11])),props:e=>({assetId:xt(e.params.assetId),from:e.query.from,priorAssetId:xt(e.query.priorAssetId)})},{name:"search",path:"/search",component:()=>_t(()=>import("./Search.js"),__vite__mapDeps([14,1,2,3,4,9,13,8,10,7,6,11])),props:e=>({query:e.query})},{path:"/:pathMatch(.*)*",redirect:"/tag/"}],scrollBehavior(e,t,n){if(Je(e.hash))return{el:e.hash};if(Yt(e))return;const s={left:n?.left??0,top:gs.get(e.fullPath)??n?.top??0};return Ze()&&Te(s.top)?new Promise(o=>{requestAnimationFrame(()=>{document.body.scrollTop=s.top,o(void 0)})}):s}});tt.beforeEach((e,t)=>{Yt(t)||gs.set(t.fullPath,window.document.body.scrollTop)});tt.afterEach((e,t)=>{const n=vs();rt(e)&&!rt(t)?n.resumeSSE():rt(t)&&!rt(e)&&n.pauseSSE()});function Yt(e){return e.fullPath.startsWith("/asset/")}function rt(e){return e.path==="/tag"||e.path.startsWith("/tag/")}function $e(e,t=!1){if(!ze(e))return;t&&(e=-e);const n=Math.round((e%360+360)%360/90)*90;return n===360?0:n}function Xi(e){if(e==null)return!1;const t=$e(e);return t===90||t===270}const Ft=3.5*et,Zi=3,qt=new Map;function Nn(e){return te(e,t=>co(qt,t.assetId,()=>new tl(t,"")))}function Ji(){setTimeout(()=>el(),Ft)}async function el(e){for(const t of qt.values())await t.maybeSave(e);ho(qt,(t,n)=>n.settled())}class tl{constructor(t,n){this.asset=t,this.search=n}_lastTouchedMs=Date.now();_rotation=0;_retries=0;_saving=!1;_failed=!1;_saved=!1;assetId(){return this.asset.assetId}rotation(){return $e(this._rotation)??0}rotationIfSameSearch(t){return t===this.search?this.rotation():0}isSaved(){return this._saved}settled(){return this._saved||this._failed}rotate(t){return this.touch(),this._rotation=$e(this._rotation+t)??0}touch(){this._lastTouchedMs=Date.now()}cssTransform(){return this._rotation===0?"":`transform: rotate(${this._rotation}deg);`}msSinceLastTouch(){return Date.now()-this._lastTouchedMs}toFormData(){const t={};return this._rotation!==0&&(t.rotation=$e(this._rotation)),fo(t)?void 0:t}save(){return this.maybeSave(0)}async maybeSave(t){if(this._saving||this.settled())return;const n=t!=null?Number(t):null;if(this.assetId()===n&&this.msSinceLastTouch()<Ft)return;this._saving=!0;const s=this.toFormData();if(s==null)this._saved=!0;else try{await Ht("/api/asset/"+this.assetId(),{data:s,method:"PUT"}),this._saved=!0,window.location.pathname==="/asset/"+this.assetId()&&window.location.reload()}catch(o){this._retries++>Zi?(this._failed=!0,console.error("Failed to save asset "+this.assetId(),{formData:s,err:o})):(this.touch(),this.scheduleRetry())}this._saving=!1}async scheduleRetry(){await Co(Ft),await this.save()}}function ht(e){if(e!=null){if(ze(e))return e;if("id"in e&&ze(e.id))return e.id;if("assetId"in e&&ze(e.assetId))return e.assetId;if("tagId"in e&&ze(e.tagId))return e.tagId}}const nl=Se("fit","sq");Se("uhd8k","uhd5k","uhd4k","qhd","fhd","hd","wvga","qvga","qqvga");Se("s480","s240","s120","s60");const sl=[60,120,240,480],ol=/\bChrome\b/,rl=/\bSafari\b/,il=/\bFirefox\b/;function Xt(e,t){return e!=null&&String(e).match(t)!=null}function ll(e){return Xt(e,ol)}function On(e){return Xt(e,rl)&&!ll(e)&&!al(e)}function al(e){return Xt(e,il)}function Dn(e,t){return e+" "+t+"w"}function Zt(e,t){let n=t==null?void 0:$t(...t);const s=Ee(e.v);return!pe(s)&&s!=="1"&&(n??=new URLSearchParams).append("v",s),n}function ul({assetId:e,params:t}){return e==null?"":Oe("/asset/"+ht(e),Zt(e,t))}function jl({assetId:e,params:t}){const n=ul({assetId:e,params:t});return pe(n)?{}:{href:n}}function Mn({assetId:e,reducer:t,width:n,params:s}){return Oe(`/img/${ht(e)}/${t}/${po(n)??320}`,Zt(e,s))}function ys({assetId:e,assetFileId:t,params:n}){return Oe(`/img/${ct([ht(e),t]).join("/")}/actual`,Zt(e,n))}function Wl({assetId:e,params:t,lazyLoad:n,size:s="m"}){return{...cl({assetId:e,params:t,reducer:"sq",widths:sl,lazyLoad:n}),sizes:(s==="s"?80:s==="m"?160:320)*mo(globalThis?.window?.devicePixelRatio,1)+"px"}}function cl({assetId:e,params:t,reducer:n,widths:s,lazyLoad:o,af:f}){if(ht(e)==null)return{src:"/images/clear-64.png"};s=(s??[]).filter(Te),s.length===0&&s.push(320);const v=Math.min(...s),r={width:Ee(v)},h=_o(e.capturedAtLocal);h!=null&&(r.title=h);const m=Mn({assetId:e,params:t,reducer:n,width:v});o??=!0;const i=o&&On(nn());i?(r.src="/images/clear-64.png",r["data-src"]=m):r.src=m,On(nn())||(r.loading=o?"lazy":"eager"),n===nl.sq&&(r.height=Ee(v));const l=s.map(c=>Dn(Mn({assetId:e,params:t,reducer:n,width:c}),c));return f!=null&&l.push(Dn(ys({assetId:e,params:t,assetFileId:f.assetFileId}),f.width)),r[(i?"data-":"")+"srcSet"]=l.join(","),r}function Kl(e,t=" "){return`${e.width}${t}Ã${t}${e.height}`}function fl(e){return{width:e.height,height:e.width}}function dl(e,t){return Xi(t)?fl(e):e}const ws=": ",hl=["Error","String","Object","WrappedError"];function ml(e){return e==null?void 0:[e?.name,e?.constructor?.name].find(t=>t!=null&&!hl.includes(t))?.toString()}function pl(e){return e==null?void 0:yo(e?.code)}function Vn(e){if(pe(e))throw new Error("undefined error");if(e instanceof Error)return e;if(Array.isArray(e)){const t=e[0];return t instanceof Error?(e.length>1&&(t.errors=e.slice(1)),t):new Error(e.map(n=>Ee(n)).filter(Je).join(", "))}else{const t=gl(e).replace(/^Error: /i,"");return new Error(t)}}function vl(...e){const t=[];for(const n of e)n!=null&&(n instanceof Error?t.push(ml(n),pl(n),n?.message):t.push(Ee(n)));return vo(go(Mr(ct(t).map(n=>n.split(ws)))))}function gl(...e){return vl(...e).join(ws)}const yl=250;function wl(e){document.body.classList.add("no-transition"),e(),setTimeout(()=>document.body.classList.remove("no-transition"),yl)}const It=400,lt=2.5;function El(){return{asset:null,previewAf:null,width:null,height:null,lastClientX:null,lastClientY:null,tx:"",ty:"",scale:null,maxScale:lt,minScale:null,rotation:0,showInfo:!1,showTransitions:!1}}let Bt;function bl(e){Bt=e}const Sl=be("asset",()=>{const e=T(null),t=T(null),n=T(null),s=T(null),o=T(null),f=T(null),u=T(""),v=T(""),r=T(null),h=T(lt),m=T(null),i=T(0),l=T(!1),c=T(!1);function E(d,I=2){return on(d*100,I)}function A(d,I=2){return E(d,I)+"%"}function P(){if(r.value==null||n.value==null||s.value==null){u.value=v.value="";return}const d=window.innerWidth-(l.value?It:0),I=window.innerHeight,W=Math.floor(r.value*n.value),F=Math.floor(r.value*s.value),z=Math.floor(W-d),oe=Math.floor(F-I),Be=Math.floor((n.value-W)/2),gt=Math.floor((s.value-F)/2),Rs=i.value!==0?.5:He(o.value,yt=>1-ie(0,1,2*(d-yt)/d-.5),()=>.5),ks=i.value!==0?.5:He(f.value,yt=>1-ie(0,1,2*(I-yt)/I-.5),()=>.5);u.value=Math.floor((z<=0?-z/2:-Rs*z)-Be)+"px",v.value=Math.floor((oe<=0?-oe/2:-ks*oe)-gt)+"px"}function C(d){return d<.39?.75:d<.667?1:(d+lt)/2}const S=L(()=>{if(e.value!=null){if(Je(e.value.name))return e.value.name;if(e.value.assetId>0)return"Asset "+e.value.assetId}}),a=L(()=>e.value!=null&&"videoAttrs"in e.value),y=L(()=>e.value!=null&&"imgAttrs"in e.value),M=L(()=>$e(i.value)!==0),B=L(()=>r.value==null||wo(r.value,m.value,1/34)),j=L(()=>y.value&&!M.value),mt=L(()=>te(r.value,E)),De=L(()=>te(r.value,A)),nt=L(()=>te(m.value,E)),st=L(()=>te(h.value,E)),Me=L(()=>window.innerWidth-(l.value?It:0)),ae=L(()=>Et(n.value,r.value,(d,I)=>d*I)),pt=L(()=>t.value!=null||Eo(ae.value,Me.value)),ue=L(()=>a.value||B.value&&!M.value),Ve=L(()=>{const d=ue.value;return ct([d?void 0:Wn(u.value,()=>`translate(${u.value}, ${v.value})`),M.value?`rotate(${i.value}deg)`:void 0,d?void 0:te(r.value,I=>`scale(${I})`)]).join(" ")}),ce=L(()=>{const d={};return!M.value&&c.value&&(d.transition="width 0.5s"),ue.value||(d.position="absolute",d.top=0,d.left=0),d.transform=Ve.value,d}),Fe=L(()=>{try{if(e.value==null||!y.value)return{};(m.value==null||r.value==null)&&se();const d=e.value.imgAttrs,I=e.value.assetId;if(I==null||d==null)return{};const W={contain:ue.value};let F;if(j.value){const Be=B.value?"in":"out";W[`zoom-${Be}`]=!0}const z=Et(n.value,r.value,(Be,gt)=>Math.round(100*Be*gt/window.innerWidth)+"vw"),oe={...d,style:ce.value,class:W,sizes:z,width:n.value,height:s.value,title:F};return t.value?.assetFileId!=null&&(delete oe.srcSet,oe.src=ys({assetId:I,assetFileId:t.value.assetFileId})),oe}catch(d){return Tt({text:"Failed to compute image attributes",error:Vn(d)}),{}}}),vt=L(()=>{if(!a.value)return{};const d=e.value.videoAttrs;return{...d,style:ce.value,autoplay:zs()?d.autoplay:void 0}});function se(){const d=B.value||m.value==null;n.value=ot(rn(te(t.value,z=>z.width),()=>te(e.value,z=>z.width))),s.value=ot(rn(te(t.value,z=>z.height),()=>te(e.value,z=>z.height)));const I=dl({width:n.value,height:s.value},i.value),W=window.innerWidth-(l.value&&i.value!==0?It:0),F=window.innerHeight;m.value=ot(Et(I.width,I.height,(z,oe)=>Math.min(W/z,F/oe))),(d||bo(r.value,m.value)||i.value!==0)&&(r.value=m.value),P()}function ve(d){if(d==null||d.assetId==null){Re();return}e.value=d,i.value=He(Nn(e.value),I=>I.rotation(),()=>0),At()||(r.value=null),t.value=null,se()}function Re(){const d=El();e.value=d.asset,t.value=d.previewAf,n.value=d.width,s.value=d.height,o.value=d.lastClientX,f.value=d.lastClientY,u.value=d.tx,v.value=d.ty,r.value=d.scale,h.value=d.maxScale,m.value=d.minScale,i.value=d.rotation,l.value=d.showInfo,c.value=d.showTransitions}function qe(d){t.value=ot(So(t.value,d)?void 0:d),At()||(r.value=null),se()}function ke(d){At()||d==null||e.value==null||(o.value=d.clientX,f.value=d.clientY,P())}function ee(d){const I=m.value;I!=null&&wl(()=>{r.value=on(ie(I,lt,d),3),P()})}function fe(){j.value&&m.value!=null&&ee(B.value?C(m.value):m.value)}function p(){r.value!=null&&ee(r.value*11/10)}function b(){r.value!=null&&ee(r.value*9/10)}function w(d){d==null||e.value==null||r.value==null||!d.shiftKey||i.value!==0||ee(r.value*(d.deltaY>0?31:33)/32)}function _(d){i.value===0&&(r.value=null),i.value=He(Nn(e.value),I=>I.rotate(d),()=>0),se(),Ji()}function O(d){c.value=!0,l.value=d,d?Bt?.pause():Bt?.resume(),se(),setTimeout(()=>{c.value=!1},1e3)}function U(d){c.value=d}async function N(d){const I=e.value,W=I?.assetId,F={...I};ve({...I,...d});try{const z=await Rl(W,d);if(z?.assetId===W)e.value?.assetId===W&&ve({...I,...z});else throw new Error("Unexpected server result")}catch(z){e.value?.assetId===W&&ve(F),Tt({text:"Failed to save asset",error:Vn(z)})}}return{asset:e,previewAf:t,width:n,height:s,lastClientX:o,lastClientY:f,tx:u,ty:v,scale:r,maxScale:h,minScale:m,rotation:i,showInfo:l,showTransitions:c,description:S,isVideo:a,isImage:y,isRotated:M,isMinScale:B,showZoom:j,scalePct:mt,scalePercent:De,minScalePct:nt,maxScalePct:st,assetWindowWidth:Me,assetDisplayWidth:ae,showActual:pt,isContainClass:ue,styleTransform:Ve,style:ce,imgAttrs:Fe,videoAttrs:vt,handleResize:se,setAsset:ve,resetAsset:Re,setPreviewAf:qe,onMouseMove:ke,setScale:ee,toggleZoom:fe,onZoomIn:p,onZoomOut:b,onWheel:w,addToRotation:_,setShowInfo:O,setTransitions:U,recomputeTranslations:P,save:N}});async function Rl(e,t){if(e==null||e<=0)throw new Error("saveAsset(): missing asset id");return Ht("/api/asset/"+e,{data:t,method:"PUT"})}const kl=be("fullscreen",()=>{const e=T(Ze());ms(o=>{e.value=o});function n(o){e.value=o??Ze()}function s(){Gi()}return{fullscreen:e,setFullscreen:n,toggle:s}}),Es=Se("aspect","square"),X=Se("s","m","l"),Al=80;function $l(e,t){const n={};return Ro(t.offset,s=>n.offset=s.toString()),Oe(`/api/t/${e}/assets`,n)}function Ql(e,t){const n={};return Te(t.seed)&&(n.seed=t.seed.toString()),Te(t.limit)&&(n.limit=t.limit.toString()),Te(t.offset)&&(n.offset=t.offset.toString()),Oe(`/api/t/${e}/child-tags`,n)}const Ge=Se("When","Who","Where","What","Camera","Lens","Albums","Keywords","Type","fs"),Cl=[Ge.When,Ge.Camera,Ge.Lens,Ge.Type,Ge.fs];function Yl(e){if(e==null)return!1;const t=ko(e)?e:e.tagPath?.[0];return!Cl.includes(t)}const Fn=4;function Pt(){return window.matchMedia("(max-width: 720px)").matches}function bs(e){switch(X.toValid(e)??"m"){case X.s:return Pt()?60:80;case X.l:return Pt()?240:320;case X.m:default:return Pt()?120:160}}function Xl(e){switch(X.toValid(e)??"m"){case X.s:return 100;case X.l:return 480;case X.m:default:return 200}}function Ut(e){return ie(1,85,Math.floor((document.documentElement.clientWidth+Fn)/(bs(e)+Fn)))}function ge(e){return Math.floor(Al/Ut(e))}function Ss(e){return ie(1,ge(e),Math.ceil(document.documentElement.clientHeight/bs(e)))}function _l(){return Es.toValid(localStorage.getItem("thumbFit"))??"square"}function Gt(){return X.toValid(localStorage.getItem("thumbSize"))??"m"}function qn(e=Gt()){return ie(1,ge(e),xt(localStorage.getItem("thumbRows-"+e))??Ss(e))}function Bn(e,t){X.includes(e)&&Te(t)&&localStorage.setItem("thumbRows-"+e,t.toString())}const Il=be("thumb",()=>{const e=T(_l()),t=T(qn()),n=T(Gt()),s=T(Ut(Gt())),o=L(()=>n.value==="s"?"sq_x4":n.value==="m"?"sq_x3":"sq_x2"),f=L(()=>e.value==="square"?"grid_square":"grid_aspect"),u=L(()=>e.value==="square"?"Aspect ratio grid":"Square photo grid"),v=L(()=>ie(1,ge(n.value),t.value??Ss(n.value))),r=L(()=>v.value<=1),h=L(()=>v.value>=ge(n.value)),m=L(()=>ge(n.value));function i(){const y=((X.indexOf(n.value)??0)+1)%X.values.length;A(X.values[y])}function l(){E(e.value==="square"?"aspect":"square")}function c(){s.value=Ut(n.value)}function E(a){const y=Es.toValid(a)??"square";localStorage.setItem("thumbFit",y),e.value=y}function A(a){const y=X.toValid(a)??"m";localStorage.setItem("thumbSize",y),n.value=y,t.value=qn(y),setTimeout(li,10),c()}function P(a=1){const y=ge(n.value);t.value=ie(1,y,v.value+a),Bn(n.value,t.value)}function C(){P(-1)}function S(a){const y=ge(n.value);t.value=ie(1,y,a),Bn(n.value,t.value)}return{thumbFit:e,thumbRows:t,thumbSize:n,thumbCols:s,thumbIcon:o,thumbFitIcon:f,thumbFitToggleTitle:u,actualThumbRows:v,disableDecrRows:r,disableIncrRows:h,maxThumbRows:m,cycleSize:i,cycleFit:l,handleResize:c,setThumbFit:E,setThumbSize:A,incrRows:P,decrRows:C,setThumbRows:S}}),Pl={id:"app-wrapper"},Tl={key:0,class:"dev-toolbar"},Ll=Ne({__name:"App",setup(e){const t=rs(),n=jt(),s=L(()=>t.query.dev!=null),o=Il(),f=Sl(),u=kl(),v=vs(),r=fs();let h;const m=new ji;let i;function l(){!v.paused&&Qi()&&v.resumeSSE()}const c=hs(()=>{f.handleResize(),o.handleResize()},25);function E(){window.addEventListener("resize",c,{passive:!0}),c()}function A(){window.removeEventListener("resize",c)}function P(C){u.setFullscreen(C)}return Hs(()=>{no(),E(),Ui(),ms(P),js("X-Settings",C=>r.set(qr(C))),h=setInterval(l,10*et),m.resume(),bl(m),i=new so,Vr()}),Ws(()=>{A(),Bi(P),h!=null&&clearInterval(h),m.pause(),i?.destroy(),Fr()}),Ks((C,S,a)=>(n.error(String(C),a),!0)),(C,S)=>{const a=Gn("RouterView");return V(),q("div",Pl,[(V(),Qe($s,{max:24,exclude:"Asset"},[(V(),Qe(a,{key:R(Yt)(R(t))?String(R(t).name):R(t).fullPath}))],1024)),k(Ii),k($r),k(qi),s.value?(V(),q("div",Tl,[S[4]||(S[4]=g("span",{class:"dev-label"},"Toast:",-1)),g("a",{onClick:S[0]||(S[0]=y=>R(n).show({type:"info",text:"This is a short description",details:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua",buttons:[{text:"An action button",onClick:null},{text:"Flob gervinerhoosers",onClick:null}]})),title:"Info toast"},[k(x,{icon:"info"})]),g("a",{onClick:S[1]||(S[1]=y=>R(n).success("Success","I did a thing! Praise me.")),title:"Success toast"},[k(x,{icon:"check"})]),g("a",{onClick:S[2]||(S[2]=y=>R(n).warning("Warning","Warning message")),title:"Warning toast"},[k(x,{icon:"warning"})]),g("a",{onClick:S[3]||(S[3]=y=>R(n).error("Error","Error message")),title:"Error toast"},[k(x,{icon:"close"})])])):K("",!0)])}}}),xl=ds(Ll,[["__scopeId","data-v-48a088e5"]]),Jt=Qs(xl);Jt.use(Ys());Jt.use(tt);Xs.setShim(e=>{e==="/splash"?document.location=e:tt.push(e)});Zs.setShim(e=>{e==="/splash"?document.location.replace(e):tt.replace(e)});Jt.mount("#mount");export{ni as A,Ur as B,hs as C,Bl as D,jl as E,oi as F,Al as T,Il as a,ht as b,ul as c,Wl as d,cl as e,kl as f,Hl as g,rs as h,Gl as i,zl as j,$l as k,Ul as l,ai as m,Ql as n,Qi as o,Sl as p,fs as q,Ge as r,Yl as s,Xl as t,vs as u,Oe as v,Kl as w,ms as x,Bi as y,ti as z};
