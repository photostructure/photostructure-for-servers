/**
 * Copyright Â© 2026, PhotoStructure Inc. All rights reserved.
 *
 * BY USING THIS SOFTWARE, YOU ACCEPT ALL OF THE TERMS IN
 * https://photostructure.com/eula
 * IF YOU DO NOT ACCEPT THESE TERMS, DO NOT USE THIS SOFTWARE
 */
import{l as n,d}from"./Lazy.js";import{c as f}from"./Blank.js";import{$ as m}from"./fe.js";import{o as v}from"./Maybe.js";const g=n(()=>f(globalThis?.navigator?.userAgent));function i(s){return document?.body?.classList?.contains(s)===!0}const C=n(()=>i("electron"));n(()=>i("linux"));const M=n(()=>i("mac"));n(()=>i("win"));const D=n(()=>i("ipad")||i("safari")||i("iphone")),H=n(()=>i("ipad")||i("safari")&&!i("iphone")&&navigator?.maxTouchPoints>1?(document?.body?.classList?.add("ipad"),document?.body?.classList?.remove("mac"),!0):!1);function T(){return i("enable-archive")}function Y(){return i("enable-remove")}function N(){return i("enable-delete")}function k(){return i("is-localhost")}const R=n(()=>/\bmacintosh\b|mac os x/i.exec(g())!=null);class w{promise;_resolve;_reject;constructor(){this.promise=new Promise((t,e)=>{this._resolve=t,this._reject=e})}_state="pending";isPending(){return this._state==="pending"}isSettled(){return!this.isPending()}isResolved(){return this._state==="resolved"}isRejected(){return this._state==="rejected"}state(){return this._state}toLogJSON(){return{_ctor:this[Symbol.toStringTag],state:this.state()}}then(t,e){return this.promise.then(t,e)}catch(t){return this.promise.catch(t)}finally(t){return this.promise.finally(t)}}let p=0;class b extends w{constructor(t=p++){super(),this.id=t}startedAt=Date.now();settledAt=void 0;[Symbol.toStringTag]="Latch";error;get elapsedMs(){return(this.settledAt??Date.now())-this.startedAt}resolve(){return this.isPending()&&(this.settledAt=Date.now(),this._resolve(),this._state="resolved"),this}reject(t){return this.isPending()&&(this.settledAt=Date.now(),this._reject(t),this._state="rejected",this.error=t),this}observe(t){return t.then(()=>this.resolve(),e=>this.reject(e)),this}observeQuietly(t){return t.then(()=>this.resolve(),()=>this.resolve()),this}}function y(s){return s!=null&&typeof s=="object"&&typeof s.then=="function"}function S(s){return y(s)&&typeof s.catch=="function"&&typeof s.finally=="function"}async function F({p:s,predicate:t,ifTrue:e}){const o=await s;return t(o)?e(o):void 0}function _({f:s,minCallDelayMs:t}){t=Math.max(50,t);let e,o=0,a=!1,c=0;const u=()=>{e?.resolve(),e=void 0,o=Date.now(),a=!1},r=(...h)=>{if(a)return;if(Date.now()>=o+t){a=!0,c++;try{const l=s(...h);return S(l)?l.finally(u):u(),l}catch(l){throw a=!1,l}}else return};return r.minCallDelayMs=()=>t,r.setMinCallDelayMs=h=>{t=Math.max(50,h)},r.isThrottled=()=>a||Date.now()<=o,r.donePromise=()=>a?e??=new b:Promise.resolve(),r.count=()=>c,r.force=async(...h)=>{for(;;)if(a)o=Date.now()+t*10,await d(50);else return o=0,r(...h)},r}const L=42;class z{toggleEl;hideClass;height;shown=!1;priorY;debounceMs=100;constructor(t={}){this.toggleEl=t.toggleEl??document.body,this.hideClass=t.hideClass??"header-hidden",this.height=(t.header??m("header"))?.offsetHeight??L,window.addEventListener("scroll",this.onScroll,{passive:!0}),window.addEventListener("focus",this.onFocus,{passive:!0}),this.setShown(!0)}destroy(){this.setShown(!0),window.removeEventListener("scroll",this.onScroll)}isNotHideClass(){return"not-"+this.hideClass}onFocus=()=>this.setShown(!0);setShown(t){if(t!==this.shown){this.shown=t;const e=this.toggleEl.classList;this.shown?(e.remove(this.hideClass),e.add(this.isNotHideClass())):(e.add(this.hideClass),e.remove(this.isNotHideClass()))}}onScroll=_({f:()=>{this._onScroll(),setTimeout(this._onScroll,this.debounceMs)},minCallDelayMs:this.debounceMs});_onScroll=()=>{const t=window.scrollY;if(this.priorY==null){this.priorY=t;return}const e=t-v(this.priorY,t);Math.abs(e)<this.height&&t>this.height||(this.priorY=t,this.setShown(e<0||this.height>t))}}export{z as S,M as a,i as b,k as c,H as d,D as e,Y as f,N as g,T as h,C as i,F as j,R as k,_ as t,g as u};
