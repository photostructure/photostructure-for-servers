#!/usr/bin/env node

/*
 * Copyright © 2022, PhotoStructure Inc.
 * By using this software, you accept all of the terms in <https://photostructure.com/eula>.
 * IF YOU DO NOT ACCEPT THESE TERMS, DO NOT USE THIS SOFTWARE
 */

(()=>{var t={38565:()=>{var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};t.SENTRY_RELEASE={id:"2.1.0-alpha.5+20220727172737"},t.SENTRY_RELEASES=t.SENTRY_RELEASES||{},t.SENTRY_RELEASES["photostructure-for-servers@photostructure-inc"]={id:"2.1.0-alpha.5+20220727172737"}},42041:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.gitDate=n.gitSha=n.release=n.versionPrerelease=n.versionPatch=n.versionMinor=n.versionMajor=n.version=void 0,n.version="2.1.0-alpha.5",n.versionMajor=2,n.versionMinor=1,n.versionPatch=0,n.versionPrerelease=["alpha",5],n.release="2.1.0-alpha.5+20220727172737",n.gitSha="7a29a43ed15edd8b990bd80f9b44d39aa64763bd",n.gitDate=new Date(1658968057e3),n.default={version:n.version,versionMajor:n.versionMajor,versionMinor:n.versionMinor,versionPatch:n.versionPatch,versionPrerelease:n.versionPrerelease,release:n.release,gitSha:n.gitSha,gitDate:n.gitDate}},79682:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.addFooter=n.CliDesc=void 0;const r=e(51081),o=e(3142),i=e(29993);n.CliDesc={main:"PhotoStructure's main process manager. Runs and manages web and sync services.",desktop:"PhotoStructure for Desktops. Manages web and sync services.",info:"Configuration, file metadata and import diagnostics tool.",list:"List paths in a PhotoStructure Library.",logcat:"Chronologically sort and pretty-print PhotoStructure logfiles.",logtail:"View the log messages of currently-running PhotoStructure processes as they are emitted. (Like `tail -f`).",web:"PhotoStructure's web service. Automatically started by main.",sync:"PhotoStructure's directory synchronization service. Automatically started by main."},n.addFooter=function(t){return t.on("--help",(()=>{console.log((0,r.joinLines)(...(0,o.cliWrap)(i.DescriptionFooter)))}))}},3142:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.cliWrap=void 0;const r=e(39369),o=e(75556),i=e(44726);n.cliWrap=function(t,n){const e=n?.maxLineLen??(0,o.toInt)(r.env.maxLineLen)??r.stdout.columns??75;return(0,i.wrap)(t,{maxLineLen:e,prefix:n?.prefix??""})}},29993:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DescriptionFooter=void 0,n.DescriptionFooter=["",`Copyright © 2017-${(new Date).getFullYear()}, PhotoStructure Inc.`,"","BY USING THIS SOFTWARE, YOU ARE ACCEPTING ALL THE TERMS AND CONDITIONS OF THIS LICENSE: <https://photostructure.com/eula/>","","User guide: <https://photostructure.com/user-guide/>","","Questions, bug reports, and feature requests: <https://forum.photostructure.com/>",""].join("\n")},38507:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.verifyUidGid=void 0;const r=e(11448),o=e(75556),i=e(97906),u=e(92028);function s(t,n,e){const r=(i=n,(0,o.toGt0)(process.env[i]));var i;return null!=r&&!e.includes(r)&&(console.error(`\nWARNING: ${t} is running as ${e} but $${n}=${r}.`),!0)}n.verifyUidGid=(0,r.lazy)((()=>{(0,i.isDocker)()&&(s("user id","PUID",(0,u.userids)())||s("group id","PGID",(0,u.groupids)()))&&(console.log("\nThis may result in file permission issues!"),console.log("See <https://forum.photostructure.com/t/1597/2> for details."))}))},51081:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.splitCompactLines=n.joinLines=n.splitLines=n.crlf=n.Newline=void 0;const r=e(11944),o=e(1429),i=e(44726),u=e(82798),s=e(51053);function l(...t){return(0,o.flatten)(t.map((t=>Array.isArray(t)?l(...t):(0,u.toS)(t).split((0,i.newlineRe)()))))}n.Newline=s.isWin?"\r\n":"\n",n.crlf=function(...t){const n=t.map(u.toS).join("\n");return s.isWin?n.replace((0,i.newlineRe)(),"\r\n"):n},n.splitLines=l,n.joinLines=function(...t){return l(...t).join(n.Newline)},n.splitCompactLines=function(...t){return(0,r.compactBlanks)(l(...t))}},51053:function(t,n,e){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.platformName=n.isElectron=n.isMainElectron=n.PS_IS_DOCKER=n.ELECTRON_RUN_AS_NODE=n.isPosix=n.isLinuxSnap=n.isLinuxAppImage=n.isLinux_arm=n.isArm=n.isLinux_x64=n.isLinux=n.isMac=n.isWinPortable=n.isWin=n.isCI=n.inspectFlag=void 0;const o=r(e(22037)),i=r(e(39369)),u=e(39938),s=e(38625),l=o.default.platform();n.inspectFlag=i.default.argv.includes("--inspect")||(0,s.isTrue)(i.default.env.NODE_INSPECT),n.isCI=(0,s.isTrue)(i.default.env.CI),n.isWin="win32"===l||"cygwin"===l,n.isWinPortable=n.isWin&&(0,u.notBlank)(i.default.env.PORTABLE_EXECUTABLE_DIR),n.isMac="darwin"===l,n.isLinux="linux"===l,n.isLinux_x64=n.isLinux&&"x64"===o.default.arch(),n.isArm="arm"===o.default.arch(),n.isLinux_arm=n.isLinux&&n.isArm,n.isLinuxAppImage=n.isLinux&&((0,u.notBlank)(i.default.env.APPIMAGE)||(0,u.notBlank)(i.default.env.APPDIR)),n.isLinuxSnap=n.isLinux&&(0,u.notBlank)(i.default.env.SNAP_USER_DATA),n.isPosix=n.isMac||n.isLinux,n.ELECTRON_RUN_AS_NODE="ELECTRON_RUN_AS_NODE",n.PS_IS_DOCKER="PS_IS_DOCKER",n.isMainElectron=null!=i.default.versions.electron,n.isElectron=n.isMainElectron||(0,s.isTrue)(i.default.env[n.ELECTRON_RUN_AS_NODE]),n.platformName=n.isWin?"win":n.isMac?"mac":n.isLinux?"linux":l},97906:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isDocker=void 0;const r=e(38625),o=e(11448),i=e(51053);n.isDocker=(0,o.lazy)((()=>i.isLinux&&(0,r.isTrue)(process.env.PS_IS_DOCKER)))},92028:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.groupids=n.userids=void 0;const r=e(11944),o=e(11448);n.userids=(0,o.lazy)((()=>(0,r.uniq)([process.geteuid?.(),process.getuid?.()]))),n.groupids=(0,o.lazy)((()=>(0,r.uniq)([process.getegid?.(),process.getgid?.()])))},11944:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.diff=n.primitiveValueOfOrElse=n.stepRange=n.range=n.anneal=n.commonPrefixLength=n.firstMatch=n.sum=n.count=n.clear=n.uniqBy2=n.uniqByLast=n.uniqBy=n.uniqSubstrings=n.uniq=n.compactBlankish=n.compactBlanks=n.compact=n.remove=n.insertUniq=n.insertAt=n.pushUniqBy=n.pushUniq=n.eqlPrimitiveUnordered=n.includesAll=n.includesAny=n.indexOf=n.includes=n.move=n.filterInPlaceAsync=n.filterInPlace=n.startsWith=n.arrayEql=n.deepSortBy=n.sortBy=n.sortedBy=n.sorted=n.sortUniqByInPlace=n.sortUniq=n.sortUniqBy=n.sortByInPlace=n.copyArrayTo=n.sort=n.mapNotEmptyOr=n.mapNotEmpty=n.mapArray=n.isEmpty=n.notEmptyOr=n.ifNotEmpty=n.isNotEmpty=void 0,n.arrToIterator=n.commaList=n.last=void 0;const r=e(39938),o=e(24603),i=e(47025),u=e(20810),s=e(87748),l=e(21040),c=e(66776),a=e(8199),f=e(23175),p=e(90957),d=e(39784),m=e(82798);function h(t){return null!=t&&(0,d.toA)(t).length>0}function g(t){return null==t||0===(0,d.toA)(t).length}function y(t){return(0,a.isPrimitive)(t)||(0,a.isPrimitiveArray)(t)?t:t.valueOf()}function v(t,n){for(let e=0;e<t.length;e++)n[e]=t[e];return n.length=t.length,n}function b(t,n){return v(E(t,n),t)}function S(t,n){const e=new Map;for(const r of t)(0,l.getOrSet)(e,(0,s.stringify)(n(r)),(()=>r));return E(e.values(),n)}function E(t,n){return(0,d.toA)(t).filter((t=>null!=t)).map(((t,e)=>({item:t,cmp:(0,c.map)(n(t,e),(t=>[t,e]))}))).filter((t=>null!=t.cmp)).sort(((t,n)=>(0,a.cmp)(t.cmp,n.cmp))).map((t=>t.item))}function O(t,n){return null!=t&&null!=n&&t.length===n.length&&t.every(((t,e)=>t===n[e]))}function M(t,n){for(let e=0;e<t.length;)n(t[e],e,t)?e++:t.splice(e,1);return t}function _(t,n,e){if(n===e||n<0||e<0||n>=t.length||e>=t.length)return t;const r=t[n];return t.splice(n,1),t.splice(e,0,r),t}function P(t){return null==t?[]:M((0,d.toA)(t),(t=>null!=t))}function A(t,n=(t=>(0,s.stringify)(t))){const e=new Map;for(const r of t)if(null!=r){const t=n(r);null!=t&&(0,l.getOrSet)(e,t,(()=>r))}return[...e.values()]}function x(t,n,e=1,r=(t=>t)){const o=[];if(t<n)for(let i=t;i<n;i+=e)o.push(r(i));else for(let i=t;i>n;i-=e)o.push(r(i));return o}n.isNotEmpty=h,n.ifNotEmpty=function(t){return h(t)?t:void 0},n.notEmptyOr=function(t,n){return h(t)?t:(0,p.tot)(n)},n.isEmpty=g,n.mapArray=function(t,n){return Array.isArray(t)?n(t):void 0},n.mapNotEmpty=function(t,n){return h(t)?n(t):void 0},n.mapNotEmptyOr=function(t,n,e){return h(t)?n(t):(0,p.tot)(e)},n.sort=function(t){return b(P(t),y)},n.copyArrayTo=v,n.sortByInPlace=b,n.sortUniqBy=S,n.sortUniq=function(t){return S(t,(t=>t))},n.sortUniqByInPlace=function(t,n){return v(S(t,n),t)},n.sorted=function(t){return t.every(((n,e)=>0===e||n>t[e-1]))},n.sortedBy=function(t,n){return t.every(((e,r)=>0===r||n(e)>n(t[r-1])))},n.sortBy=E,n.deepSortBy=function t(n,e){return E(n,e).map((n=>(0,u.isIterable)(n)?t(n,e):n))},n.arrayEql=O,n.startsWith=function(t,n){return O(t.slice(0,n.length),n)},n.filterInPlace=M,n.filterInPlaceAsync=async function(t,n){for(let e=0;e<t.length;)await n(t[e],e,t)?e++:t.splice(e,1);return t},n.move=_,n.includes=function(t,n){if(null==t)return!1;for(const e of t)if(n.valueOf()===e.valueOf())return!0;return!1},n.indexOf=function(t,n){if(null==t)return;let e=0;for(const r of t){if(n(r,e))return e;e++}},n.includesAny=function(t,n){return h(t)&&h(n)&&t.some((t=>n.includes(t)))},n.includesAll=function(t,n){if(g(t)||g(n))return!1;for(const e of n)if(!t.includes(e))return!1;return!0},n.eqlPrimitiveUnordered=function(t,n){if(null==t||null==n||t.length!==n.length)return!1;const e=E(t,y),r=E(n,y);return e.every(((t,n)=>t===r[n]))},n.pushUniq=function(t,...n){for(const e of n)t.some((t=>(0,o.eql)(t,e)))||t.push(e);return t},n.pushUniqBy=function(t,n,e){const r=t.map(e);for(const o of n){const n=e(o);r.includes(n)||(t.push(o),r.push(n))}return t},n.insertAt=function(t,n,...e){return t.splice(n,0,...e),t},n.insertUniq=function(t,n,e){for(let n=0;n<t.length-1;n++)if(e(t[n],t[n+1])>0)throw new Error("badly sorted array: "+t);for(let r=0;r<t.length;r++){const o=e(t[r],n);if(0===o)return t;if(o>0)return t.splice(r,0,n),t}return t.push(n),t},n.remove=function(t,...n){const e=t.length;return M(t,(t=>n.every((n=>!(0,o.eql)(t,n))))),e!==t.length},n.compact=P,n.compactBlanks=function(t){return null==t?[]:(0,d.toA)(t).map((t=>(0,m.toS)(t).trim())).filter((t=>t.length>0))},n.compactBlankish=function(t){return null==t?[]:[...t].filter(r.notBlankish)},n.uniq=function(t){if(null==t)return[];const n=P(t);if(n.length<=1)return n;if(n.length<10){const t=n[0];if(n.every((n=>n===t)))return[t]}return A(n,(t=>(0,a.isPrimitive)(t)?t:(0,s.stringify)(t)))},n.uniqSubstrings=function(t){if(null==t)return[];const n=P(t);if(0===t.length)return[];const e=[];for(const t of E(n,(t=>[-t.length,t.toLowerCase()])))e.some((n=>n.includes(t)))||e.push(t);return E(e,(t=>n.indexOf(t)))},n.uniqBy=A,n.uniqByLast=function(t,n=(t=>(0,s.stringify)(t))){const e=new Map;for(const r of t)if(null!=r){const t=n(r);null!=t&&e.set(t,r)}return[...e.values()]},n.uniqBy2=function(t,n){const e=[];for(const r of t)null!=r&&e.every((t=>!n(r,t)))&&e.push(r);return e},n.clear=function(t){return t.length=0,t},n.count=function(t,n){return t.reduce(((t,e,r)=>t+(n(e,r)?1:0)),0)},n.sum=function(t,n){return t.reduce(((t,e,r)=>t+n(e,r)),0)},n.firstMatch=function(t,n){for(const e of P(n)){const n=t.exec(e);if(null!=n)return n}},n.commonPrefixLength=function(t,n){if(null==t||null==n)return 0;if(t===n)return t.length;if("string"==typeof t&&(t=[...t]),"string"==typeof n&&(n=[...n]),O(t,n))return t.length;let e=0;for(;t[e]===n[e];)e++;return e},n.anneal=function({array:t,expense:n,allowedDelta:e}){const r=Math.round(e);if(r<2)return t;for(let e=0;e<t.length-1;e++){const o=(0,f.randomInt)(Math.max(0,e-r),Math.min(t.length,e+r),[e]);if(null==o)continue;const i=Math.max(0,Math.min(o,e)-1),u=Math.min(t.length,Math.max(o,e)+1),s=n(t,i,u);_(t,e,o);const l=n(t,i,u);(0,a.lt)(s,l)&&_(t,o,e)}return t},n.range=function(t,n,e=(t=>t)){return x(t,n,1,e)},n.stepRange=x,n.primitiveValueOfOrElse=t=>{if((0,a.isPrimitive)(t))return t;if(Array.isArray(t))return(0,s.stringify)(t);if((0,i.isFunction)(t.valueOf))return t.valueOf();throw new Error("Cannot get primitive value for "+JSON.stringify(t))},n.diff=function(t,e,r=n.primitiveValueOfOrElse){const o=new Set(e.map(r));return t.filter((t=>!o.has(r(t))))},n.last=function(t){return null!=t?t[t.length-1]:void 0},n.commaList=function(t,n="or"){return t.length<=1?t.join(""):2===t.length?t.join(" "+n+" "):t.slice(0,-1).join(", ")+", "+n+" "+t[t.length-1]},n.arrToIterator=function(t){return t[Symbol.iterator]()}},37609:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.at=void 0,n.at=function(t,n){if(null!=t&&((n=Math.trunc(n)||0)<0&&(n+=t.length),!(n<0||n>=t.length)))return t[n]}},39938:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.notBlankish=n.blankish=n.firstNotBlank=n.mapNotBlankOr=n.mapNotBlank=n.notBlankAnd=n.notBlankOr=n.toNotBlank=n.notBlank=n.blank=void 0;const r=e(66776),o=e(90957),i=e(82798);function u(t){if(null==t)return!0;const n=(0,i.toS)(t);return 0===n.length||0===n.trim().length}function s(t){return!u(t)}function l(t,n){if(!1===t||null==t||""===t)return;const e=(0,i.toS)(t);return s(e)?n(e):void 0}n.blank=u,n.notBlank=s,n.toNotBlank=function(t){if(null==t)return;const n=(0,i.toS)(t);return 0===n.length||0===n.trim().length?void 0:n},n.notBlankOr=function(t,n){if(null==t)return(0,o.tot)(n);const e=(0,i.toS)(t).trim();return e.length>0?e:(0,o.tot)(n)},n.notBlankAnd=function(t,n){return!u(t)&&n(t)},n.mapNotBlank=l,n.mapNotBlankOr=function(t,n,e){return(0,r.orElse)(l(t,n),e)},n.firstNotBlank=function(...t){for(const n of t)if("string"==typeof n&&n.trim().length>0)return n};const c=/^\s*(?:null|undefined)?\s*$/i;function a(t){return null==t||null!=c.exec((0,i.toS)(t))}n.blankish=a,n.notBlankish=function(t){return!a(t)}},38625:(t,n)=>{"use strict";function e(t){if("boolean"==typeof t)return t;if(null==t)return!1;if(1===t)return!0;const n=String(t).toLowerCase();return["true","1"].includes(n)}function r(t,...n){if("boolean"==typeof t)return!t;if(null==t)return!1;if(0===t)return!0;const e=String(t).toLowerCase();return["false","0",...n].map((t=>t.toLowerCase())).includes(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.mapTrue=n.mapBoolean=n.maybeAnd=n.and=n.or=n.isDisabled=n.isFalse=n.boolToInt=n.toBoolean=n.isTrue=n.isBoolean=void 0,n.isBoolean=function(t){return"boolean"==typeof t},n.isTrue=e,n.toBoolean=function(t){return!!e(t)||!r(t)&&void 0},n.boolToInt=function(t){return e(t)?1:0},n.isFalse=r,n.isDisabled=function(t){return r(t,"no","disable","disabled")},n.or=function(t){return t.some((t=>e(t)))},n.and=function(t){return t.every((t=>e(t)))},n.maybeAnd=function(t){let n;for(const e of t){if(!1===e)return!1;!0===e&&(n=!0)}return n},n.mapBoolean=function(t,n){return e(t)?n(!0):r(t)?n(!1):void 0},n.mapTrue=function(t,n){return e(t)?n():void 0}},24603:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isObjectEql=n.fieldEql=n.setFieldComparator=n.unshiftObjComparator=n.pushObjComparator=n.clearComparators=n.isArrayEql=n.eql=n.isSimpleEql=void 0;const r=e(38625),o=e(47025),i=e(61570),u=e(8199),s=e(44726);function l(t,n){return t===n||typeof t==typeof n&&(null==t||null==n?null==t&&null==n:(0,s.isString)(t)?(0,s.eqlStrings)(t,n):(0,u.isPrimitive)(t)?t===n:void 0)}function c(t,n,e=6){if(e<0)return!1;const r=l(t,n);if(null!=r)return r;const i=a(t,n,e);return null!=i?i:(0,o.isFunction)(t)&&(0,o.isFunction)(n)?t.toString()===n.toString():"object"==typeof t&&"object"==typeof n&&m(t,n)}function a(t,n,e=6){return Array.isArray(t)&&Array.isArray(n)?t.length===n.length&&t.every(((t,r)=>c(t,n[r],e-1))):void 0}n.isSimpleEql=l,n.eql=c,n.isArrayEql=a;const f=[];let p;function d(t,n,e,r=6){return p?.get(t)?.(n,e)??c(n,e,r-1)}function m(t,n,e=6){if(e<0||"object"!=typeof t||"object"!=typeof n)return!1;if(t===n)return!0;for(const e of f){const r=e(t,n);if(null!=r)return r}if((0,o.isFunction)(t.eql)){const e=t.eql(n);if((0,r.isBoolean)(e))return e}if((0,o.isFunction)(n.eql)){const e=n.eql(t);if((0,r.isBoolean)(e))return e}const u=(0,o.isFunction)(t.toJSON)?t.toJSON():t,s=(0,o.isFunction)(n.toJSON)?n.toJSON():n,c=l(u,s);if(null!=c)return c;const p=(0,i.keys)(u);if(!0!==a(p,(0,i.keys)(s),e))return!1;for(const t of p)if(!1===d(t,u[t],s[t],e-1))return!1;return!0}n.clearComparators=function(){f.length=0,p=void 0},n.pushObjComparator=function(t){f.push(t)},n.unshiftObjComparator=function(t){f.unshift(t)},n.setFieldComparator=function(t,n){(p??(p=new Map)).set(t,n)},n.fieldEql=d,n.isObjectEql=m},16475:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.errorFromJson=n.errorToJson=n.asError=n.shortStack=n.errorToVerbose=n.MissingError=n.errorToS=n.splitErrorMessage=n.errorErrno=n.errorCode=n.errorName=n.ErrorDelimiter=void 0;const r=e(11944),o=e(39938),i=e(75556),u=e(61570),s=e(44726),l=e(82798);n.ErrorDelimiter=": ";const c=["Error","String","Object","WrappedError"];function a(t){return[t.name,t.constructor?.name].find((t=>null!=t&&!c.includes(t)))?.toString()}function f(t){return(0,o.toNotBlank)(t?.code)}function p(t){return(0,i.toInt)(t?.errno)}function d(t){if(null==t)return[];const e=t,o=(0,s.isString)(e)?e:(0,s.isBuffer)(e)?e.toString():(0,l.toS)(e.message),i=[a(e),f(e),...o.split(n.ErrorDelimiter)],u=(0,r.compactBlanks)(i).filter((t=>!c.includes(t))).map((t=>t.replace(/^code ([A-Z]+)$/i,"$1").trim()));return(0,r.uniqSubstrings)(u)}function m(t,e){return(0,o.blankish)(t)?"":d(t).map((t=>(0,s.ellipsize)(t,e?.maxLen??300,32))).join(n.ErrorDelimiter)}n.errorName=a,n.errorCode=f,n.errorErrno=p,n.splitErrorMessage=d,n.errorToS=m,n.MissingError="(missing error)",n.errorToVerbose=function(t){return(0,o.blank)(t)&&(t=n.MissingError),m(t).trim()+" at "+g(t.stack).join("; ")};const h=/shortStack|errorToVerbose/;function g(t,n=9){if((0,o.blank)(t)){const n=new Error;Error.captureStackTrace(n),t=n.stack}const e=(0,l.toS)(t).split("\n").filter((t=>!(0,o.blank)(t)&&t.trim().startsWith("at ")&&null==h.exec(t))).slice(0,n).map((t=>t.replace(/^\s*at /i,"")));return(0,r.isEmpty)(e)?["(missing stack)"]:e}n.shortStack=g,n.asError=function(t){if((0,o.blank)(t))throw new Error("undefined error");if(t instanceof Error)return t;if(Array.isArray(t)){const n=t[0];return n instanceof Error?(t.length>1&&(n.errors=t.slice(1)),n):new Error(t.map((t=>(0,l.toS)(t))).filter(o.notBlank).join(", "))}{const e=m(t),r=e.indexOf(n.ErrorDelimiter);if(r>2&&r<15){const t=new Error(e.slice(r+1).trim());return t.name=e.slice(0,r).trim(),t}return new Error(e)}},n.errorToJson=function(t){return(0,u.compactValues)({_ctor:"Error",message:(0,s.isString)(t)?t:t.message,stack:t.stack,name:a(t),code:f(t),errno:p(t),...(0,u.omit)(t,"name","message","code","errno")})},n.errorFromJson=function(t){return(0,u.assignFields)(new Error,(0,u.omit)(t,"_ctor"))}},1429:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.flatten=void 0;const r=e(39784);n.flatten=function(t,n=[]){for(const e of(0,r.toA)(t))if(null!=e)for(const t of(0,r.toA)(e))null!=t&&n.push(t);return n}},20810:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isIterable=void 0,n.isIterable=function(t){return null!=t&&"string"!=typeof t&&"function"==typeof t[Symbol.iterator]}},87748:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.stringify=n.parseMaybe=void 0;const r=e(16475),o=e(66776);n.parseMaybe=function(t){try{if(null==t)return;const n=t.toString().trim();if(n.length>0)return JSON.parse(n)}catch{}},n.stringify=function(t,n,e,i){return JSON.stringify(t,function(t,n){const e=[],o=[],i=n??((t,n)=>e[0]===n?"[Circular ~]":"[Circular ~."+o.slice(0,e.indexOf(n)).join(".")+"]");return function(n,u){if(e.length>0){const t=e.indexOf(this);t>=0?(e.splice(t+1),o.splice(t,1/0,n)):(e.push(this),o.push(n)),e.indexOf(u)>=0&&(u=i.call(this,n,u))}else e.push(u);return u instanceof Error?(0,r.errorToJson)(u):null!=t?t.call(this,n,u):u}}(n,i),(0,o.denull)(e))}},11448:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.lazy=void 0;const r=e(11944),o=e(24603),i=e(75556);n.lazy=function(t,n){let e,u;const s=[];function l(t){return e=Date.now(),async function(t,n){if((0,r.isEmpty)(s))return;const e=await t,i=await n;if(!(0,o.eql)(e,i))for(const t of s)t(i)}(u,t),u=t}const c=()=>((null==e||null!=n&&n>0&&e+n<Date.now())&&l(t()),u);return c.set=t=>{l(t)},c.unset=()=>{l(void 0),e=void 0},c.clear=()=>{const t=u;return c.unset(),t},c.prior=()=>u,c.refresh=()=>l(t()),c.ttl=()=>n,c.setTTL=t=>{n=(0,i.gt0)(t)?t:void 0},c.watchLater=t=>{s.push(t)},c.watch=t=>{t(c()),c.watchLater(t)},c.toJSON=()=>"(Lazy)",c[Symbol.for("nodejs.util.inspect.custom")]=c.toString=()=>null==u?"(Lazy: unset)":String(u),c.lastSetAgoMs=()=>null==e?void 0:Date.now()-e,c.hasPrior=()=>null!=e,c}},21040:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.deleteIf=n.getOrSet=void 0,n.getOrSet=function(t,n,e){if(null==n)throw new Error("null key");if(t.has(n))return t.get(n);{const r=e();return null!=r&&t.set(n,r),r}},n.deleteIf=function(t,n){for(const[e,r]of t.entries())n(e,r)&&t.delete(e)}},66776:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.nulled=n.denull=n.firstDefined=n.allDefined=n.ifDefined=n.defined=n.map2Or=n.mapOr=n.orElse=n.map3=n.map2=n.mapTry=n.map=void 0;const r=e(90957),o=e(82798);function i(t,n){return null==t?void 0:n(t)}function u(t,n,e){return null==t||null==n?void 0:e(t,n)}function s(t,n){return null!=t?t:(0,r.tot)(n)}function l(t){return null!=t}n.map=i,n.mapTry=function(t,n){try{return i(t(),n)}catch{return}},n.map2=u,n.map3=function(t,n,e,r){return null==t||null==n||null==e?void 0:r(t,n,e)},n.orElse=s,n.mapOr=function(t,n,e){return null!=t?n(t):(0,r.tot)(e)},n.map2Or=function(t,n,e,r){return s(u(t,n,e),r)},n.defined=l,n.ifDefined=function(t,n){return void 0===t?void 0:n(t)},n.allDefined=function(t){return null!=t&&t.every(l)},n.firstDefined=function(...t){return t.find(l)},n.denull=function(t){return null==t||"null"===(0,o.toS)(t)?void 0:t},n.nulled=function(t){return null==t?null:t}},89253:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.groupByValues=n.groupBy=n.MultiMap=void 0;const r=e(11944),o=e(24603),i=e(21040),u=e(66776),s=e(39784);class l{constructor(t=new Map){this.store=t}get(t){return this.store.get(t)}has(t){return this.store.has(t)}includes(t,n){return!0===this.store.get(t)?.includes(n)}keyCount(){return this.store.size}valueCount(){return(0,r.sum)([...this.store.values()].map((t=>t.length)),(t=>t))}add(t,...n){const e=(0,i.getOrSet)(this.store,t,(()=>[]));return e.push(...n),e}addUniq(t,n,e){const r=this.store.get(t);null!=r&&e(r)||(0,i.getOrSet)(this.store,t,(()=>[])).push(n)}set(t,n){this.store.set(t,n)}delete(t,n){if(null==n)return this.store.delete(t);{const e=this.store.get(t);if(null==e)return!1;{const r=e.filter((t=>!(0,o.eql)(t,n)));return 0===r.length?this.store.delete(t):this.store.set(t,r),e.length!==r.length}}}clear(){return this.store.clear(),this}keys(){const t=this;return function*(){for(const[n,e]of t.store.entries())e.length>0&&(yield n)}()}values(){const t=this;return function*(){for(const[,n]of t.store.entries())n.length>0&&(yield n)}()}vacuum(t=((t,n)=>(0,r.uniq)(n))){for(const n of this.keys()){const e=this.store.get(n),o=null==e?[]:t(n,e);(0,r.isEmpty)(o)?this.store.delete(n):this.store.set(n,o)}}flatValues(){const t=this;return function*(){for(const[,n]of t.store.entries())if(n.length>0)for(const t of n)yield t}()}entriesArray(){return[...this.store.entries()].filter((([,t])=>(0,r.isNotEmpty)(t)))}entries(){const t=this;return function*(){for(const[n,e]of t.store.entries())e.length>0&&(yield[n,e])}()}tuples(){const t=this;return function*(){for(const[n,e]of t.store.entries())for(const t of(0,s.toA)(e))null!=t&&(yield[n,t])}()}filterInPlace(t){let n=!1;for(const[e,o]of this.store.entries()){const i=o.length;(0,r.filterInPlace)(o,(n=>t(e,n))),n=n||i!==o.length}return n}inverse(){const t=new l;for(const[n,e]of this.store.entries())for(const r of e)t.add(r,n);return t}findKeyByTuple(t){for(const[n,e]of this.tuples())if(t(n,e))return n}filterKeysByTuple(t){const n=[];for(const[e,r]of this.entries())r.some((n=>t(e,n)))&&n.push(e);return n}}function c(t,n){const e=new l;return t.forEach((t=>(0,u.map)(n(t),(n=>e.add(n,t))))),e}n.MultiMap=l,n.groupBy=c,n.groupByValues=function(t,n){const e=c(t,n);return(0,r.sortBy)((0,s.toA)(e.values()),(t=>n(t[0])))}},75556:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fmtPct=n.pct=n.times=n.clamp=n.base10Ceil=n.base2Ceil=n.sigFigs=n.toPrecisionMaybe=n.toPrecision=n.toFixedStr=n.toFixed=n.round=n.numericOr=n.mapNumericOr=n.map2Numeric=n.mapNumeric=n.mapIntOr=n.id=n.mapFloat=n.mapInt=n.gte0=n.lte0=n.gtOrElse=n.firstGt0=n.gt0=n.lt0=n.toGt0=n.toFloat=n.toInt=n.isToNumber=n.trunc=n.closeTo=n.max_=n.within=n.approximates=n.safeDivide=n.absdiff=n.diff=n.finiteOrElse=n.gte=n.gt=n.lte=n.lt=n.mapFinite=n.isBigInt=n.isNumeric=n.isDigits=n.isNumber=void 0;const r=e(39938),o=e(66776),i=e(90957),u=e(82798);function s(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}n.isNumber=s;const l=/^\d+$/;n.isDigits=function(t){return null!=(0,u.toS)(t).match(l)};const c=/[^-\.0-9\s]/;function a(t){return"bigint"==typeof t}function f(t,n){return s(t)?n(t):void 0}n.isNumeric=function(t){return null==(0,u.toS)(t).match(c)&&null!=v(t)},n.isBigInt=a,n.mapFinite=f;const p=t=>(n,e)=>s(n)&&s(e)&&t(n,e);function d(t,e,r){return!(null==r||!s(r))&&([t,e]=[Math.min(t,e),Math.max(t,e)],(0,n.gte)(r,t)&&(0,n.lte)(r,e))}function m(t){if(!s(t))return;const n=Math.trunc(t);return 0===n?Math.abs(n):n}function h(t){return"function"==typeof t?.toNumber}function g(t,n){if((0,r.blank)(t))return n.defaultValue;if(s(t))return n.nton(t);if(a(t)){if(t>BigInt(Number.MAX_SAFE_INTEGER)||t<BigInt(Number.MIN_SAFE_INTEGER))throw new Error("precision loss for "+t);return n.nton(Number(t))}if(h(t))return n.nton(t.toNumber());try{const e=n.ston((0,u.toS)(t).trim());return s(e)?n.nton(e):n.defaultValue}catch{return n.defaultValue}}function y(t,n){return g(t,{defaultValue:void 0,nton:t=>m(t),ston:parseInt,...n})}function v(t,n){return g(t,{defaultValue:void 0,nton:t=>t,ston:parseFloat,...n})}function b(t){return s(t)&&t>0}function S(t,n){const e=y(t);return null==e?void 0:n(e)}function E(t,n){return s(t)?n(t):void 0}function O(t){return s(t)?t<0?-Math.round(-t):Math.round(t):0}function M(t,n){if(null==t)return 0;const e=Math.pow(10,n);return O(t*e)/e}function _(t,n,e){if(t>n||!s(t)||!s(n))throw new Error(`invalid clamp(${t}, ${n}, ${e})`);return s(e)?e<t?t:e>n?n:e:O((t+n)/2)}n.lt=p(((t,n)=>t<n)),n.lte=p(((t,n)=>t<=n)),n.gt=p(((t,n)=>t>n)),n.gte=p(((t,n)=>t>=n)),n.finiteOrElse=function(t,n){return s(t)?t:n},n.diff=function(t,n){return s(t)&&s(n)?t-n:void 0},n.absdiff=function(t,n){return s(t)&&s(n)?Math.abs(t-n):void 0},n.safeDivide=function(t,n){return t/(0===n?1e-8:n)},n.approximates=function(t,n,e=.95){if(!s(t)||!s(n))return!1;if(t===n)return!0;if(e>=1)return!1;const r=(0===n?1e-5:n)*(1-e);return d(n-r,n+r,t)},n.within=d,n.max_=function(...t){let n;for(const e of t)s(e)&&(null==n||n<e)&&(n=e);if(null==n)throw new Error("no numbers given to max()");return n},n.closeTo=function(t,n,e){return!(!s(t)||!s(n))&&Math.abs(t-n)<e},n.trunc=m,n.isToNumber=h,n.toInt=y,n.toFloat=v,n.toGt0=function(t){const n=y(t);return null!=n&&n>0?n:void 0},n.lt0=function(t){return s(t)&&t<0},n.gt0=b,n.firstGt0=function(...t){for(const n of t){if(b(n))return n;const t=y(n);if(b(t))return t}},n.gtOrElse=function(t,n){return s(t)&&s(n)&&t>n?t:void 0},n.lte0=function(t){return s(t)&&t<=0},n.gte0=function(t){return s(t)&&t>=0},n.mapInt=S,n.mapFloat=function(t,n){const e=v(t);return null==e?void 0:n(e)},n.id=function(t){const n=y(t);return b(n)?String(n):void 0},n.mapIntOr=function(t,n,e){return(0,o.orElse)(S(t,n),e)},n.mapNumeric=E,n.map2Numeric=function(t,n,e){return E(t,(t=>E(n,(n=>e(t,n)))))},n.mapNumericOr=function(t,n,e){return s(t)?n(t):e},n.numericOr=function(t,n){return s(t)?t:(0,i.tot)(n)},n.round=O,n.toFixed=function(t,n){try{return E(t,(t=>O(t*10**n)/10**n))}catch(t){return}},n.toFixedStr=function(t,n){return t.toFixed(n).replace(/(\.0*$)|(?<=\d+\.\d+)0+$/,"")},n.toPrecision=M,n.toPrecisionMaybe=function(t,n){return f(t,(t=>M(t,n)))},n.sigFigs=function(t,n){if(0===t||0===n)return 0;const e=n-O(Math.ceil(Math.log10(Math.abs(t)))),r=Math.pow(10,Math.abs(e));return e<0?O(t/r)*r:O(t*r)/r},n.base2Ceil=function(t){return Math.pow(2,Math.ceil(Math.log2(t)))},n.base10Ceil=function(t){return Math.pow(10,Math.ceil(Math.log10(t)))},n.clamp=_,n.times=function(t,n){if(!b(t))return[];const e=Math.round(t);return e<=0?[]:[...Array(e)].map(((t,e)=>n(e)))},n.pct=function(t,n){return _(0,100,b(n)?O(100*(b(t)?t:0)/n):0)},n.fmtPct=function(t){const n=Math.round(t??-1);return d(0,100,n)?n+"%":void 0}},61570:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.flattenObject=n.firstValueCaseInsensitive=n.maybeCall=n.allKeys=n.filter=n.onlyReqValued=n.mapReqValued=n.reqValuedOrElse=n.isReqValued=n.omit=n.pickFirst=n.pickNonBlank=n.pickDeep=n.pick=n.mapFields=n.compactBlankValues=n.compactValuesDeep=n.compactValues=n.assignAllFields=n.assignSomeFields=n.assignFields=n.fromEntries=n.entries=n.values=n.mapCompactObj=n.notEmptyObj=n.emptyObj=n.keys=n.tap=void 0;const r=e(11944),o=e(39938),i=e(47025),u=e(66776),s=e(89253),l=e(8199),c=e(82798);function a(t){return null==t||"object"!=typeof t?[]:Object.keys(t).filter((n=>"string"==typeof n&&(null==t.propertyIsEnumerable||!0===t.propertyIsEnumerable(n))))}function f(t){if("object"!=typeof t)return!0;for(const n in t)if(void 0!==t[n])return!1;return!0}function p(t){return!f(t)}function d(t){return a(t).map((n=>t[n]))}function m(t){return a(t).map((n=>[n,t[n]]))}function h(t,n){if(null==t||0===t.length)return n;t=(0,r.compact)(t);for(const e of t)if(null!=e&&Array.isArray(e)){const[t,r]=e;null!=t&&void 0!==r&&("object"!=typeof n&&(n={}),n[t]=r)}return n}function g(t){if(null==t)return;const n=m(t);if(n.every((([,t])=>null!=t)))return t;const e=n.filter((([,t])=>null!=t));return(0,r.isEmpty)(e)?void 0:h(e)}function y(t,n,e={}){return h((0,r.compact)((0,r.sort)(a(t)).map((e=>n(e,t[e])))).filter((([t,n])=>null!=t&&void 0!==n)),e)}function v(t){return d(t).every((t=>null!=t))}n.tap=function(t,n){return null!=n?n(t):"string"==typeof t?console.log(t):console.dir(t,{depth:null}),t},n.keys=a,n.emptyObj=f,n.notEmptyObj=p,n.mapCompactObj=function(t,n){const e=g(t);return p(e)?n(e):void 0},n.values=d,n.entries=m,n.fromEntries=h,n.assignFields=function(t,n){if(null==n)return t;for(const[e,r]of m(n))null!=r&&(t[e]=r);return t},n.assignSomeFields=function(t,n,...e){if(null==n)return t;for(const r of e){const e=n[r];void 0!==e&&void 0===t[r]&&(t[r]=e)}return t},n.assignAllFields=function(t,n){if(null!=n)for(const[e,r]of m(n))t[e]=r;return t},n.compactValues=g,n.compactValuesDeep=function t(n){if(null!=n){if((0,l.isPrimitive)(n))return n;if(Array.isArray(n))return(0,r.compact)(n.map(t));{const e=(0,r.compact)(m(n).map((([n,e])=>(0,u.map)(t(e),(t=>[n,t])))));return 0===e.length?void 0:h(e)}}},n.compactBlankValues=function(t){if(null==t)return;const n=m(t).filter((([t,n])=>null!=t&&(0,o.notBlank)(n)));return(0,r.isEmpty)(n)?void 0:h(n)},n.mapFields=y,n.pick=function(t,...n){if(null==t)return t;const e={};for(const r of n)void 0!==t[r]&&(e[r]=t[r]);return e},n.pickDeep=function t(n,...e){if(null==n)return n;if(Array.isArray(n))return n.map((n=>t(n,...e)));const r=[],o=new s.MultiMap;for(const t of e.map(c.toS)){const n=t.indexOf(".");-1===n?r.push(t):o.add(t.slice(0,n),t.slice(n+1))}const i={};for(const t of r){const e=n[t];void 0!==e&&(i[t]=e)}const u=[...o.entries()];for(const[e,r]of u){const o=n[e];if(null!=o){const n=t(o,...r);void 0!==n&&(i[e]=n)}}return i},n.pickNonBlank=function(t,...n){if(null==t)return t;const e={};for(const r of n){const n=t[r];(0,o.notBlank)(n)&&(e[r]=n)}return e},n.pickFirst=function(t,n,e=u.defined){if(null!=t)for(const r of n)if(e(t[r]))return t[r]},n.omit=function(t,...n){if(null==t||n.every((n=>(0,o.blank)(t[n]))))return t;const e=m(t).filter((([t])=>!n.includes(t)));return(0,r.isEmpty)(e)?void 0:h(e)},n.isReqValued=v,n.reqValuedOrElse=function(t){return v(t)?t:void 0},n.mapReqValued=function(t,n){return v(t)?n(t):void 0},n.onlyReqValued=function(t){return t.filter(v)},n.filter=function(t,n){return null==t?t:h(m(t).filter((([t,e])=>n(t,e))))},n.allKeys=function(t){const n=a(t);for(;null!=(t=Reflect.getPrototypeOf(t));)n.push(...Reflect.ownKeys(t).filter((t=>"string"==typeof t)));return(0,r.uniq)(n)},n.maybeCall=function(t,n,...e){const r=t?.[n];return(0,i.isFunction)(r)?r.bind(t)(...e):void 0},n.firstValueCaseInsensitive=function(t,n){if((0,o.blank)(n))return;if(null!=t[n])return t[n];const e=n.toLowerCase().normalize();for(const n of a(t))if(e===n.toLowerCase().normalize()&&null!=t[n])return t[n]},n.flattenObject=function t(n){if(Array.isArray(n))return n.map(t);if("object"!=typeof n)return n;const e=y(n,((n,e)=>[n,t(e)])),r=d(e);return 1===r.length?r[0]:e}},8199:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.cmpArr=n.gt=n.gte=n.lte=n.lt=n.cmp=n.isPrimitiveArray=n.mapPrimitiveOr=n.mapPrimitive=n.isPrimitive=void 0;const r=e(11944),o=e(82798),i=["number","string","boolean"];function u(t){return-1!==i.indexOf(typeof t)||t instanceof Date}n.isPrimitive=u,n.mapPrimitive=function(t,n){return u(t)?n(t):void 0},n.mapPrimitiveOr=function(t,n,e){return u(t)?n(t):e()},n.isPrimitiveArray=function(t){return Array.isArray(t)&&t.every(u)};const s=["boolean","number","bigint","symbol","string","object","function"];function l(t,n){if(null==t&&null==n)return 0;if(null==t)return-1;if(null==n)return 1;const e=typeof t,r=typeof n;return"string"!==e&&"symbol"!==e||"string"!==r&&"symbol"!==r?Array.isArray(t)&&Array.isArray(n)?c(t,n):e!==r?s.indexOf(e)-s.indexOf(r):t>n?1:t<n?-1:0:(0,o.toS)(t).localeCompare((0,o.toS)(n))}function c(t,n,e=!0){if((0,r.isEmpty)(t)&&(0,r.isEmpty)(n))return 0;const o=Math.min(t.length,n.length);for(let e=0;e<o;e++){const r=l(t[e],n[e]);if(0!==r)return r}return l(t.length,n.length)*(e?1:-1)}n.cmp=l,n.lt=function(t,n){return l(t,n)<0},n.lte=function(t,n){return l(t,n)<=0},n.gte=function(t,n){return l(t,n)>=0},n.gt=function(t,n){return l(t,n)>0},n.cmpArr=c},23175:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.pickWeightedRandom=n.sample=n.shuffle=n.pickRandom=n.randomChar=n.randomChars=n.RandomChars=n.LowercaseChars=n.NumericChars=n.randomFloat=n.randomBoolean=n.randomInts=n.randomInt=void 0;const r=e(11944),o=e(75556);function i(t,n,e=[]){if(t=Math.ceil(t),(n=Math.floor(n))<t)return t;if((0,r.isNotEmpty)(e)&&e.length+10>n-t){const o=(0,r.range)(t,n).filter((t=>!e.includes(t)));return(0,r.mapNotEmpty)(o,(t=>t[i(0,o.length)]))}const o=Math.floor(Math.random()*(n-t))+t;return e.includes(o)?i(t,n,e):o}function u(t,n,e,r=[]){const o=[];for(;o.length<e;)o.push(i(t,n,[...o,...r]));return o}function s(t,n){return Math.random()*(n-t)+t}function l(t=n.RandomChars){return t[i(0,t.length)]}n.randomInt=i,n.randomInts=u,n.randomBoolean=function(t=.5){return Math.random()<=t},n.randomFloat=s,n.NumericChars="0123456789",n.LowercaseChars="abcdefghijkmnopqrstuvwxyz",n.RandomChars=n.NumericChars+n.LowercaseChars,n.randomChars=function(t,e=n.RandomChars){let r="";for(let n=0;n<t;n++)r+=l(e);return r},n.randomChar=l,n.pickRandom=function(t){return t[i(0,t.length)]},n.shuffle=function(t){const n=[...t];for(let t=n.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));t!==e&&([n[t],n[e]]=[n[e],n[t]])}return n},n.sample=function(t,n){const e=[];for(const r of u(0,t.length,n))e.push(t[r]);return e},n.pickWeightedRandom=function(t){if((0,r.isEmpty)(t))return;const n=t.filter((t=>(0,o.gt0)(t.priority)));let e=s(0,(0,r.sum)(n,(t=>t.priority)));return n.find((t=>(e-=t.priority,e<=0)))}},44726:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.splitLast=n.orList=n.compressWhitespace=n.replaceAll=n.eqlStrings=n.wrap=n.leftIndexOf=n.trimLastNewline=n.newlineRe=n.ellipsize=n.ensurePrefixSuffix=n.ensureSuffix=n.ensurePrefix=n.stripPrefixSuffix=n.stripSuffix=n.stripPrefix=n.trimRight=n.strslice=n.strlen=n.charAt=n.isBMP=n.isBuffer=n.isString=void 0;const r=e(37609),o=e(1429),i=e(75556),u=e(82798);function s(t){for(let n=t.length-1;n>=0;n--)if(t.charCodeAt(n)!==t.codePointAt(n))return!1;return!0}function l(t,n,e){return s(t)?(n<0&&(n+=t.length),null!=e&&e<0&&(e+=t.length),t.substring(n,e)):[...(0,u.toS)(t)].slice(n,e).join("")}function c(t,n){const e=(0,u.toS)(t),r=(0,u.toS)(n);return r.length>0&&e.startsWith(r)?e.slice(r.length):e}function a(t,n){if(null==n)return t;const e=(0,u.toS)(t),r=(0,u.toS)(n);return r.length>0&&e.endsWith(r)?e.slice(0,-r.length):e}function f(t,n){return null==n||""===n?t:(t=(0,u.toS)(t),n=(0,u.toS)(n),t.startsWith(n)?t:n+t)}function p(t,n){return null==n||""===n?t:(t=(0,u.toS)(t),n=(0,u.toS)(n),t.endsWith(n)?t:t+n)}function d(t,n,e){null==e&&(e=t.length);for(let r=e;r>=0;r--)if(l(t,r).startsWith(n))return r;return-1}n.isString=function(t){return"string"==typeof t},n.isBuffer=function(t){return"Buffer"===t?.constructor?.name},n.isBMP=s,n.charAt=function(t,n){if(s(t)){if((n=Math.trunc(n)||0)<0&&(n+=t.length),n<0||n>=t.length)return;return t[n]}return(0,r.at)([...(0,u.toS)(t)],n)},n.strlen=function(t){return s(t)?t.length:[...t].length},n.strslice=l,n.trimRight=function(t){return(0,u.toS)(t).replace(/\s+$/,"")},n.stripPrefix=c,n.stripSuffix=a,n.stripPrefixSuffix=function(t,{prefix:n,suffix:e}){return a(c(t,n),e)},n.ensurePrefix=f,n.ensureSuffix=p,n.ensurePrefixSuffix=function(t,{prefix:n,suffix:e}){return p(f(t,n),e)},n.ellipsize=function(t,n=80,e=0){if(null==t)return"";n=Math.max(1,(0,i.round)(n)),e=(0,i.clamp)(0,n-1,(0,i.round)(e));const r=[...(0,u.toS)(t)];return r.length<=n?r.join(""):r.slice(0,n-1-e).join("")+"…"+(e>0?r.slice(-e).join(""):"")},n.newlineRe=function(){return/\r?\n/gm},n.trimLastNewline=function(t){return(0,u.toS)(t).replace(/\r?\n$/,"")},n.leftIndexOf=d,n.wrap=function t(n,e){const r=e?.maxLineLen??78,i=e?.prefix??"";if(n.includes("\n"))return(0,o.flatten)(n.split(/\r?\n/gm).map((n=>t(n,e))));if((n=f((0,u.toS)(n),i).trim()).length<=r)return[n];const s=d(n," ",r);if(s>i.length)return[l(n,0,s),...t(l(n,s+1),e)];{const r=n.indexOf(" ",i.length+1);return r>0&&r<n.length-1?[l(n,0,r),...t(l(n,r+1),e)]:[n]}},n.eqlStrings=function(t,n){return null!=t&&null!=n&&(t===n||t.normalize()===n.normalize())},n.replaceAll=function(t,n,e){return""===n?t:t.split(n).join(e)},n.compressWhitespace=function(...t){return t.join(" ").replace(/\s+/g," ").trim()},n.orList=function(t){return t.length<=1?t.join(""):t.slice(0,-1).join(", ")+" or "+t[t.length-1]},n.splitLast=function(t,n){const e=(t=(0,u.toS)(t)).lastIndexOf(n);return-1===e?t:t.slice(e+n.length)}},90957:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NoOp=n.firstDefinedSuccess=n.firstDefinedThunk=n.tol=n.tot=void 0;const r=e(47025);n.tot=function(t){return(0,r.isFunction)(t)?t():t},n.tol=async function(t){return(0,r.isFunction)(t)?t():t},n.firstDefinedThunk=function(t){for(const n of t){const t=n();if(null!=t)return t}},n.firstDefinedSuccess=function(t){for(const n of t)try{const t=n();if(null!=t)return t}catch{}},n.NoOp=()=>{}},47025:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isFunction=void 0,n.isFunction=function(t){return"function"==typeof t}},39784:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toA=void 0;const r=e(20810),o=e(44726);n.toA=function(t){return Array.isArray(t)?t:null==t?[]:(0,o.isString)(t)?[t]:(0,r.isIterable)(t)?Array.from(t):[t]}},82798:(t,n)=>{"use strict";function e(t,n=","){return null==t?"":"string"==typeof t?t:Array.isArray(t)?t.map((t=>e(t,n))).join(n):t.toString()}Object.defineProperty(n,"__esModule",{value:!0}),n.toStr=n.toS=void 0,n.toS=function(t){return e(t,",")},n.toStr=e},87978:function(t,n,e){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});const o=e(7304),i=r(e(57147)),u=r(e(71017)),s=e(39369),l=e(79682),c=e(38507),a=e(42041);function f(t){for(const n of["bin",__dirname]){const e=u.default.join(n,t);if(i.default.existsSync(e))return e}return console.error("failed to find command "+t),t}o.program.version(a.version),o.program.description("Welcome to PhotoStructure, your new home for all your photos and videos.\nSee <https://photostructure.com/server/tools/> for details about these tools."),(0,c.verifyUidGid)(),(0,l.addFooter)(o.program).command("main",l.CliDesc.main+" (default)",{isDefault:!0,executableFile:f("main.js")}).command("info",l.CliDesc.info,{executableFile:f("info.js")}).command("list",l.CliDesc.list,{executableFile:f("list.js")}).command("logcat",l.CliDesc.logcat,{executableFile:f("logcat.js")}).command("logtail",l.CliDesc.logtail,{executableFile:f("logtail.js")}).command("web",l.CliDesc.web,{executableFile:f("web.js")}).command("sync",l.CliDesc.sync,{executableFile:f("sync.js")}).parse(s.argv)},7304:t=>{"use strict";t.exports=require("commander")},39369:t=>{"use strict";t.exports=require("process")},57147:t=>{"use strict";t.exports=require("fs")},22037:t=>{"use strict";t.exports=require("os")},71017:t=>{"use strict";t.exports=require("path")}},n={};function e(r){var o=n[r];if(void 0!==o)return o.exports;var i=n[r]={exports:{}};return t[r].call(i.exports,i,i.exports,e),i.exports}e(38565);var r=e(87978);module.exports=r})();
//# sourceMappingURL=photostructure.js.map