#!/usr/bin/env node

// Copyright © 2026, PhotoStructure Inc. All rights reserved.

// BY USING THIS SOFTWARE, YOU ACCEPT ALL OF THE TERMS IN
// https://photostructure.com/eula
// IF YOU DO NOT ACCEPT THESE TERMS, DO NOT USE THIS SOFTWARE

(()=>{"use strict";var t={1708(t){t.exports=require("node:process")},6858(t){t.exports=require("commander")},7282(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.nodeEnv=void 0,e.isDev=function(){return"development"===(0,e.nodeEnv)()},e.isTest=c,e.isProd=function(){return"production"===(0,e.nodeEnv)()},e.isSingleSpecTests=function(){return c()&&(0,i.isTrue)(o.default.env.SINGLE_SPEC_TESTS)},e.setSingleSpecTests=function(t){o.default.env.SINGLE_SPEC_TESTS=t?"true":"false"};const o=r(n(1708)),i=n(38639),u=n(54993),s=n(19851),l=n(29325),a=/mocha(?:\.js)?$|\.spec(\.js)?$/;function c(){return"test"===(0,e.nodeEnv)()}e.nodeEnv=(0,s.lazy)(()=>o.default.env.NODE_ENV=function(){if((0,l.isPacked)())return"production";switch((0,u.toS)(o.default.env.NODE_ENV).toLowerCase()){case"test":return"test";case"dev":case"development":return"development";case"prod":case"production":return"production";default:return o.default.argv.some(t=>null!=a.exec(t))?"test":"development"}}())},12168(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.SizeDescriptions=e.MP=e.TiB=e.GiB=e.MiB=e.KiB=e.TB=e.GB=e.MB=e.KB=e.decimalSep=e.thousandsSep=void 0,e.bytesToMB=function(...t){let n=0;for(const r of t)(0,i.isNumber)(r)&&(n+=r/e.MB);return(0,i.round)(n)},e.fmt=c,e.fmtToInt=function(t){return(0,r.mapNotBlank)(t,t=>(0,i.toInt)((0,l.replaceAll)(t,(0,e.thousandsSep)(),"")))},e.fmtMB=function(t,n=3){return p(t*e.MB,n)},e.fmtBytes=p,e.fmtMebi=function(t,e=3){if(0===t)return"0";const n=Math.floor(Math.log2(t)),r=Math.floor(n/10),o=Math.pow(2,10*r),u=d[r];return(0,i.sigFigs)(t/o,e)+" "+u},e.megapixels=function(t){return(0,i.sigFigs)(t/e.MP,2)},e.pixels2size=function(t){return t<76800?"tiny":t<345600?"small":t<2073600?"medium":"large"},e.plur=function(t,e,n){return null==t?"":(0,r.blank)(e)?c(t):(0===t?"no":c(t))+" "+(1===t?e:(n??(0,u.pluralize)(e)).trim())},e.plurMetric=function(t,e,n){return n??=(0,u.pluralize)(e),{count:c(t),desc:1===t?e:n}};const r=n(22573),o=n(45599),i=n(31586),u=n(46891),s=n(50989),l=n(51926),a=(0,o.defer)(()=>new Intl.NumberFormat);function c(t){return a().format(t)}e.thousandsSep=(0,o.defer)(()=>(0,l.replaceAll)(a().format(1111),"1","").charAt(0)),e.decimalSep=(0,o.defer)(()=>(0,l.replaceAll)(a().format(1.1),"1","").charAt(0)),e.KB=1e3,e.MB=1e3*e.KB,e.GB=1e3*e.MB,e.TB=1e3*e.GB,e.KiB=1024,e.MiB=1024*e.KiB,e.GiB=1024*e.MiB,e.TiB=1024*e.GiB;const f=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],d=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];function p(t,e=3){if(0===t)return"0";if(!(0,i.isNumber)(t))return"-";const n=Math.floor(Math.log10(t)),r=Math.floor(n/3),o=Math.pow(10,3*r),u=f[r];return(0,i.sigFigs)(t/o,e)+" "+u}e.MP=1e6,e.SizeDescriptions=(0,s.strEnum)("tiny","small","medium","large","original")},12487(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.deepEql=function(t,e,n){return n??={},!1!==n.memoize&&(n.memoize??=new WeakMap),s(t,e,n)};const r=n(38639),o=n(71696);function i(t,e,n){if(null==n||y(t)||y(e))return null;const r=n.get(t)?.get(e);return"boolean"==typeof r?r:null}function u(t,e,n,r){if(null==n||y(t)||y(e))return;let o=n.get(t);null!=o?o.set(e,r):(o=new WeakMap,o.set(e,r),n.set(t,o))}function s(t,e,n,r){if(null!=n?.comparator)return a(t,e,n,r);const o=l(t,e);return null!==o?o:a(t,e,n)}function l(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e||!y(t)&&!y(e)&&null}function a(t,e,n,r){n??={};const a=!1===n.memoize?void 0:n.memoize??=new WeakMap,f=n?.comparator,p=i(t,e,a);if(null!==p)return p;const g=i(e,t,a);if(null!==g)return g;if(f){const n=f(t,e,r);if(!1===n||!0===n)return u(t,e,a,n),n;const o=l(t,e);if(null!==o)return o}const y=(0,o.typeDetect)(t);if(y!==(0,o.typeDetect)(e))return u(t,e,a,!1),!1;u(t,e,a,!0);const v=function(t,e,n,r){switch(n){case"String":case"Number":case"Boolean":case"Date":return s(t.valueOf(),e.valueOf());case"Promise":case"Symbol":case"function":case"WeakMap":case"WeakSet":return t===e;case"Error":return m(t,e,["name","message","code"],r);case"Arguments":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"Array":return c(t,e,r);case"RegExp":return function(t,e){return t.toString()===e.toString()}(t,e);case"Generator":return function(t,e,n){return c(d(t),d(e),n)}(t,e,r);case"DataView":return c(new Uint8Array(t.buffer),new Uint8Array(e.buffer),r);case"ArrayBuffer":return c(new Uint8Array(t),new Uint8Array(e),r);case"Set":case"Map":return function(t,e,n){if(t.size!==e.size)return!1;if(0===t.size)return!0;const r=[],o=[];return t.forEach(function(t,e){r.push([t,e])}),e.forEach(function(t,e){o.push([t,e])}),c(r.sort(),o.sort(),n)}(t,e,r);case"Temporal.PlainDate":case"Temporal.PlainTime":case"Temporal.PlainDateTime":case"Temporal.Instant":case"Temporal.ZonedDateTime":case"Temporal.PlainYearMonth":case"Temporal.PlainMonthDay":return t.equals(e);case"Temporal.Duration":return t.total("nanoseconds")===e.total("nanoseconds");case"Temporal.TimeZone":case"Temporal.Calendar":return t.toString()===e.toString();default:return h(t,e,r)}}(t,e,y,n);return u(t,e,a,v),v}function c(t,e,n){const r=t.length;if(r!==e.length)return!1;if(0===r)return!0;let o=-1;for(;++o<r;)if(!1===s(t[o],e[o],n))return!1;return!0}function f(t){if(function(t){return"undefined"!=typeof Symbol&&"object"==typeof t&&void 0!==Symbol.iterator&&"function"==typeof t[Symbol.iterator]}(t))try{return d(t[Symbol.iterator]())}catch(t){return[]}return[]}function d(t){let e=t.next();const n=[e.value];for(;!1===e.done;)e=t.next(),n.push(e.value);return n}function p(t){const e=[];for(const n in t)void 0!==t[n]&&e.push(n);return e}function g(t){const e=[],n=Object.getOwnPropertySymbols(t);for(let r=0;r<n.length;r+=1){const o=n[r];!0===Object.getOwnPropertyDescriptor(t,o)?.enumerable&&e.push(o)}return e}function m(t,e,n,r){const o=n.length;if(0===o)return!0;for(let i=0;i<o;i+=1){const o=n[i],u=t[o],l=e[o];if("function"==typeof u&&"function"==typeof l){if(u.toString()!==l.toString())return!1}else if(!1===s(u,l,r,o))return!1}return!0}function h(t,e,n){if("function"==typeof t.eql){const n=t.eql(e);if((0,r.isBoolean)(n))return n}if("function"==typeof e.eql){const n=e.eql(t);if((0,r.isBoolean)(n))return n}if("function"==typeof t.toJSON)return h(t.toJSON(),e,n);if("function"==typeof e.toJSON)return h(t,e.toJSON(),n);if("object"==typeof t&&"object"==typeof e&&"function"==typeof t.constructor&&"function"==typeof e.constructor&&!1===h(t.constructor,e.constructor,n))return!1;const o=[...p(t),...g(t)],i=[...p(e),...g(e)];if(o.length&&o.length===i.length)return!1!==c(v(o).sort(),v(i).sort())&&m(t,e,o,n);const u=f(t),s=f(e);return u.length&&u.length===s.length?(u.sort(),s.sort(),c(u,s,n)):0===o.length&&0===u.length&&0===i.length&&0===s.length}function y(t){return null===t||"object"!=typeof t}function v(t){return t.map(function(t){return"symbol"==typeof t?t.toString():t})}},17344(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.EditionName=e.EditionType=void 0;const r=n(19851),o=n(72993),i=n(45969),u=n(43334);e.EditionType=(0,r.lazy)(()=>u.isElectron?"Desktops":(0,i.isDocker)()?"Docker":"Servers"),e.EditionName=(0,r.lazy)(()=>o.SimpleAppName+" for "+(0,e.EditionType)())},17586(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.at=function(t,e){if(null!=t)return(e=Math.trunc(e)||0)<0&&(e+=t.length),e<0||e>=t.length?void 0:t[e]}},19851(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.lazy=function(t,e){return new l(t,e)},e.rolazy=function(t,e){return new a(t,e)};const r=n(57975),o=n(50357),i=n(31586),u=n(65812),s=n(62344);class l extends s.ExtensibleFunction{fn;ttlMs;#t;#e;#n=null;watchers=[];constructor(t,e){super(),this.fn=t,this.ttlMs=e}_call(){return this.isStale()&&this.#r(this.fn()),this.#e}async#o(t,e){const n=await e;if(e!==this.#e)return;this.#n=n;const r=await t;if(!(0,o.eql)(r,n))for(const t of this.watchers)t(n);null!=this.ttlMs&&this.ttlMs>0&&void 0!==n&&(0,u.setUnrefTimeout)(()=>this.vacuum(),this.ttlMs)}setFn(t){this.fn=t,this.unset()}vacuum(){this.isStale()&&this.unset()}#r(t){return this.#n=null,this.#t=Date.now(),this.#o(this.#e,t),this.#e=t}isStale(){return null==this.#t||(0,i.gt0)(this.ttlMs)&&this.#t+this.ttlMs<Date.now()}set(t){this.#r(t)}unset(){this.#r(void 0),this.#t=void 0}clear(){const t=this.#e;return this.unset(),t}prior(){return this.vacuum(),this.#e}priorSync(){return this.vacuum(),this.#n}refresh(){return this.#r(this.fn())}ttl(){return this.ttlMs}setTTL(t){this.ttlMs=(0,i.gt0)(t)?t:void 0}watchLater(t){this.watchers.push(t)}watch(t){this.watchers.push(t)}toString(){return"[Lazy]"}[r.inspect.custom](){return"[Lazy]"}lastSetAgoMs(){return null==this.#t?void 0:Date.now()-this.#t}hasPrior(){return null!=this.#t}}class a extends l{set(t){}}},22573(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.blank=u,e.notBlank=s,e.notBlankToS=function(t){return s(t)&&"undefined"!==t?(0,i.toS)(t).trim():void 0},e.toNotBlank=function(t){if(null==t)return;const e=(0,i.toS)(t);return 0===e.length||0===e.trim().length?void 0:e},e.notBlankOr=function(t,e){if(null==t)return(0,o.tot)(e);const n=(0,i.toS)(t).trim();return n.length>0?n:(0,o.tot)(e)},e.notBlankAnd=function(t,e){return!u(t)&&e(t)},e.mapNotBlank=l,e.mapNotBlankOr=function(t,e,n){return(0,r.orElse)(l(t,e),n)},e.firstNotBlank=function(...t){for(const e of t)if("string"==typeof e&&e.trim().length>0)return e},e.blankish=c,e.notBlankish=function(t){return!c(t)};const r=n(55835),o=n(42279),i=n(54993);function u(t){return null==t||"string"==typeof t&&0===t.trim().length}function s(t){return!u(t)}function l(t,e){if(!1===t||null==t||""===t)return;const n=(0,i.toS)(t);return s(n)?e(n):void 0}const a=/^\s*(?:(?:null|undefined)\s*)?$/i;function c(t){return null==t||a.test((0,i.toS)(t))}},23541(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isError=function(t){return null!=t&&t instanceof Error}},23838(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.MultiMap=void 0,e.groupBy=d,e.groupByValues=function(t,e){const n=d(t,e);return(0,o.sortBy)((0,c.toA)(n.values()),t=>e(t[0]))};const r=n(40958),o=n(76790),i=n(50357),u=n(98553),s=n(49769),l=n(55835),a=n(51926),c=n(59455);class f{store;static fromJSON(t){const e=new f;for(const[n,r]of Object.entries(t))e.add(n,...r);return e}constructor(t=new Map){this.store=t}get(t){return this.store.get(t)}has(t){return this.store.has(t)}includes(t,e){return!0===this.store.get(t)?.includes(e)}keyCount(){return this.store.size}isEmpty(){for(const t of this.store.values())if(t.length>0)return!1;return!0}valueCount(){return(0,r.sum)([...this.store.values()].map(t=>t.length),t=>t)}add(t,...e){const n=(0,s.getOrSet)(this.store,t,()=>[]);return n.push(...e),n}addUniq(t,...e){return(0,r.pushUniq)((0,s.getOrSet)(this.store,t,()=>[]),...e)}set(t,e){this.store.set(t,e)}delete(t,e){if(null==e)return this.store.delete(t);{const n=this.store.get(t);if(null==n)return!1;{const r=n.filter(t=>!(0,i.eql)(t,e));return 0===r.length?this.store.delete(t):this.store.set(t,r),n.length!==r.length}}}clear(){return this.store.clear(),this}*keys(){for(const[t,e]of this.store.entries())e.length>0&&(yield t)}*values(){for(const t of this.store.values())t.length>0&&(yield t)}vacuum(t=(t,e)=>(0,r.uniq)(e)){for(const e of this.keys()){const n=this.store.get(e),o=null==n?[]:t(e,n);(0,r.isEmpty)(o)?this.store.delete(e):this.store.set(e,o)}}*valuesFlat(){for(const t of this.store.values())for(const e of t)yield e}entriesArray(){return[...this.store.entries()].filter(([,t])=>(0,r.isNotEmpty)(t))}*entries(){for(const[t,e]of this.store.entries())e.length>0&&(yield[t,e])}*tuples(){for(const[t,e]of this.store.entries())for(const n of(0,c.toA)(e))null!=n&&(yield[t,n])}filterInPlace(t){let e=!1;for(const[n,o]of this.store.entries()){const i=(0,r.findIndexes)(o,e=>!t(n,e,o));if(i.length>0){e=!0;for(const t of i.reverse())o.splice(t,1)}0===o.length&&this.store.delete(n)}return e}filterKeysInPlace(t){let e=!1;for(const[n,r]of this.store.entries())t(n,r)||(e=!0,this.store.delete(n));return e}inverse(){const t=new f;for(const[e,n]of this.store.entries())for(const r of n)t.add(r,e);return t}findKeyByTuple(t){for(const[e,n]of this.tuples())if(t(e,n))return e}filterKeysByTuple(t){const e=[];for(const[n,r]of this.entries())r.some(e=>t(n,e))&&e.push(n);return e}toJSON(){const t={};for(const[e,n]of this.entries())t[(0,a.isString)(e)?e:(0,u.stringify)(e)]=n;return t}}function d(t,e){const n=new f;return t.forEach(t=>(0,l.map)(e(t),e=>n.add(e,t))),n}e.MultiMap=f},28787(t){t.exports=require("he")},29325(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.isPacked=void 0;const r=n(19851);n(54993),e.isPacked=(0,r.lazy)(()=>!0)},30976(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.RandomChars=e.LowercaseChars=e.NumericChars=void 0,e.randomInt=u,e.randomInts=s,e.randomBoolean=function(t=.5){return Math.random()<=t},e.randomFloat=l,e.randomChars=function(t,n=e.RandomChars){const r=[];for(let e=0;e<t;e++)r.push(n[i(0,n.length)]);return r.join("")},e.pickRandom=function(t){return t[u(0,t.length)]},e.shuffle=function t(e){const n=[...e];for(let t=n.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));t!==e&&([n[t],n[e]]=[n[e],n[t]])}return e.length>2&&n.every((t,n)=>t===e[n])?t(e):n},e.sample=function(t,e){if(e<=0)return[];if(0===t.length)return[];const n=Math.min(e,t.length),r=[];for(const e of s(0,t.length,n))r.push(t[e]);return r},e.pickWeightedRandom=function(t){if((0,r.isEmpty)(t))return;const e=t.filter(t=>(0,o.gt0)(t.priority));let n=l(0,(0,r.sum)(e,t=>t.priority));return e.find(t=>(n-=t.priority,n<=0))};const r=n(40958),o=n(31586);function i(t,e){return Math.floor(Math.random()*(e-t))+t}function u(t,e,n){return null==n||0===n.length?i(t,e):s(t,e,1,n)[0]}function s(t,e,n,r){if(t=Math.ceil(t),(e=Math.floor(e))<t)throw new Error(`randomInts(): invalid range: ${t} > ${e}`);const o=e-t,u=new Set(r??[]);if(e===t&&0===o&&0===u.size&&1===n)return[t];const s=o-u.size;if(n>s)throw new Error(`randomInts(): cannot satisfy request: ${JSON.stringify({max:e,min:t,range:o,size:n,slotsRemaining:s})}`);const l=new Set;for(;l.size<n;){const n=i(t,e);u.has(n)||l.add(n)}return[...l]}function l(t,e){return Math.random()*(e-t)+t}e.NumericChars="0123456789",e.LowercaseChars="abcdefghijkmnopqrstuvwxyz",e.RandomChars=e.NumericChars+e.LowercaseChars},31586(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.isNumber=l,e.isInvalidNumber=a,e.isDigits=function(t){return c.test((0,s.toS)(t))},e.isNumeric=d,e.isBigInt=p,e.isFloat=function(t){return l(t)&&!Number.isInteger(t)},e.mapFinite=g,e.lt=function(t,e){return l(t)&&l(e)&&t<e},e.lte=m,e.gt=function(t,e){return l(t)&&l(e)&&t>e},e.gte=h,e.toFinite=function(t){return l(t)?t:void 0},e.finiteOrElse=function(t,e){return l(t)?t:e},e.diff=function(t,e){return l(t)&&l(e)?t-e:void 0},e.absdiff=function(t,e){return l(t)&&l(e)?Math.abs(t-e):void 0},e.safeDivide=function(t,e){return t/(0===e?1e-8:e)},e.approximates=function(t,e,n=.95){if(!l(t)||!l(e))return;if(t===e)return!0;if(n>=1)return!1;const r=Math.max(t,e)*(1-n);return y(e-r,e+r,t)},e.within=y,e.max_=function(...t){let e;for(const n of t)l(n)&&(null==e||e<n)&&(e=n);if(null==e)throw new Error("no numbers given to max()");return e},e.closeTo=function(t,e,n){return!(!l(t)||!l(e))&&Math.abs(t-e)<=n},e.isEquivalentNumber=function(t,e,n){return n<0||l(t)&&l(e)&&Math.abs(t-e)<=n},e.trunc=v,e.isToNumber=S,e.toInt=E,e.toFloat=_,e.toGt0=M,e.toGt=O,e.toGt0f=function(t){return P(t,0)},e.toGtf=P,e.lt0=function(t){return l(t)&&t<0},e.gt0=x,e.firstGt0=function(...t){for(const e of t){if(x(e))return e;const t=E(e);if(x(t))return t}},e.gtOrElse=function(t,e){return l(t)&&l(e)&&t>e?t:void 0},e.lte0=function(t){return l(t)&&t<=0},e.gte0=I,e.toGte0=function(t){return I(t)?t:void 0},e.mapInt=function(t,e){const n=E(t);return null==n?void 0:e(n)},e.mapFloat=function(t,e){const n=_(t);return null==n?void 0:e(n)},e.id=function(t){const e=E(t);return x(e)?String(e):void 0},e.mapNumeric=w,e.map2Numeric=function(t,e,n){return w(t,t=>w(e,e=>n(t,e)))},e.mapNumericOr=function(t,e,n){return l(t)?e(t):n},e.numericOr=function(t,e){return l(t)?t:(0,u.tot)(e)},e.round=A,e.toFixed=function(t,e){try{return w(t,t=>A(t*10**e)/10**e)}catch(t){return}},e.toFixedStr=function(t,e){return t.toFixed(e).replace(/\.0*$|(?<=\d\.\d+)0+$/,"")},e.roundToDecimalPlaces=F,e.toPrecisionMaybe=function(t,e){return g(t,t=>F(t,e))},e.sigFigs=function(t,e){if(!l(t)||0===t||0===e)return 0;const n=e-A(Math.ceil(Math.log10(Math.abs(t)))),r=Math.pow(10,Math.abs(n));return n<0?A(t/r)*r:A(t*r)/r},e.base2Ceil=function(t){return Math.pow(2,Math.ceil(Math.log2(t)))},e.base10Ceil=function(t){return Math.pow(10,Math.ceil(Math.log10(t)))},e.clamp=C,e.times=function(t,e){if(!x(t))return[];const n=Math.round(t);return n<=0?[]:[...Array(n)].map((t,n)=>e(n))},e.pct=function(t,e){return C(0,100,x(e)?A(100*(M(t)??0)/e):0)},e.fmtPct=function(t,e){const n=Math.round(t??-1);return null==e||y(0,e,n)?n+"%":void 0},e.roundEven=function(t){return Math.sign(t)*Math.round(Math.abs(t)/2)*2},e.toSum=function(...t){let e=0;for(const n of t){if(!l(n))return;e+=n}return e};const r=n(76790),o=n(22573),i=n(51926),u=n(42279),s=n(54993);function l(t){return"number"==typeof t&&isFinite(t)}function a(t){return"number"==typeof t&&(isNaN(t)||!isFinite(t))}const c=/^\d+$/,f=/^[+-]?[\d.]+$/;function d(t){if(l(t)||p(t))return!0;try{if((0,i.isString)(t)&&(t=t.trim(),f.test(t)))return isFinite(parseFloat(t))}catch{}return!1}function p(t){return"bigint"==typeof t}function g(t,e){return l(t)?e(t):void 0}function m(t,e){return l(t)&&l(e)&&t<=e}function h(t,e){return l(t)&&l(e)&&t>=e}function y(t,e,n){return!(null==n||!l(n))&&([t,e]=(0,r.sort)([t,e]),h(n,t)&&m(n,e))}function v(t){if(!l(t))return;const e=Math.trunc(t);return 0===e?Math.abs(e):e}function S(t){return"function"==typeof t?.toNumber}function b(t,e){if((0,o.blank)(t)||a(t))return e.defaultValue;if(!0===e.strict&&!d(t))return e.defaultValue;if(l(t))return e.nton(t);if(p(t)){if(t>BigInt(Number.MAX_SAFE_INTEGER)||t<BigInt(Number.MIN_SAFE_INTEGER))throw new Error("precision loss for "+t);return e.nton(Number(t))}if(S(t))return e.nton(t.toNumber());try{const n=e.ston((0,s.toS)(t).trim());return l(n)?e.nton(n):e.defaultValue}catch{return e.defaultValue}}function E(t,e){return b(t,{defaultValue:void 0,nton:t=>v(t),ston:parseInt,...e})}function _(t,e){return b(t,{defaultValue:void 0,nton:t=>t,ston:parseFloat,...e})}function M(t){return O(t,0)}function O(t,e){const n=E(t);return null!=n&&n>e?n:void 0}function P(t,e){const n=_(t);return null!=n&&n>e?n:void 0}function x(t){return l(t)&&t>0}function I(t){return l(t)&&t>=0}function w(t,e){return l(t)?e(t):void 0}function A(t){return l(t)?t<0?-Math.round(-t):Math.round(t):0}function F(t,e){if(null==t)return 0;const n=Math.pow(10,e);return A(t*n)/n}function C(t,e,n){if(t>e||!l(t)||!l(e))throw new Error(`invalid clamp(${t}, ${e}, ${n})`);return l(n)?n<t?t:n>e?e:n:(t+e)/2}},32639(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isFunction=function(t){return"function"==typeof t}},34666(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.CmpReverseFlag=void 0,e.isPrimitive=i,e.mapPrimitive=function(t,e){return i(t)?e(t):void 0},e.mapPrimitiveOr=function(t,e,n){return i(t)?e(t):n()},e.isPrimitiveArray=function(t){return Array.isArray(t)&&t.every(i)},e.isComparable=function t(e){return i(e)||e instanceof Date||Array.isArray(e)&&e.every(t)},e.cmp=s,e.lt=function(t,e){return s(t,e)<0},e.lte=function(t,e){return s(t,e)<=0},e.gte=function(t,e){return s(t,e)>=0},e.gt=function(t,e){return s(t,e)>0},e.cmpArr=l;const r=n(40958),o=n(54993);function i(t){switch(typeof t){case"number":return isFinite(t);case"string":case"boolean":return!0;default:return!1}}const u=["boolean","number","bigint","symbol","string","object","function"];function s(t,n){if(t===n)return 0;if(null==t)return-1;if(null==n)return 1;const r=typeof t,i=typeof n;if(!("string"!==r&&"symbol"!==r||"string"!==i&&"symbol"!==i)){const r=(0,o.toS)(t),i=(0,o.toS)(n),u=r.localeCompare(i);return r[0]===e.CmpReverseFlag&&i[0]===e.CmpReverseFlag?-u:u}return Array.isArray(t)&&Array.isArray(n)?l(t,n):r!==i?u.indexOf(r)-u.indexOf(i):t>n?1:t<n?-1:0}function l(t,e,n=!0){if((0,r.isEmpty)(t)&&(0,r.isEmpty)(e))return 0;const o=Math.min(t.length,e.length);for(let n=0;n<o;n++){const r=s(t[n],e[n]);if(0!==r)return r}return s(t.length,e.length)*(n?1:-1)}e.CmpReverseFlag="⤹"},36783(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.copyArrayTo=function(t,e){for(let n=0;n<t.length;n++)e[n]=t[n];return e.length=t.length,e}},37805(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.gitDate=e.gitSha=e.release=e.versionPrerelease=e.versionPatch=e.versionMinor=e.versionMajor=e.version=void 0,e.version="2026.1.0-beta",e.versionMajor=2026,e.versionMinor=1,e.versionPatch=0,e.versionPrerelease=["beta"],e.release="2026.1.0-beta+20260118182607",e.gitSha="ccc32cfa5623ff0a75be394d5da086a69b3e642a",e.gitDate=new Date(1768789567e3),e.default={version:e.version,versionMajor:e.versionMajor,versionMinor:e.versionMinor,versionPatch:e.versionPatch,versionPrerelease:e.versionPrerelease,release:e.release,gitSha:e.gitSha,gitDate:e.gitDate}},38453(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.splitFirst=function(t,e){const n=t.indexOf(e);return-1===n?[t]:[t.slice(0,n),t.slice(n+e.length)]}},38639(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.DISABLED=void 0,e.isBoolean=function(t){return"boolean"==typeof t},e.isTrue=o,e.toBoolean=function(t){return!!o(t)||!i(t)&&void 0},e.toNotBoolean=function(t){return!o(t)&&(!!i(t)||void 0)},e.boolToInt=function(t){return o(t)?1:0},e.isFalse=i,e.isDisabled=function(t){return i(t)||u.includes((0,r.toS)(t).toLowerCase())},e.or=function(t){return t.some(t=>o(t))},e.and=function(t){return t.every(t=>o(t))},e.maybeOr=function(t){let e;for(const n of t){if(!0===n)return!0;!1===n&&(e??=!1)}return e},e.maybeAnd=function(t){let e;for(const n of t){if(!1===n)return!1;!0===n&&(e??=!0)}return e},e.mapBoolean=function(t,e){return o(t)?e(!0):i(t)?e(!1):void 0},e.mapTrue=function(t,e){return o(t)?e():void 0};const r=n(54993);function o(t){if("boolean"==typeof t)return t;if(null==t)return!1;if(1===t)return!0;{const e=String(t).toLowerCase().trim();return["true","1"].includes(e)}}function i(t){if("boolean"==typeof t)return!t;if(null==t)return!1;if(0===t)return!0;const e=String(t).toLowerCase();for(const t of["false","0"])if(e===t)return!0;return!1}e.DISABLED="disabled";const u=["disable",e.DISABLED,"never","no","none","off"]},38835(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.InternalErrorRe=e.FatalErrorRe=e.FatalErrorPatterns=e.FailStr=e.ErrorFlagsRE=e.ErrorFlagDescriptions=e.WebFatalErrorFlag=e.DbSetupErrorFlag=e.NoLibraryErrorFlag=e.HealthCheckWarningFlag=e.HealthCheckErrorFlag=e.InternalErrorFlag=e.PleaseSendErrorFlag=e.DoNotSendErrorFlag=e.DoNotRetryErrorFlag=e.NonRetriableErrorFlag=e.RetriableErrorFlag=e.NonIgnorableErrorFlag=e.IgnorableErrorFlag=e.NonFatalErrorFlag=e.FatalErrorFlag=e.ErrorFlags=void 0,e.sortErrorFlags=function(t){return(0,o.sortBy)((0,r.uniq)(t),t=>e.ErrorFlags.indexOf(t))};const r=n(40958),o=n(76790),i=n(50989),u=n(68852);e.ErrorFlags=(0,i.strEnum)("¹","²","³","⁴","⁵","⁶","⁷","⁸","⁹","₀","₁","₂","₃","₄"),e.FatalErrorFlag=e.ErrorFlags["¹"],e.NonFatalErrorFlag=e.ErrorFlags["₂"],e.IgnorableErrorFlag=e.ErrorFlags["³"],e.NonIgnorableErrorFlag=e.ErrorFlags["₄"],e.RetriableErrorFlag=e.ErrorFlags["⁷"],e.NonRetriableErrorFlag=e.ErrorFlags["²"],e.DoNotRetryErrorFlag=e.NonRetriableErrorFlag,e.DoNotSendErrorFlag=e.ErrorFlags["⁶"],e.PleaseSendErrorFlag=e.ErrorFlags["⁴"],e.InternalErrorFlag=e.ErrorFlags["⁹"],e.HealthCheckErrorFlag=e.ErrorFlags["⁵"],e.HealthCheckWarningFlag=e.ErrorFlags["⁸"],e.NoLibraryErrorFlag=e.ErrorFlags["₀"],e.DbSetupErrorFlag=e.ErrorFlags["₁"],e.WebFatalErrorFlag=e.ErrorFlags["₃"],e.ErrorFlagDescriptions={[e.FatalErrorFlag]:"FatalErrorFlag",[e.NonFatalErrorFlag]:"NonFatalErrorFlag",[e.IgnorableErrorFlag]:"IgnorableErrorFlag",[e.NonIgnorableErrorFlag]:"NonIgnorableErrorFlag",[e.RetriableErrorFlag]:"RetriableErrorFlag",[e.NonRetriableErrorFlag]:"NonRetriableErrorFlag",[e.DoNotSendErrorFlag]:"DoNotSendErrorFlag",[e.PleaseSendErrorFlag]:"PleaseSendErrorFlag",[e.InternalErrorFlag]:"InternalErrorFlag",[e.HealthCheckErrorFlag]:"HealthCheckErrorFlag",[e.HealthCheckWarningFlag]:"HealthCheckWarningFlag",[e.NoLibraryErrorFlag]:"NoLibraryErrorFlag",[e.DbSetupErrorFlag]:"DbSetupErrorFlag",[e.WebFatalErrorFlag]:"WebFatalErrorFlag"},e.ErrorFlagsRE=new RegExp("("+e.ErrorFlags.values.join("|")+")","g"),e.FailStr=JSON.stringify({fatal:!0}),e.FatalErrorPatterns=["EADDRINUSE","SQLITE_FULL","SQLITE_CORRUPT","SQLITE_IOERR","SQLITE_NOMEM","SQLITE_NOTADB","ON CONFLICT","SQLITE_CONSTRAINT_NOTNULL","Error: Cannot find module",e.FatalErrorFlag,e.FailStr],e.FatalErrorRe=new RegExp(e.FatalErrorPatterns.map(u.escapeRegExp).join("|"),"i"),e.InternalErrorRe=/⁹|internal ?error/i},39926(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.padding=u,e.leftPad=s,e.padNumeric=l,e.pad2=function(t){return l(t,2)},e.pad3=function(t){return l(t,3)},e.pad4=function(t){return l(t,4)};const r=n(31586),o=n(54993),i={};function u(t,e){if(e<1)return"";if(!(0,r.gte)(i[t]?.length,e)){let n=i[t]??t;for(;n.length<e;)n+=t;i[t]=n}return i[t].substring(0,e)}function s(t,e,n){if(0===n.length)throw new Error("leftPad() given empty pad");if((0,r.lt)(t,0))return"-"+s(String(Math.abs(t)),e-1,n);const i=(0,o.toS)(t);return u(n,e-i.length)+i}function l(t,e){return s((0,r.isNumber)(t)?(0,r.round)(t):"0",e,"0")}},40958(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.primitiveValueOfOrElse=void 0,e.isNotEmpty=g,e.toNotEmpty=function(t){return g(t)?t:void 0},e.notEmptyOr=function(t,e){return g(t)?t:(0,c.tot)(e)},e.isEmpty=m,e.mapArray=function(t,e){return Array.isArray(t)?e(t):void 0},e.mapNotEmpty=function(t,e){return g(t)?e(t):void 0},e.mapNotEmptyOr=function(t,e,n){return g(t)?e(t):(0,c.tot)(n)},e.toPrimitive=h,e.startsWith=function(t,e){return y(t.slice(0,e.length),e)},e.filterInPlace=v,e.filterInPlaceAsync=async function(t,e){for(let n=0;n<t.length;)!0===await e(t[n],n,t)?n++:t.splice(n,1);return t},e.move=S,e.flatMap=function(t,e){const n=[];for(const r of t)n.push(...b(e(r)));return n},e.includes=function(t,e){if(null==t)return!1;for(const n of t)if(e.valueOf()===n.valueOf())return!0;return!1},e.indexOf=function(t,e){if(null==t)return;let n=0;for(const r of t){if(e(r,n))return n;n++}},e.indexOfPrimitive=function(t,e){if(null==t)return;let n=0;for(const r of t){if(r===e)return n;n++}},e.includesAny=function(t,e){return g(t)&&g(e)&&t.some(t=>e.includes(t))},e.includesAll=function(t,e){if(m(t)||m(e))return!1;for(const n of e)if(!t.includes(n))return!1;return!0},e.eqlPrimitiveUnordered=function(t,e){if(null==t||null==e||t.length!==e.length)return!1;const n=(0,r.sortBy)(t,h),o=(0,r.sortBy)(e,h);return n.every((t,e)=>t===o[e])},e.pushNotSame=function(t,...e){for(const n of e)null==n||t.includes(n)||t.push(n);return t},e.pushUniq=function(t,...e){for(const n of e)null!=n&&null==(0,i.findEql)(t,n)&&t.push(n);return t},e.pushUniqBy=function(t,e,n){const r=t.map(n);for(const o of e){const e=n(o);r.includes(e)||(t.push(o),r.push(e))}return t},e.insertAt=function(t,e,...n){return t.splice(e,0,...n),t},e.insertUniq=function(t,e,n){for(let e=0;e<t.length-1;e++)if(n(t[e],t[e+1])>0)throw new Error("badly sorted array: "+t);for(let r=0;r<t.length;r++){const o=n(t[r],e);if(0===o)return t;if(o>0)return t.splice(r,0,e),t}return t.push(e),t},e.remove=function(t,...e){const n=t.length;return v(t,t=>e.every(e=>!(0,i.eql)(t,e))),n!==t.length},e.removeSame=function(t,...e){const n=t.length;return v(t,t=>e.every(e=>t!==e)),n!==t.length},e.compact=b,e.compactBlanks=function(t){return null==t?[]:(0,d.toA)(t).map(t=>(0,p.toS)(t).trim()).filter(t=>t.length>0)},e.compactBlankish=function(t){return null==t?[]:[...t].filter(o.notBlankish)},e.uniq=function(...t){if(null==t)return[];const e=[];for(const n of t)if(null!=n)for(const t of n)null!=t&&e.push(t);return E(e,t=>(0,l.isPrimitive)(t)?t:(0,u.stringify)(t))},e.uniqFirst=function(t){if(null==t)return[];const e=[];for(const n of t)null==n||(0,i.eql)(e[e.length-1],n)||e.push(n);return e},e.uniqSubstrings=function(t){if(null==t)return[];const e=b(t);if(0===t.length)return[];const n=[];for(const t of(0,r.sortBy)(e,t=>[-t.length,t.toLowerCase()]))n.some(e=>e.includes(t))||n.push(t);return(0,r.sortBy)(n,t=>e.indexOf(t))},e.uniqBy=E,e.uniqByLast=function(t,e=t=>(0,u.stringify)(t)){const n=new Map;for(const r of t)if(null!=r){const t=e(r);null!=t&&n.set(t,r)}return[...n.values()]},e.uniqBy2=function(t,e){const n=[];for(const r of t)null!=r&&n.every(t=>!e(r,t))&&n.push(r);return n},e.clear=function(t){return t.length=0,t},e.count=function(t,e){let n=0;for(const r of t)e(r,n)&&n++;return n},e.sum=function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=e(t[r],r);return n},e.firstMatch=function(t,e){for(const n of b(e)){const e=t.exec(n);if(null!=e)return e}},e.commonPrefixLength=function(t,e){if(null==t||null==e)return 0;if(t===e)return t.length;if("string"==typeof t&&(t=[...t]),"string"==typeof e&&(e=[...e]),y(t,e))return t.length;let n=0;for(;t[n]===e[n];)n++;return n},e.anneal=function({array:t,expense:e,allowedDelta:n}){const r=Math.round(n);if(r<2)return t;for(let n=0;n<t.length-1;n++){const o=(0,a.randomInt)(Math.max(0,n-r),Math.min(t.length,n+r),[n]);if(null==o)continue;const i=Math.max(0,Math.min(o,n)-1),u=Math.min(t.length,Math.max(o,n)+1),s=e(t,i,u);S(t,n,o);const c=e(t,i,u);(0,l.lt)(s,c)&&S(t,o,n)}return t},e.range=function(t,e,n=t=>t){return _(t,e,1,n)},e.stepRange=_,e.diff=function(t,n,r=e.primitiveValueOfOrElse){const o=new Set(n.map(r));return t.filter(t=>!o.has(r(t)))},e.last=function(t){return null!=t?t[t.length-1]:void 0},e.commaList=function(t,e="or"){return t.length<=1?t.join(""):2===t.length?t.join(" "+e+" "):t.slice(0,-1).join(", ")+", "+e+" "+t[t.length-1]},e.arrToIterator=function(t){return t[Symbol.iterator]()},e.arrayEndsWith=function(t,e){if(t.length<e.length)return!1;for(let n=0;n<e.length;n++)if(t[t.length-e.length+n]!==e[n])return!1;return!0},e.findIndexes=function(t,e){const n=[];for(let r=0;r<t.length;r++)e(t[r],r)&&n.push(r);return n};const r=n(76790),o=n(22573),i=n(50357),u=n(98553),s=n(49769),l=n(34666),a=n(30976),c=n(42279),f=n(32639),d=n(59455),p=n(54993);function g(t){return null!=t&&(0,d.toA)(t).length>0}function m(t){return null==t||0===(0,d.toA)(t).length}function h(t){return(0,l.isPrimitive)(t)||(0,l.isPrimitiveArray)(t)?t:t.valueOf()}function y(t,e){return null!=t&&null!=e&&t.length===e.length&&t.every((t,n)=>t===e[n])}function v(t,e,n=!1){for(let r=0;r<t.length;)if(e(t[r],r,t))r++;else if(t.splice(r,1),n)break;return t}function S(t,e,n){if(e===n||e<0||n<0||e>=t.length||n>=t.length)return t;const r=t[e];return t.splice(e,1),t.splice(n,0,r),t}function b(t){return null==t?[]:v((0,d.toA)(t),t=>null!=t)}function E(t,e=t=>(0,u.stringify)(t)){const n=new Map;for(const r of t)if(null!=r){const t=e(r);null!=t&&(0,s.getOrSet)(n,t,()=>r)}return[...n.values()]}function _(t,e,n=1,r=t=>t){const o=[];if(t<e)for(let i=t;i<e;i+=n)o.push(r(i));else for(let i=t;i>e;i-=n)o.push(r(i));return o}e.primitiveValueOfOrElse=t=>{if((0,l.isPrimitive)(t))return t;if(Array.isArray(t))return(0,u.stringify)(t);if((0,f.isFunction)(t.valueOf))return t.valueOf();throw new Error("Cannot get primitive value for "+JSON.stringify(t))}},41269(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.CliDesc=void 0,e.CliDesc={main:"PhotoStructure's main process manager. Runs and manages web and sync services.",desktop:"PhotoStructure for Desktops. Manages web and sync services.",fix:"PhotoStructure's library settings and database check and repair tool.",info:"PhotoStructure's configuration, file metadata and aggregation diagnostics tool.",list:"List items in a PhotoStructure Library.",logcat:"Chronologically sort and pretty-print PhotoStructure's log files.",logtail:"View the log messages of currently-running PhotoStructure processes as they are emitted. (Like `tail -f`).",web:"PhotoStructure's web service. Automatically started by main. For more details see https://photostructure.com/tools",sync:"PhotoStructure's directory synchronization service. Automatically started by main, but can be run manually. For more details see https://photostructure.com/go/sync",test:"Test harness. For internal use.",worker:"PhotoStructure's worker process. For internal use."}},41801(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.isIterable=i,e.isIterator=u,e.isAsyncIterable=s,e.isIterableLike=function(t){return i(t)||u(t)||s(t)},e.sliceIterable=function(t,e,n){if((0,o.lt0)(e))return[...t].slice(e,n);const r=t[Symbol.iterator]();if((0,o.gt0)(e))for(let t=0;t<e;t++)r.next();const i=[];for(let t=e;!(0,o.gte0)(n)||t<n;t++){const t=r.next();if(null==t.value&&!0===t.done||i.push(t.value),!0===t.done)break}return(0,o.lt0)(n)?i.slice(0,n):i},e.countIterable=function(t){let e=0;const n=t[Symbol.iterator]();for(;!0!==n.next().done;)e++;return e},e.max=function(t,e){let n,r;for(const o of t){const t=e(o);(null==r||r<t)&&(r=t,n=o)}return n},e.iterate=l,e.chainAsyncIterators=a,e.iterToA=async function(...t){const e=[];for await(const n of a(...t))null!=n&&e.push(n);return e},e.iterateQuietly=function*(t,e){for(;;)try{const{value:e,done:n}=t.next();if(!0===n)break;yield e}catch(t){e?.(t)}},e.iterateQuietlyAsync=async function*(t,e){for(;;)try{const{value:e,done:n}=await t.next();if(!0===n)break;yield e}catch(t){e?.(t)}};const r=n(32639),o=n(31586);function i(t){return null!=t&&"string"!=typeof t&&"function"==typeof t[Symbol.iterator]}function u(t){return null!=t&&"string"!=typeof t&&"function"==typeof t.next}function s(t){return null!=t&&"string"!=typeof t&&"function"==typeof t[Symbol.asyncIterator]}async function*l(t){if(null==t)return;if(null==(t=await t))return;const e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():Symbol.iterator in t?t[Symbol.iterator]():t;let n;do{n=await e.next();const t=await n.value;null!=t&&!0!==n.done&&(yield t)}while(!0!==n?.done)}async function*a(...t){for(const e of t){if(null==e)continue;const t=await e;if(null==t)continue;const n=await((0,r.isFunction)(t)?t():t);yield*l(n)}}},42279(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.NoOp=void 0,e.tot=function(t){return(0,r.isFunction)(t)?t():t},e.tol=async function(t){return(0,r.isFunction)(t)?t():t},e.firstDefinedThunk=function(t){for(const e of t){const t=e();if(null!=t)return t}},e.firstDefinedSuccess=function(t){for(const e of t)try{const t=e();if(null!=t)return t}catch{}};const r=n(32639);e.NoOp=()=>{}},42659(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.yearMs=e.monthMs=e.weekMs=e.dayMs=e.hourMs=e.minuteMs=e.secondMs=void 0,e.toDate=p,e.fmtDateShort=g,e.splitHMS=function(t){return(0,u.mapOr)(/^[0:]{1,4}/.exec(t),e=>[e[0],t.slice(e[0].length)],()=>["",t])},e.isDate=m,e.thisYear=function(){return(new Date).getFullYear()},e.ago=h,e.hence=function(t,e){return h(-t,e)},e.unixtime=function(t){const n=m(t)?t.getTime():(0,s.isNumber)(t)?t:Date.now();return Math.floor(n/e.secondMs)},e.fmtYMDHMS=function(t){return y(t).join("")},e.fmtIsoDateTime=function(t){const[e,n,r,o,i,u]=y(t);return`${e}-${n}-${r}T${o}:${i}:${u}`},e.fmtHMS=function(t,n={includeMs:!0}){const r=Math.floor(t/e.hourMs);t-=r*e.hourMs;const o=Math.floor(t/e.minuteMs);t-=o*e.minuteMs;const i=Math.floor(t/e.secondMs),u=Math.floor(t-i*e.secondMs);return(0,l.pad2)(r)+":"+(0,l.pad2)(o)+":"+(0,l.pad2)(i)+(n.includeMs?"."+(0,l.pad3)(u):"")},e.fmtIsoDuration=function(t){if(0===t)return"PT0S";const n=[],o=[];for(const r of v.slice(v.findIndex(e=>e.ms<=t))){const i=Math.floor(t/r.ms);t-=i*r.ms,i>0&&(r.ms>=e.dayMs?n:o).push(i+r.s)}return t>0&&o.push((0,s.toFixedStr)(t/e.secondMs,3)+"S"),"P"+n.join("")+((0,r.isEmpty)(o)?"":"T"+o.join(""))},e.fmtIsoDate=function(t){const e=m(t)?t:new Date(t);return e.getFullYear()+"-"+(0,l.pad2)(e.getMonth()+1)+"-"+(0,l.pad2)(e.getDate())},e.localToDate=S,e.fmtLocalToShort=function(t){return(0,u.map)(S(t),g)},e.nextMidnightTs=b,e.msUntilMidnight=function(){return b()-Date.now()},e.fmtAgo=function(t,e="ago"){return E(Date.now()-t,e)},e.fmtElapsedMs=E,e.floorTimeToSecond=function(t){const e=(0,s.isNumber)(t)?t:m(t)?t.getTime():void 0;return void 0===e?void 0:1e3*Math.floor(e/1e3)};const r=n(40958),o=n(22573),i=n(45599),u=n(55835),s=n(31586),l=n(39926),a=n(51926),c=n(12168);e.secondMs=1e3,e.minuteMs=60*e.secondMs,e.hourMs=60*e.minuteMs,e.dayMs=24*e.hourMs,e.weekMs=7*e.dayMs,e.monthMs=32*e.dayMs,e.yearMs=365.25*e.dayMs;const f=(0,i.defer)(()=>new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),d=(0,i.defer)(()=>new Intl.DateTimeFormat(void 0,{day:"numeric",year:"numeric",month:"short"}));function p(t){return t instanceof Date?t:new Date(t)}function g(t){if(null!=t)return t instanceof Date&&0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()?d().format(t):f().format(t)}function m(t){return t instanceof Date&&!isNaN(t.getTime())}function h(t,e){return new Date((e?.getTime()??Date.now())-t)}function y(t){const e=p(t);return[String(e.getFullYear()),(0,l.pad2)(e.getMonth()+1),(0,l.pad2)(e.getDate()),(0,l.pad2)(e.getHours()),(0,l.pad2)(e.getMinutes()),(0,l.pad2)(e.getSeconds())]}const v=[{ms:e.yearMs,s:"Y"},{ms:e.weekMs,s:"W"},{ms:e.dayMs,s:"D"},{ms:e.hourMs,s:"H"},{ms:e.minuteMs,s:"M"}];function S(t){if(null==t||t<0)return;let e=t;const n=()=>{const t=e%100;return e=Math.floor(e/100),t},r=10*n(),o=n(),i=n(),u=n(),s=n(),l=n();return new Date(e,l-1,s,u,i,o,r)}function b(){return(new Date).setHours(24,0,0,0)}function E(t,n="ago"){return t<1e3?"just now":(n=(0,o.blank)(n)?"":(0,a.ensurePrefix)(n," "),t<e.minuteMs?(0,c.plur)(Math.floor(t/e.secondMs),"second")+n:t<e.hourMs?(0,c.plur)(Math.floor(t/e.minuteMs),"minute")+n:t<e.dayMs?(0,c.plur)(Math.floor(t/e.hourMs),"hour")+n:t<e.weekMs?(0,c.plur)(Math.floor(t/e.dayMs),"day")+n:t<e.yearMs?(0,c.plur)(Math.floor(t/e.weekMs),"week")+n:(0,c.plur)(Math.floor(t/e.yearMs),"year")+n)}},43334(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.platformArch=e.platformName=e.isElectron=e.isMainElectron=e.isCaseSensitiveFs=e.isPosix=e.isLinux_arm=e.isArm=e.isLinux_x64=e.isLinux=e.isMac=e.isWinPortable=e.isWin=e.isCI=e.inspectFlag=void 0;const o=r(n(48161)),i=r(n(1708)),u=n(22573),s=n(38639),l=n(59958),a=o.default.platform();e.inspectFlag=i.default.argv.includes("--inspect")||(0,s.isTrue)(i.default.env.NODE_INSPECT),e.isCI=(0,s.isTrue)(i.default.env.CI),e.isWin="win32"===a||"cygwin"===a,e.isWinPortable=e.isWin&&(0,u.notBlank)(i.default.env.PORTABLE_EXECUTABLE_DIR),e.isMac="darwin"===a,e.isLinux="linux"===a,e.isLinux_x64=e.isLinux&&"x64"===o.default.arch(),e.isArm=null!=/^arm\b/i.exec(o.default.arch()),e.isLinux_arm=e.isLinux&&e.isArm,e.isPosix=e.isMac||e.isLinux,e.isCaseSensitiveFs=e.isLinux,e.isMainElectron=null!=i.default.versions.electron&&!(0,s.isTrue)(i.default.env[l.ELECTRON_RUN_AS_NODE]),e.isElectron=null!=i.default.versions.electron||(0,s.isTrue)(i.default.env[l.ELECTRON_RUN_AS_NODE])&&/electron/i.test(i.default.execPath),e.platformName=e.isWin?"win":e.isMac?"mac":e.isLinux?"linux":a,e.platformArch=e.platformName+"-"+o.default.arch()},45599(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.isDefer=function(t){return null!=t&&"function"==typeof t&&"DeferImpl"===t.name},e.defer=function(t){let e,n,o=!1;const i=function(){if(o){if(null!=n)throw n;return e}try{return o=!0,e=t()}catch(t){throw n=(0,r.toError)(t),n}};return i.prior=()=>e,i.hasPrior=()=>o,i.applied=()=>o,i.reset=()=>{const t=e;return e=void 0,n=void 0,o=!1,t},i};const r=n(70978)},45969(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.isDocker=void 0;const r=n(73024),o=n(38639),i=n(19851),u=n(59958),s=n(43334);e.isDocker=(0,i.lazy)(()=>s.isLinux&&((0,o.toBoolean)(process.env[u.PS_IS_DOCKER])??(0,r.existsSync)("/.running-in-container")))},46891(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.pluralize=function(t){if((0,r.blank)(t))return t;const e=o.get(t);return null!=e?e:null!=t.match(i)?t+"es":null!=t.match(u)?t.replace(/y$/i,"ies"):null!=t.match(s)?t+"s":t.endsWith("o")?t+"es":null!=t.match(l)?t.replace(l,"es"):t+"s"};const r=n(22573),o=new Map([["child","children"],["photo","photos"],["video","videos"]]),i=/([sxz]|ss|sh|ch)$/,u=/[^aeiou]y$/,s=/[aeiou]y$/,l=/is$/},48161(t){t.exports=require("node:os")},48884(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.remove=e.flatMap=e.diff=void 0,e.diffEql=function(t,e){return t.filter(t=>!e.some(e=>(0,s.eql)(t,e)))},e.allDefined=h,e.mapAllDefined=function(t,e){return h(t)?e(t):void 0},e.mapAll=function(t,e){return h(t)?e(t):void 0},e.allNotDefined=function(t){return null==t||t.every(t=>null==t)},e.allNotBlank=function(...t){return null!=t&&t.every(u.notBlank)},e.anyNotDefined=function(t){return null==t||t.some(t=>null==t)},e.anyDefined=function(t){return null!=t&&t.some(t=>null!=t)},e.findAsync=async function(t,e){for(const n of(0,p.toA)(t))if(null!=n&&!0===await e(n))return n},e.findLastAsync=async function(t,e){for(let n=(t=(0,p.toA)(t)).length-1;n>=0;n--){const r=t[n];if(null!=r&&!0===await e(r))return r}},e.first=function(t,e){if(null!=t)for(const n of(0,p.toA)(t))if(null!=n){const t=e(n);if(null!=t)return t}},e.firstAsync=async function(t,e){if(null!=t){let n=-1;for(const r of t){n++;try{if(null!=r){const t=await e(r,n);if(null!=t)return t}}catch(t){}}}},e.firstNonEmptyThunk=function(...t){for(const e of t){const t=e();if((0,r.isNotEmpty)(t))return t}},e.findFromIndex=function(t,e,n){for(let r=n;r<=t.length-1;r++)if(e(t[r]))return r},e.findLast=function(t,e){for(let n=t.length-1;n>=0;n--)if(e(t[n]))return t[n]},e.findLastIndex=function(t,e){for(let n=t.length-1;n>=0;n--)if(e(t[n]))return n;return-1},e.concat=function(...t){const e=[];for(const n of t)if(Array.isArray(n))for(const t of n)null!=t&&e.push(t);else null!=n&&e.push(n);return e},e.moveToEnd=function(t,e){return(0,r.remove)(t,e),t.push(e),t},e.moveIndexToEnd=function(t,e){const n=t[e];if(null==n)return t;t.push(n);for(let n=e;n<t.length-1;n++)t[n]=t[n+1];return t.length=t.length-1,t},e.intersection=y,e.diceCoeff=function(t,e,n=r.primitiveValueOfOrElse){return(0,r.isEmpty)(t)&&(0,r.isEmpty)(e)?1:2*y(t,e,n).length/(t.length+e.length)},e.eqlUnordered=function(t,e){return null!=t&&null!=e&&S((0,i.sortBy)(t,g.stringifySorted),(0,i.sortBy)(e,g.stringifySorted)).every(([t,e])=>(0,s.eql)(t,e))},e.removeFirst=function(t,e){const n=t.findIndex(e);return n>=0?t.splice(n,1)[0]:void 0},e.uniqInPlace=function(t,e=t=>(0,l.stringify)(t)){(0,o.copyArrayTo)((0,r.uniqBy)(t,e),t)},e.partition=function(t,e){const n=[],r=[];let o=0;for(const i of t)(e(i,o++)?n:r).push(i);return[n,r]},e.isUniq=function(t){return t.every((e,n)=>t.indexOf(e)===n)},e.uniqCount=function(t){return v(t.sort())},e.mapCompact=function(t,e){return(0,r.compact)((0,r.compact)(t).map(e))},e.compactRight=function(t){for(let e=t.length-1;e>=0&&null==t[e];e--)t.splice(e,1);return t},e.toMapEntries=function(t,e){return new Map(t.map(e).filter(a.defined))},e.retainLastN=function(t,e){return t.length>e&&t.splice(0,t.length-e),t},e.retainFirstN=function(t,e){return t.length=Math.min(t.length,e),t},e.zip=S,e.flatZip=function(...t){const e=Math.max(...t.map(t=>t?.length??0)),n=[];return(0,c.times)(e,e=>t.map(t=>n.push(t?.[e]))),n},e.deinterleave=function(t,e=3){if(t.length%e!==0)throw new Error("Buffer length must be a multiple of "+e);const n=Math.floor(t.length/e),r=Array.from({length:e},()=>new Array(n));for(let o=0,i=0;o<n;o++,i+=e)for(let n=0;n<e;n++)r[n][o]=t[i+n];return r},e.ancestry=function(t){return(0,c.times)(t.length,e=>t.slice(0,e+1))},e.min=function(t){return t[b(t)]},e.leastIndex=b,e.max=function(t){return t[E(t)]},e.greatestIndex=E,e.leastIndexBy=_,e.greatestIndexBy=M,e.leastBy=O,e.least=function(t){return O(t,t=>t)},e.greatestBy=function(t,e){return(0,r.isEmpty)(t)?void 0:t[M(t,e)]},e.leastByCtx=function(t,e){const n=x(t??[],e,d.lt);return null==t||null==n||n.index<0||null==n.value?void 0:{result:t[n.index],index:n.index,value:n.value}},e.reverse=function(t){const e=[];for(let n=t.length-1;n>=0;n--)e.push(t[n]);return e},e.reverseG=function*(t){for(let e=t.length-1;e>=0;e--)yield t[e]},e.batches=I,e.collectBatched=function(t,e,n){const o=[];for(const i of I((0,r.compact)((0,p.toA)(t)),e))o.push(...(0,r.compact)(n(i)));return o},e.collectBatchedAsync=async function(t,e,n){const o=[];for(const i of I((0,r.compact)((0,p.toA)(t)),e))o.push(...(0,r.compact)(await n(i)));return o},e.contextFilter=function(t,e){let n;return t.filter((t,r)=>(0,f.tap)(e(t,r,n),e=>{e&&(n=t)}))},e.clusterSome=function(t,e){const n=[];for(const r of t){const t=n.find(t=>t.some(t=>e(r,t)));t?t.push(r):n.push([r])}return n},e.clusterEvery=function(t,e){const n=[];for(const r of t){const t=n.find(t=>t.every(t=>e(r,t)));t?t.push(r):n.push([r])}return n},e.clusterAsync=async function(t,e){const n=[];t:for(const r of t){for(const t of n)if(null!=r&&await w(t,t=>e(r,t))){t.push(r);continue t}null!=r&&n.push([r])}return n},e.everyAsync=w,e.leftPadArray=function(t,e,n){if(t.length<e){const r=new Array(e-t.length).fill(n);t.unshift(...r)}return t},e.rightPadArray=function(t,e,n){if(t.length<e){const r=new Array(e-t.length).fill(n);t.push(...r)}return t};const r=n(40958),o=n(36783),i=n(76790),u=n(22573),s=n(50357),l=n(98553),a=n(55835),c=n(31586),f=n(68708),d=n(34666),p=n(59455),g=n(84885);var m=n(40958);function h(t){return(0,a.defined)(t)&&t.every(a.defined)}function y(t,e,n=r.primitiveValueOfOrElse){const o=new Set(e.map(n));return t.filter(t=>o.has(n(t)))}function v(t){if(null==t||0===t.length)return[];const e=t[0],n=t.lastIndexOf(e);return[{t:e,count:n+1},...v(t.slice(n+1))]}function S(...t){const e=[],n=Math.max(...t.map(t=>t?.length??0));for(let r=0;r<n;r++)e.push(t.map(t=>t?.[r]));return e}function b(t){return _(t,t=>t.valueOf())}function E(t){return M(t,t=>t.valueOf())}function _(t,e){return P(t,e,(t,e)=>(0,d.lt)(t,e))}function M(t,e){return P(t,e,(t,e)=>(0,d.gt)(t,e))}function O(t,e){return(0,r.isEmpty)(t)?void 0:t[_(t,e)]}function P(t,e,n){return x(t,e,n).index}function x(t,e,n){if((0,r.isEmpty)(t))return{index:-1,value:void 0};let o,i=-1;for(let r=0;r<t.length;r++){const u=t[r];if(null!=u){const t=e(u);null!=t&&(null!=o&&!0!==n(t,o)||(i=r,o=t))}}return{index:i,value:o}}function I(t,e){return e<1&&(e=1),(0,r.stepRange)(0,t.length,Math.round(e),n=>t.slice(n,n+e))}async function w(t,e){return(0,r.isEmpty)(t)||(await Promise.all(t.map(e))).every(t=>t)}Object.defineProperty(e,"diff",{enumerable:!0,get:function(){return m.diff}}),Object.defineProperty(e,"flatMap",{enumerable:!0,get:function(){return m.flatMap}}),Object.defineProperty(e,"remove",{enumerable:!0,get:function(){return m.remove}})},49769(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getOrSet=function(t,e,n){if(null==e)throw new Error("null key");if(t.has(e))return t.get(e);{const r=n();return null!=r&&t.set(e,r),r}},e.getOrMaybeSet=function(t,e,n){if(null==e)throw new Error("null key");if(t.has(e))return t.get(e);{const r=n();return null!=r&&t.set(e,r),r}},e.deleteIf=function(t,e){for(const[n,r]of t.entries())e(n,r)&&t.delete(n)}},50357(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.eql=l,e.findEql=function(t,e){for(const n of t)if(l(e,n))return n},e.eqlSubset=function(t,e){if(null==t||null==e||(0,u.isPrimitive)(t)||(0,u.isPrimitive)(e))return t===e;if(!(0,i.isObject)(t)||!(0,i.isObject)(e))return!1;for(const n of(0,i.keys)(t))if(!l(t[n],e[n]))return!1;return!0},e.dateComparator=a,e.objComparator=c,e.functionComparator=f,e.weakRefComparator=d,e.pushObjComparator=function(t){p.push(t)},e.unshiftObjComparator=function(t){p.unshift(t)},e.setFieldComparator=function(t,e){g.set(t,e)},e.whyNotEql=function(t,e,n=25){const r=[];return function t(e,o,i=""){if(r.length>=n)return;if(e===o)return;if(typeof e!=typeof o)return void r.push({path:i,a:e,b:o});if("object"!=typeof e||null===e||null===o)return void r.push({path:i,a:e,b:o});if(Array.isArray(e)!==Array.isArray(o))return void r.push({path:i,a:e,b:o});if(Array.isArray(e)){const n=Math.max(e.length,o.length);for(let r=0;r<n;r++)t(e[r],o[r],`${i}[${r}]`);return}const u=Object.keys(e),s=Object.keys(o);for(const n of new Set([...u,...s]))t(e[n],o[n],i?`${i}.${n}`:n)}(t,e),r.length>0?r:void 0};const r=n(38639),o=n(12487),i=n(68708),u=n(34666),s=n(32639);function l(t,e){return(0,o.deepEql)(t,e,{comparator:m})}function a(t,e){if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime()}function c(t,e){if((0,i.isObject)(t)&&(0,s.isFunction)(t.$eql)){const n=t.$eql(e);if((0,r.isBoolean)(n))return n}if((0,i.isObject)(e)&&(0,s.isFunction)(e.$eql)){const n=e.$eql(t);if((0,r.isBoolean)(n))return n}}function f(t,e){return(0,s.isFunction)(t)&&(0,s.isFunction)(e)?t.toString()===e.toString():void 0}function d(t,e){return(0,i.isObject)(t)&&(0,i.isObject)(e)&&"WeakRef"===t.constructor?.name&&"WeakRef"===e.constructor?.name?t.deref()===e.deref():void 0}const p=[c,a,f,d],g=new Map;function m(t,e,n){if(null==t||null==e)return t===e;if(null!=n){const r=g.get(n)?.(t,e);if(null!=r)return r}for(const n of p){const r=n(t,e);if(null!=r)return r}return null}},50989(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.strEnum=function t(...e){const n=Object.freeze(e),o=new Map(n.map(t=>[t.toLowerCase(),t])),i=(0,r.fromEntries)(n.map((t,e)=>[t,e])),u={};for(const t of n)u[t]=t;const s=t=>null==t?void 0:o.get(t?.toLowerCase()),l=t=>null!=t?i[t]:void 0,a=t=>null!=l(t),c=t=>null==t?void 0:a(t)?t:s(t);return{...u,values:n,length:n.length,has:a,includes:a,getCI:s,pick:(...t)=>n.filter(e=>t.includes(e)),omit:(...t)=>n.filter(e=>!t.includes(e)),indexOf:l,ordinal:t=>l(t)??n.length,toValid:c,firstValid:(...t)=>{for(const e of t){const t=c(e);if(null!=t)return t}},mapValid:(t,e)=>a(t)?e(t):void 0,cmp:(t,e)=>{const n=l(t),r=l(e);return null==n||null==r?void 0:n>r?1:n<r?-1:0},lt:(t,e)=>l(t)<l(e),next:t=>{const e=l(t);return null==e?void 0:n[e]},toReversed:()=>t(...[...n].reverse()),[Symbol.iterator]:()=>n[Symbol.iterator]()}};const r=n(68708)},51926(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.isString=f,e.isBuffer=function(t){return"Buffer"===t?.constructor?.name},e.isBMP=d,e.charAt=function(t,e){if(d(t)){if((e=Math.trunc(e)||0)<0&&(e+=t.length),e<0||e>=t.length)return;return t[e]}return(0,o.at)([...(0,c.toS)(t)],e)},e.strlen=function(t){const e=g();return null!=e?(0,s.countIterable)(e.segment(t)):d(t)?t.length:[...t].length},e.strslice=m,e.substr=function(t,e,n){return d(t)?t.slice(e,null==n?void 0:e+n):m(t,e,null==n?void 0:e+n)},e.charArr=h,e.trimRight=function(t){return(0,c.toS)(t).replace(/\s+$/,"")},e.stripPrefix=y,e.stripPrefixes=function t(e,n){if(null==e)return"";const r=(0,c.toS)(e);for(const e of n)if(null!=e&&e.length>0&&r.startsWith(e))return t(r.slice(e.length),n);return r},e.stripSuffix=v,e.stripPrefixSuffix=function(t,{prefix:e,suffix:n}){return v(y(t,e),n)},e.ensurePrefix=S,e.ensureSuffix=b,e.ensurePrefixSuffix=function(t,{prefix:e,suffix:n}){return b(S(t,e),n)},e.ellipsize=function(t,e=80,n=0){if(null==t)return"";e=Math.max(1,(0,l.round)(e)),n=(0,l.clamp)(0,e-1,(0,l.round)(n));const r=h(t);return r.length<=e?r.join(""):r.slice(0,e-1-n).join("")+"…"+(n>0?r.slice(-n).join(""):"")},e.newlineRe=function(){return/\r?\n/g},e.trimLastNewline=function(t){return(0,c.toS)(t).replace(/\r?\n$/,"")},e.leftIndexOf=E,e.wrap=function t(e,n){const r=n?.maxLineLen??80,o=n?.prefix??"";if(Array.isArray(e)||e.includes("\n")){const r=(0,u.flatten)((0,a.toA)(e).map(t=>(0,c.toS)(t).split(/\r?\n/g)));return(0,u.flatten)(r.map(e=>t(e,n)))}if((e=S((0,c.toS)(e),o).trim()).length<=r)return[e];const i=E(e," ",r);if(i>o.length)return[m(e,0,i),...t(m(e,i+1),n)];{const r=e.indexOf(" ",o.length+1);return r>0&&r<e.length-1?[m(e,0,r),...t(m(e,r+1),n)]:[e]}},e.eqlStrings=function(t,e){return f(t)&&f(e)?t===e||t.normalize()===e.normalize():void 0},e.replaceAll=function(t,e,n){return""===e?t:t.split(e).join(n)},e.compressWhitespace=function(...t){return t.join(" ").replace(/\s+/g," ").trim()},e.splitLast=function(t,e){const n=(t=(0,c.toS)(t)).lastIndexOf(e);return-1===n?t:t.slice(n+e.length)},e.equalsIgnoreCase=_,e.firstIgnoreCase=M,e.includesIgnoreCase=function(t,e){return null!=M(t,e)};const r=n(40958),o=n(17586),i=n(22573),u=n(96249),s=n(41801),l=n(31586),a=n(59455),c=n(54993);function f(t){return"string"==typeof t}function d(t){for(let e=t.length-1;e>=0;e--)if(t.charCodeAt(e)!==t.codePointAt(e))return!1;return!0}let p;function g(){if(void 0===p)try{p=new Intl.Segmenter(void 0,{granularity:"grapheme"})}catch{p=null}return p??null}function m(t,e,n){if(d(t))return e<0&&(e+=t.length),t.slice(e,n);{const r=g();return null!=r?(0,s.sliceIterable)(r.segment(t),e,n).map(t=>t.segment).join(""):[...(0,c.toS)(t)].slice(e,n).join("")}}function h(t){const e=g();return null==e?[...(0,c.toS)(t)]:[...e.segment(t)].map(t=>t.segment)}function y(t,e){const n=(0,c.toS)(t),r=(0,c.toS)(e);return r.length>0&&n.startsWith(r)?n.slice(r.length):n}function v(t,e){if(null==e)return t;const n=(0,c.toS)(t),r=(0,c.toS)(e);return r.length>0&&n.endsWith(r)?n.slice(0,-r.length):n}function S(t,e){return null==e||""===e?t:(t=(0,c.toS)(t),e=(0,c.toS)(e),t.startsWith(e)?t:e+t)}function b(t,e){return null==e||""===e?t:(t=(0,c.toS)(t),e=(0,c.toS)(e),t.endsWith(e)?t:t+e)}function E(t,e,n){null==n&&(n=t.length);for(let r=n;r>=0;r--)if(m(t,r).startsWith(e))return r;return-1}function _(t,e,{normalize:n=!0}={}){if(null==t||null==e)return!1;const r=(0,c.toS)(t),o=(0,c.toS)(e);return r.length===o.length&&(r===o||r.toLowerCase()===o.toLowerCase()||"function"==typeof r.localeCompare&&0===(n?r.normalize():r).localeCompare(n?o.normalize():o,void 0,{sensitivity:n?"base":"accent"}))}function M(t,e){return(0,r.isEmpty)(t)||(0,i.blank)(e)?void 0:t.find(t=>_(e,t))}},54993(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.toS=function(t){return i(t,",")},e.toStr=i;const r=n(98553),o={}.toString;function i(t,e=","){if(null==t)return"";switch(typeof t){case"string":return t;case"boolean":case"number":case"bigint":case"symbol":return String(t);default:return Array.isArray(t)?t.map(t=>i(t,e)).join(e):t.toString!==o?t.toString():(0,r.stringify)(t)}}},55835(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.map=i,e.mapTry=function(t,e){try{return i(t(),e)}catch{return}},e.map2=u,e.map3=function(t,e,n,r){return null==t||null==e||null==n?void 0:r(t,e,n)},e.orElse=s,e.mapOr=function(t,e,n){return null!=t?e(t):(0,r.tot)(n)},e.map2Or=function(t,e,n,r){return s(u(t,e,n),r)},e.defined=l,e.ifDefined=function(t,e){return void 0===t?void 0:e(t)},e.allDefined=function(t){return null!=t&&t.every(l)},e.firstDefined=function(...t){return t.find(l)},e.denull=function(t){return null==t||"null"===(0,o.toS)(t)?void 0:t},e.nulled=function(t){return null==t?null:t};const r=n(42279),o=n(54993);function i(t,e){return null==t?void 0:e(t)}function u(t,e,n){return null==t||null==e?void 0:n(t,e)}function s(t,e){return null!=t?t:(0,r.tot)(e)}function l(t){return null!=t}},57975(t){t.exports=require("node:util")},59455(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.toA=function(t){return i(t)??[]},e.optToA=i;const r=n(41801),o=n(51926);function i(t){return Array.isArray(t)?t:null==t?void 0:(0,o.isString)(t)?[t]:(0,r.isIterable)(t)?Array.from(t):[t]}},59958(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.IgnorableEnvKeys=e.DevEnvKeys=e.DevEnvFlags=e.PS_BAIL_AFTER_TASK_COUNT=e.PS_EXPECT_TEST_ERRORS=e.PS_SYNC_REPORT_STDOUT=e.PS_FORCE_FIX_JSON=e.PS_FIX_JSON=e.UV_THREADPOOL_SIZE=e.ELECTRON_RUN_AS_NODE=e.PS_IS_DOCKER=e.PS_IS_CHILD_PROCESS=void 0;const r=n(50989);e.PS_IS_CHILD_PROCESS="PS_IS_CHILD_PROCESS",e.PS_IS_DOCKER="PS_IS_DOCKER",e.ELECTRON_RUN_AS_NODE="ELECTRON_RUN_AS_NODE",e.UV_THREADPOOL_SIZE="UV_THREADPOOL_SIZE",e.PS_FIX_JSON="PS_FIX_JSON",e.PS_FORCE_FIX_JSON="PS_FORCE_FIX_JSON",e.PS_SYNC_REPORT_STDOUT="PS_SYNC_REPORT_STDOUT",e.PS_EXPECT_TEST_ERRORS="PS_EXPECT_TEST_ERRORS",e.PS_BAIL_AFTER_TASK_COUNT="PS_BAIL_AFTER_TASK_COUNT",e.DevEnvFlags=(0,r.strEnum)("PS_BAIL_ON_ERROR",e.PS_EXPECT_TEST_ERRORS,"PS_FAIL_DB_HEALTH_CHECK","PS_FAIL_SECURITY_HEALTH_CHECK","PS_FAIL_VOLUMES","PS_FORCE_FULLDISK","PS_FORCE_LITE","PS_FORCE_TRIAL","PS_KEEP_ENV","PS_LOG_SQL","PS_NO_RANDOM_IMAGE_CACHE","PS_PRIVATE_KEYS","PS_QUICK","PS_SINGLE_SPEC_TESTS","PS_SKIP_ALL_TESTS","PS_SKIP_CLEANUP","PS_SKIP_RUN","PS_SLOMO","PS_TEST_HEALTH_CHECK_LEVEL",e.PS_FIX_JSON,e.PS_FORCE_FIX_JSON,e.PS_SYNC_REPORT_STDOUT,e.PS_BAIL_AFTER_TASK_COUNT,"SETTINGS_IO_TEST"),e.DevEnvKeys=["PS_NO_PUID_CHOWN","PS_TEST_VOLUME_UUIDS"],e.IgnorableEnvKeys=["PS_CONFIG_DIR",e.PS_IS_DOCKER,e.PS_IS_CHILD_PROCESS,...e.DevEnvKeys,...e.DevEnvFlags.values]},62344(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ExtensibleFunction=void 0,e.ExtensibleFunction=class extends Function{_self;constructor(){super("...args","return this._self._call(...args)");const t=this.bind(this);return this._self=t,t}}},65812(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.setUnrefTimeout=function(t,e){const n=setTimeout(t,e);return(0,r.maybeCall)(n,"unref")??n};const r=n(68708)},68708(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.isObject=f,e.isRecord=d,e.tap=function(t,e){return null!=e?e(t):"string"==typeof t?console.log(t):console.dir(t,{depth:null}),t},e.keys=p,e.keysWithDefinedOrNullValues=function(t){return null==t?[]:p(t).filter(e=>void 0!==t[e])},e.propertyNames=function*(t){if(null!=t)for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(yield e)},e.isEmptyObj=g,e.notEmptyObj=m,e.toCompactObj=function(t){const e=S(t);return g(e)?void 0:e},e.mapCompactObj=function(t,e){const n=S(t);return m(n)?e(n):void 0},e.values=h,e.entries=y,e.fromEntries=v,e.assignFields=function(t,e,n){const r=n?.assignNullish??!1;if(!f(e))return t;if(!0===n?.deleteExtraFields&&d(t))for(const n of Object.keys(t))n in e&&(r||null!=e[n])||delete t[n];for(const[o,i]of y(e))!0!==n?.omitKeys?.includes(o)&&(null!=i||r)&&(t[o]=i);return t},e.assignUndefinedFields=function(t,e,...n){if(null==e)return t;for(const r of n){const n=e[r];void 0!==n&&void 0===t[r]&&(t[r]=n)}return t},e.assignAllFields=function(t,e){for(const[n,r]of y(e??{}))t[n]=r;return t},e.definedValues=function(t){if(null==t)return;const e=y(t);if(e.every(([,t])=>void 0!==t))return t;const n=e.filter(([,t])=>void 0!==t);return(0,r.isEmpty)(n)?void 0:v(n)},e.compactValues=S,e.compactValuesDeep=function t(e){if(null!=e){if((0,a.isPrimitive)(e))return e;if(Array.isArray(e))return(0,r.compact)(e.map(t));{const n=(0,r.compact)(y(e).map(([e,n])=>(0,s.map)(t(n),t=>[e,t])));return 0===n.length?void 0:v(n)}}},e.compactBlankValues=function(t){if(null==t)return;const e=y(t).filter(([t,e])=>null!=t&&(0,i.notBlank)(e));return(0,r.isEmpty)(e)?void 0:v(e)},e.mapFields=b,e.mergeObjectsDeep=E,e.pick=function(t,...e){if(!f(t))return t;const n={};for(const r of e)void 0!==t[r]&&(n[r]=t[r]);return n},e.pickRequired=function(t,...e){if(!f(t))return;const n={};for(const r of e){if(null==t[r])return;n[r]=t[r]}return n},e.pickCompact=function(t,...e){if(!f(t))return;const n={};for(const r of e)void 0!==t[r]&&(n[r]=t[r]);return n},e.pickNonBlank=function(t,...e){if(!f(t))return t;const n={};for(const r of e){const e=t[r];(0,i.notBlank)(e)&&(n[r]=e)}return n},e.pickFirst=function(t,e,n=s.defined){if(f(t))for(const r of e)if(n(t[r]))return t[r]},e.pickDeep=function t(e,...n){if(!f(e))return e;if(Array.isArray(e))return e.map(e=>t(e,...n));const r={};function o(t,e){if(null==e)return;const n=r[t];r[t]=null==n?e:E(n,e)}for(const r of n){const[n,u]=(0,c.splitFirst)(r,".");if(n.includes("*")){const r=n.replace(/[.+?^${}()|[\]\\]/g,"\\$&"),s=new RegExp("^"+r.replace(/\*/g,".*")+"$","i");for(const n of p(e))if(s.test(n)){const r=e[n];null!=r&&o(n,(0,i.blank)(u)?r:t(r,u))}}else{const r=_(e,n);null!=r?.value&&o(r.key,(0,i.blank)(u)?r.value:t(r.value,u))}}for(const r of p(e))((0,l.toInt)(r)??-1)>=0&&o(r,t(e[r],...n));return r},e.pluck=_,e.pluckDeep=function t(e,n){if(null==e||(0,i.blank)(n))return;if(Array.isArray(e)){const o=(0,r.compact)(e.map(e=>t(e,n)));return(0,r.isEmpty)(o)?void 0:{key:o[0].key,value:(0,r.flatMap)(o,t=>t.value)}}const[o,u]=(0,c.splitFirst)(n,"."),s=_(e,o);if(null==s)return;if((0,i.blank)(u))return s;const l=t(s.value,u);return null==l?void 0:{key:s.key+"."+l.key,value:l.value}},e.omit=function(t,...e){return null==t?t:v(y(t).filter(([t])=>!e.includes(t)))},e.omitDeep=function t(e,n){if(null==e)return e;if(Array.isArray(e))return e.map(e=>t(e,n));if("object"==typeof e){const r={};for(const[o,i]of Object.entries(e))n.test(o)||(r[o]=t(i,n));return r}return e},e.isReqValued=M,e.allKeysDefined=function(t,...e){return null!=t&&e.every(e=>null!=t[e])},e.toReqValued=function(t){return M(t)?t:void 0},e.reqValuedOrElse=function(t){return M(t)?t:void 0},e.mapReqValued=function(t,e){return M(t)?e(t):void 0},e.onlyReqValued=function(t){return t.filter(M)},e.filter=function(t,e){return null==t?t:v(y(t).filter(([t,n])=>e(t,n)))},e.allKeys=function(t){const e=p(t);for(;null!=(t=Reflect.getPrototypeOf(t));)e.push(...Reflect.ownKeys(t).filter(t=>"string"==typeof t));return(0,r.uniq)(e)},e.maybeCall=function(t,e,...n){const r=t?.[e];return(0,u.isFunction)(r)?r.bind(t)(...n):void 0},e.firstValueCaseInsensitive=function(t,e){if((0,i.blank)(e))return;if(null!=t[e])return t[e];const n=e.toLowerCase().normalize();for(const e of p(t))if(n===e.toLowerCase().normalize()&&null!=t[e])return t[e]},e.flattenObject=function t(e){if(Array.isArray(e))return e.map(t);if("object"!=typeof e)return e;const n=b(e,(e,n)=>[e,t(n)]),r=h(n);return 1===r.length?r[0]:n};const r=n(40958),o=n(76790),i=n(22573),u=n(32639),s=n(55835),l=n(31586),a=n(34666),c=n(38453);function f(t){return null!=t&&"object"==typeof t}function d(t){return null!=t&&"object"==typeof t&&!Array.isArray(t)}function p(t){return f(t)?Object.keys(t).filter(e=>"string"==typeof e&&[void 0,!0].includes(t.propertyIsEnumerable?.(e))):[]}function g(t){if(null==t||"object"!=typeof t)return!0;for(const e in t)if(void 0!==t[e])return!1;return!0}function m(t){return!g(t)}function h(t){return p(t).map(e=>t[e])}function y(t){return null==t?[]:Object.entries?.(t)??p(t??{}).map(e=>[e,t[e]])}function v(t,e){if(null==t)return e;for(const n of t)if(null!=n&&Array.isArray(n)){const[t,r]=n;null!=t&&void 0!==r&&("object"!=typeof e&&(e={}),e[t]=r)}return e}function S(t){if(null==t)return;const e=y(t);if(e.every(([,t])=>null!=t))return t;const n=e.filter(([,t])=>null!=t);return(0,r.isEmpty)(n)?void 0:v(n)}function b(t,e,n={}){return v((0,r.compact)((0,o.sort)(p(t)).map(n=>e(n,t[n]))).filter(([t,e])=>null!=t&&void 0!==e),n)}function E(...t){const e=(0,r.compact)(t);if(0===e.length)return;if(1===e.length)return e[0];const n=e.filter(f);if(e.length!==n.length)return e;const o={};for(const t of(0,r.uniq)((0,r.flatMap)(n,p)))o[t]=E(...n.map(e=>e[t]));return o}function _(t,e){if(!f(t)||(0,i.blank)(e))return;if(e in t)return{key:e,value:t[e]};const n=new RegExp("^"+e.replace(/\*/g,".*")+"$","i");for(const e of p(t))if(n.test(e))return{key:e,value:t[e]}}function M(t){return h(t).every(t=>null!=t)}},68852(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.RegExpOptional=e.RegExpEscaped=e.NothingRegExp=void 0,e.captures=function(t,e){const n=[];if(!t.global)throw new Error("must provide global regex");let o;for(t.lastIndex=0;null!=(o=t.exec(e));)o.index===t.lastIndex?t.lastIndex++:n.push((0,r.pick)(o,"index","groups"));return n},e.escapeRegExp=u,e.matchQuotes=function(t){return t.replace(/[‘’']/g,"[‘’']").replace(/[“”„«»〃"]/g,'[“”„”«»〃"]')},e.orRegExpPatterns=function(t,n){const r=[];for(const e of t)try{r.push(e instanceof RegExp?e.source:new RegExp(e).source)}catch{r.push(u(e))}const o=0===r.length?e.NothingRegExp:r.map(t=>"(?:"+t+")").join("|");return new RegExp(o,n)},e.concatRegexp=a;const r=n(68708),o=n(54993);e.NothingRegExp=/$^/;const i=/[-.,\\^$*+?()|[\]{}]/g;function u(t){return t instanceof s?t.source:(0,o.toS)(t).replace(i,"\\$&")}class s{source;flags;constructor(t,e){this.source=t,this.flags=e}get global(){return this.flags?.includes("g")??!1}get ignoreCase(){return this.flags?.includes("m")??!1}get multiline(){return this.flags?.includes("i")??!1}}e.RegExpEscaped=s;class l extends s{static from(...t){const e=a(t);return new l("(?:"+e.source+")?",e.flags)}}function a(t,e){let n="",r=e?.includes("g")??!1,i=e?.includes("i")??!1,l=e?.includes("m")??!1;for(const e of t)e instanceof s||e instanceof RegExp?(n+=e.source,r||=e.global,i||=e.ignoreCase,l||=e.multiline):n+=u((0,o.toS)(e));return new RegExp(n,e??(r?"g":"")+(i?"i":"")+(l?"m":""))}e.RegExpOptional=l},70978(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.toError=function(t){return null==t?void 0:(0,r.isError)(t)?t:new Error(String(t))};const r=n(23541)},71696(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.typeDetect=function(t){const e=typeof t;if("object"!==e)return e;if(null===t)return"null";if(t===globalThis)return"global";if(Array.isArray(t)&&(!1===c||!(Symbol.toStringTag in t)))return"Array";if("object"==typeof window&&null!==window){if("object"==typeof window.location&&t===window.location)return"Location";if("object"==typeof window.document&&t===window.document)return"Document";if("object"==typeof window.navigator){if("object"==typeof window.navigator.mimeTypes&&t===window.navigator.mimeTypes)return"MimeTypeArray";if("object"==typeof window.navigator.plugins&&t===window.navigator.plugins)return"PluginArray"}if(("function"==typeof window.HTMLElement||"object"==typeof window.HTMLElement)&&t instanceof window.HTMLElement){if("BLOCKQUOTE"===t.tagName)return"HTMLQuoteElement";if("TD"===t.tagName)return"HTMLTableDataCellElement";if("TH"===t.tagName)return"HTMLTableHeaderCellElement"}}const r=c&&t[Symbol.toStringTag];if("string"==typeof r)return r;const a=Object.getPrototypeOf(t);return a===RegExp.prototype?"RegExp":a===Date.prototype?"Date":n&&a===Promise.prototype?"Promise":i&&a===Set.prototype?"Set":o&&a===Map.prototype?"Map":s&&a===WeakSet.prototype?"WeakSet":u&&a===WeakMap.prototype?"WeakMap":l&&a===DataView.prototype?"DataView":o&&a===g?"Map Iterator":i&&a===p?"Set Iterator":m&&a===h?"Array Iterator":y&&a===v?"String Iterator":null===a?"Object":Object.prototype.toString.call(t).slice(8,-1)};const n="function"==typeof Promise,r="undefined"!=typeof Symbol,o="undefined"!=typeof Map,i="undefined"!=typeof Set,u="undefined"!=typeof WeakMap,s="undefined"!=typeof WeakSet,l="undefined"!=typeof DataView,a=r&&void 0!==Symbol.iterator,c=r&&void 0!==Symbol.toStringTag,f=i&&"function"==typeof Set.prototype.entries,d=o&&"function"==typeof Map.prototype.entries,p=f&&Object.getPrototypeOf((new Set).entries()),g=d&&Object.getPrototypeOf((new Map).entries()),m=a&&"function"==typeof Array.prototype[Symbol.iterator],h=m&&Object.getPrototypeOf([][Symbol.iterator]()),y=a&&"function"==typeof String.prototype[Symbol.iterator],v=y&&Object.getPrototypeOf(""[Symbol.iterator]())},72993(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.AppNameVersion=e.AppName=e.SimpleAppNameLC=e.SimpleShortAppName=e.SimpleAppName=void 0;const r=n(19851),o=n(7282),i=n(37805);e.SimpleAppName="PhotoStructure",e.SimpleShortAppName="phstr",e.SimpleAppNameLC=e.SimpleAppName.toLowerCase(),e.AppName=(0,r.lazy)(()=>e.SimpleAppName+((0,o.isProd)()?"":`-${(0,o.nodeEnv)()}`)),e.AppNameVersion=(0,r.lazy)(()=>(0,e.AppName)()+" "+i.version)},73024(t){t.exports=require("node:fs")},76760(t){t.exports=require("node:path")},76790(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.sort=function(t){return f((0,r.compact)(t),r.toPrimitive)},e.sortByInPlace=f,e.sortUniqBy=d,e.sortUniq=function(t){return d(t,t=>t)},e.sortUniqByInPlace=function(t,e){return(0,o.copyArrayTo)(d(t,e),t)},e.isSorted=p,e.sortedBy=function(t,e){return t.every((n,r)=>0===r||e(n)>=e(t[r-1]))},e.sortBy=g,e.sortByCmp=function(t,e){return(0,r.compact)((0,c.toA)(t)).sort(e)},e.deepSortBy=function t(e,n){return g(e,n).map(e=>(0,i.isIterable)(e)?t(e,n):e)},e.pushSorted=function(t,e,n){const r=t.findIndex(t=>n(e)<n(t));return-1===r?t.push(e):t.splice(r,0,e),t};const r=n(40958),o=n(36783),i=n(41801),u=n(98553),s=n(49769),l=n(55835),a=n(34666),c=n(59455);function f(t,e){return p(t,e)?t:(0,o.copyArrayTo)(g(t,e),t)}function d(t,e){const n=new Map;for(const r of t)(0,s.getOrSet)(n,(0,u.stringify)(e(r)),()=>r);return g(n.values(),e)}function p(t,e=t=>t){if(t.length<=1)return!0;let n=e(t[0],0);for(let r=0;r<t.length;r++){const o=e(t[r],r);if(null==o||(0,a.gt)(n,o))return!1;n=o}return!0}function g(t,e){return(0,c.toA)(t).filter(t=>null!=t).map((t,n)=>({item:t,cmp:(0,l.map)(e(t,n),t=>[t,n])})).filter(t=>null!=t.cmp).sort((t,e)=>(0,a.cmp)(t.cmp,e.cmp)).map(t=>t.item)}},80061(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.cliWrap=a,e.cliWrapVersion=function(){return(0,u.EditionName)()+" v"+s.version},e.cliWrapWithFooter=c,e.addHelpFooter=function(t){return t.addHelpText("afterAll",c())};const r=n(1708),o=n(31586),i=n(51926),u=n(17344),s=n(37805),l=n(84542);function a(t,e){const n=e?.maxLineLen??(0,o.toInt)(r.env.maxLineLen)??r.stdout.columns??75;return(0,i.wrap)(t,{maxLineLen:n,prefix:e?.prefix??""})}function c(...t){return(0,l.joinLines)(...a([...t,"",`Copyright © 2017-${s.gitDate.getFullYear()}, PhotoStructure Inc.`,"","BY USING THIS SOFTWARE, YOU ARE ACCEPTING ALL THE TERMS AND CONDITIONS OF THIS LICENSE: https://photostructure.com/eula/","","User guide: https://photostructure.com/user-guide/","","Questions, bug reports, and feature requests: https://forum.photostructure.com/",""]))}},81168(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.wrap=e.stripSuffix=e.stripPrefix=e.isString=e.includesIgnoreCase=e.equalsIgnoreCase=e.ensureSuffix=e.ensurePrefix=e.ellipsize=e.splitFirst=void 0,e.ensureSuffixIgnoreCase=function(t,e){return null==e||""===e?t:(t=(0,p.toS)(t),e=(0,p.toS)(e),t.endsWith(e)||(0,f.equalsIgnoreCase)(t.slice(-e.length),e)?t:t+e)},e.rightPad=function(t,e,n){if(!n||0===n.length)throw new Error("rightPad() requires a non-empty pad character");const r=String(t);if(r.length>=e)return r;const o=e-r.length;if(n.length>1){let t="";for(let e=0;e<o;e++)t+=n[e%n.length];return r+t}return r+n.repeat(o)},e.padReplace=function(t,e,n,r){return(0,f.strslice)(t,0,e)+(0,a.padding)(r,n)+(0,f.strslice)(t,e+n)},e.contains=function(t,e,n){return null!=t&&null!=e&&(""===t&&""===e||(0,p.toS)(t).indexOf((0,p.toS)(e),n)>-1)},e.countChars=function t(e,n,r=0){if(null==n||0===n.length)return 0;const o=e.indexOf(n,r);return-1===o?0:1+t(e,n,o+n.length)},e.maybeToS=function(t){return null==t?void 0:String(t)},e.trim=function(t){return t.map(p.toS).filter(t=>(0,u.notBlank)(t))},e.splitEvery=function(t,e,n){const r=Math.min(Math.ceil(t.length/e),n??t.length)-1;return r<=0?[t]:[...(0,l.times)(r,n=>t.slice(n*e,(n+1)*e)),t.slice(r*e)]},e.spliceCapture=function(t,e){const n=e.exec(t);if(null==n||null==n[1])return;const r=n[0].indexOf(n[1])+n.index;return{captured:n[1],uncaptured:t.substring(0,r)+t.substring(r+n[1].length),unmatched:t.substring(0,n.index)+t.substring(n.index+n[0].length),matchedIndex:r}},e.stripPrefixIgnoreCase=function(t,e){return M(t=(0,p.toS)(t),e=(0,p.toS)(e))?t.slice(e.length):t},e.stripSuffixIgnoreCase=function(t,e,n={}){if(null==e)return t;const r=(0,p.toS)(t),o=(0,p.toS)(e);return o.length>0&&(0,f.equalsIgnoreCase)(r.slice(-o.length),o,n)?r.slice(0,-o.length):r},e.gist=function(t,e=80,n=80){if(!t)return t;const r=(0,p.toS)(t),o=r.length-(e+n);if(o<=0)return r;const i=r.slice(0,e).trim(),u=r.slice(-n).trim();return`${i} …(+${o.toLocaleString()} chars)… ${u}`},e.isLowerCase=function(t){return(0,p.toS)(t).toLocaleLowerCase()===t},e.isUpperCase=function(t){return(0,p.toS)(t).toLocaleUpperCase()===t},e.isFirstCharAZ=function(t){return S.test((0,p.toS)(t))},e.capitalize=function(t){return t=(0,p.toS)(t),(0,u.blank)(t)?t:(0,f.strslice)(t,0,1).toLocaleUpperCase()+(0,f.strslice)(t,1)},e.compareIgnoreCase=b,e.uniqIgnoreCase=function(t){return(0,o.uniqBy2)(t,f.equalsIgnoreCase)},e.sortIgnoreCase=E,e.firstString=_,e.deepSortIgnoreCase=function t(e){return e.map((e,n)=>({idx:n,ea:Array.isArray(e)?t(e):e})).sort((t,e)=>{const n=_(t.ea),r=_(e.ea);if(null==n)return null==r?0:-1;if(null==r)return 1;const o=b(n,r);if(0!==o)return o;if(Array.isArray(t.ea)&&Array.isArray(e.ea)){const n=t.ea.length-e.ea.length;if(0!==n)return n}return(0,c.cmp)(t.idx,e.idx)}).map(t=>t.ea)},e.sortByCaseInsensitive=function(t,e){return(0,d.toA)(t).filter(t=>null!=t).map((t,n)=>({item:t,idx:n,f:e(t,n)})).filter(t=>null!=t.f).sort((t,e)=>{const n=b(t.f,e.f);return 0!==n?n:(0,c.cmp)(t.idx,e.idx)}).map(t=>t.item)},e.startsWithIgnoreCase=M,e.firstSubstringIgnoreCase=function(t,e){if((0,o.isEmpty)(t)||(0,u.blank)(e))return;for(const n of t)if((0,f.equalsIgnoreCase)(n,e))return{index:0,match:n};for(const n of t){const t=e.indexOf(n);if(t>=0)return{index:t,match:n}}const n=e.normalize();for(const e of t){{const t=n.indexOf(e);if(t>=0)return{index:t,match:e}}const t=e.normalize();{const e=n.indexOf(t);if(e>=0)return{index:e,match:t}}{const e=n.toLowerCase(),r=t.toLowerCase(),o=e.indexOf(r);if(o>=0)return{index:o,match:r}}}},e.reverse=function(t){return null==t?t:[...t].reverse().join("")},e.longestPrefix=function(t,e){return(0,g.greatestBy)(e.filter(e=>t.startsWith(e)),t=>t.length)},e.stripAnsiEsc=function(t){return(0,p.toS)(t).replace(/\u001B\[[\d;]+[a-z]/gi,"")},e.dumbquote=P,e.stripQuotes=function(t){return(0,u.blank)(t)||(t=(0,p.toS)(t).trim(),null!=x.exec(P(t))&&(t=t.slice(1,-1).trim())),t},e.trimQuotes=function(t){return t=(0,p.toS)(t).trim(),I.test(t)||w.test(t)?t.slice(1,-1).trim():t},e.wbrPath=function(t){return t.split(/(?<=[\\/_,:=-])/).map(t=>(0,r.escape)(t.normalize())).join("<wbr>")},e.zipStrings=function(...t){let e="";const n=(0,o.compactBlanks)(t),r=Math.max(...n.map(t=>t.length));for(let t=0;t<r;t++)for(let r=0;r<n.length;r++)(0,s.map)(n[r],n=>(0,s.map)(n[t],t=>e+=t));return e},e.yieldSplit=function*(t,e){if(!t)return;if(!e.global)throw new Error("yieldSplit requires a global regex (with g flag)"+h.NonRetriableErrorFlag);let n,r=0;for(e.lastIndex=0;null!==(n=e.exec(t));)n.index!==e.lastIndex?(yield t.substring(r,e.lastIndex),r=e.lastIndex):e.lastIndex++;r<t.length&&(yield t.substring(r))},e.splitKeep=function(t,e){const n=A(t,e);return(0,g.flatZip)(n.nonSeparators,n.separators).filter(t=>null!=t&&t.length>0)},e.splitUp=A,e.stripDiacritics=function(t){return(0,p.toS)(t).normalize("NFD").replace(/[\u0300-\u036f]/g,"")},e.stripEmoji=function(t){t=(0,p.toS)(t);for(const e of F)t=t.replace(e,"");return t},e.uniqSubstr=function(t){const e=E((0,o.compactBlanks)(t)),n=e.filter((t,n)=>!M(e[n+1],t));return(0,i.sortBy)(n,e=>t.indexOf(e))},e.commonPrefix=function(t,e){if((0,u.blank)(t)||(0,u.blank)(e))return"";const n=Math.min(t.length,e.length);for(let r=0;r<n;r++)if(t[r]!==e[r])return t.slice(0,r);return t.slice(0,n)},e.commonPrefixIgnoreCase=function(t,e,n={}){if((0,u.blank)(t)||(0,u.blank)(e))return"";const r=Math.min(t.length,e.length);for(let o=0;o<r;o++)if(!(0,f.equalsIgnoreCase)(t[o],e[o],n))return t.slice(0,o);return t.slice(0,r)},e.commonPrefixLengthIgnoreCase=function(t,e,n={}){if(n.normalize??=!1,(0,u.blank)(t)||(0,u.blank)(e))return 0;const r=Math.min(t.length,e.length);for(let o=0;o<r;o++)if(!(0,f.equalsIgnoreCase)(t[o],e[o],n))return o;return r},e.indexOfNonSpace=function(t){return t.match(/\S/)?.index},e.lastIndexOfNonSpace=function(t){return t.match(/\S\s*$/)?.index},e.trimLeftPadding=function(t){return t.replace(/^[-0_\s]+/,"")},e.unoctal=function(t){return t.replace(/\\([0-7]{1,3})/g,(t,e)=>{const n=parseInt(e,8);if(n>255||n<32)throw new Error(`Invalid octal sequence: ${t}`);return String.fromCharCode(n)})},e.stripComments=function(t){return t.replace(C,"")},e.uniqPath=function(t,e=":"){const n=new Set;for(const r of(0,d.toA)(t))if(null!=r&&!(0,u.blank)(r))for(const t of r.split(e))(0,u.blank)(t)||n.add(t);return[...n].join(e)},e.dedupeNeedle=function(t,e,n){if((0,u.blank)(e))return t;const r=new RegExp("(['\"]?)"+(0,m.escapeRegExp)(e)+"\\1","gm"),o=t.findIndex(t=>r.test(t)),i=new RegExp("("+(0,m.escapeRegExp)(n)+"[,:\\s]*){2,}","gim");if(o<0)return t;for(let e=o+1;e<t.length;e++)t[e]=t[e].replace(r,n).replace(/\s{2,}/g," ").replace(i,n).trim();return t},e.splitUniq=function(t,e){return(0,o.uniq)((0,o.compactBlanks)(t.join(e).split(e).map(t=>t.trim())))};const r=n(28787),o=n(40958),i=n(76790),u=n(22573),s=n(55835),l=n(31586),a=n(39926),c=n(34666),f=n(51926),d=n(59455),p=n(54993),g=n(48884),m=n(68852),h=n(38835);var y=n(38453);Object.defineProperty(e,"splitFirst",{enumerable:!0,get:function(){return y.splitFirst}});var v=n(51926);Object.defineProperty(e,"ellipsize",{enumerable:!0,get:function(){return v.ellipsize}}),Object.defineProperty(e,"ensurePrefix",{enumerable:!0,get:function(){return v.ensurePrefix}}),Object.defineProperty(e,"ensureSuffix",{enumerable:!0,get:function(){return v.ensureSuffix}}),Object.defineProperty(e,"equalsIgnoreCase",{enumerable:!0,get:function(){return v.equalsIgnoreCase}}),Object.defineProperty(e,"includesIgnoreCase",{enumerable:!0,get:function(){return v.includesIgnoreCase}}),Object.defineProperty(e,"isString",{enumerable:!0,get:function(){return v.isString}}),Object.defineProperty(e,"stripPrefix",{enumerable:!0,get:function(){return v.stripPrefix}}),Object.defineProperty(e,"stripSuffix",{enumerable:!0,get:function(){return v.stripSuffix}}),Object.defineProperty(e,"wrap",{enumerable:!0,get:function(){return v.wrap}});const S=/^[A-Z]/;function b(t,e){return t.localeCompare(e,void 0,{sensitivity:"base"})}function E(t){return(0,i.sortBy)(t,t=>null==t?void 0:[t.toLocaleLowerCase(),t])}function _(t){return null==t?void 0:(0,f.isString)(t)?t:Array.isArray(t)?(0,g.first)(t,_):void 0}function M(t,e){return null!=t&&null!=e&&0!==e.length&&0!==t.length&&(0,f.equalsIgnoreCase)(t.substring(0,e.length),e)}const O=[[/[‘’]/g,"'"],[/[“”„«»〃]/g,'"']];function P(t){return O.reduce((t,[e,n])=>t.replace(e,n),t).normalize()}const x=/^(['"]).+\1$/,I=/^['‘’].*['‘’]$/,w=/^["“”„«»〃].*["“”„«»〃]$/;function A(t,e){if(!e.global)throw new Error("bad regex (missing global flag)"+h.NonRetriableErrorFlag);const n=[],r=[];let o,i=0;for(;null!=(o=e.exec(t));)o.index===e.lastIndex?e.lastIndex++:(e.lastIndex=o[0].length+o.index,n.push(t.substring(i,o.index)),r.push(t.substring(o.index,e.lastIndex)),i=e.lastIndex);return i<t.length&&n.push(t.substring(i)),{nonSeparators:n,separators:r}}const F=[/\ud83d[\ude00-\ude4f]/g,/\ud83c[\udf00-\udfff]/g,/\ud83d[\udc00-\uddff]/g,/\ud83d[\ude80-\udeff]/g,/\ud83c[\udde6-\uddff]/g,/[\u2600-\u27ff]\ufe0f?/g,/\ud83c[\ude01\ude02]/g,/\ud83c[\ude1a-\ude1f]/g,/[\u0023-\u0039]\ufe0f?\u20e3/g,/[\u3299\u3297\u303d\u3030\u24c2]|\ud83c[\udd70\udd71]/g,/\ud83c[\udd7e\udd7f]/g,/\ud83c\udd8e/g,/\ud83c[\udd91-\udd9a]/g,/\ud83c[\udde6-\uddff]/g,/[\u2702-\u27b0]/g,/\ud83e[\udd00-\uddff]/g,/[\u200D\uFE0F\u20E3]/g,/[\u2640\u2642\u26A7]/g,/\ud83c[\udffb-\udfff]/g],C=/#.*$/gm},83556(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.camel2snake=function(t){return(0,r.toS)(t).replace(/([A-Z])([a-z])/g,(t,e,n)=>"_"+e.toLowerCase()+n).replace(/[A-Z]+|\d+/g,t=>"_"+t).replace(/^_/,"").replace(/_+/g,"_")},e.camel2words=function(t){return(0,r.toS)(t).replace(/([A-Z])([a-z])/g,(t,e,n)=>" "+e.toLowerCase()+n).replace(/[A-Z]+|\d+/g,t=>" "+t).trim()},e.snake2camel=o,e.asObjectKey=function(t){return o(t.replace(/^[A-Z]+/,t=>t.toLowerCase()).replace(/[^a-z]+/gi,"_"))};const r=n(54993);function o(t){return(0,r.toS)(t).replace(/_([A-Z])/gi,(t,e)=>e.toUpperCase())}},84542(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.Newline=void 0,e.crlf=function(...t){const e=t.map(u.toS).join("\n");return s.isWin?e.replace((0,i.newlineRe)(),"\r\n"):e},e.splitLines=l,e.joinLines=function(...t){return l(...t).join(e.Newline)},e.splitCompactLines=function(...t){return(0,r.compactBlanks)(l(...t))};const r=n(40958),o=n(96249),i=n(51926),u=n(54993),s=n(43334);function l(...t){return(0,o.flatten)(t.map(t=>Array.isArray(t)?l(...t):(0,u.toS)(t).split((0,i.newlineRe)())))}e.Newline=s.isWin?"\r\n":"\n"},84885(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.stringifySorted=function(t){return(0,r.stringify)((0,o.sortedKeys)(t))};const r=n(98553),o=n(88158)},88158(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.definedThunks=function(...t){return t.every(t=>(0,s.defined)(t()))},e.firstThunk=function(...t){for(const e of t){const t=e();if(null!=t)return t}},e.firstTrueThunk=function(t,e){for(const n of t){const t=n();if(null!=t&&(null==e||e(t)))return t}},e.firstDefined=function(...t){return t.find(s.defined)},e.firstDefinedField=function(t,...e){return(0,s.map)(e.find(e=>null!=t[e]),e=>t[e])},e.firstFieldLike=function(t,e){return(0,d.first)((0,a.keys)(t),n=>e(n,t[n])?t[n]:void 0)},e.ornull=function(t){return void 0===t?null:t},e.mapAnd=function(t,e){return null!=t&&e(t)},e.mapOrThrow=function(t,e,n){if(null!=t)return e(t);throw new Error(n)},e.Try=g,e.tryEach=function(t,e){[...t].forEach(t=>g(()=>e(t)))},e.identity=function(t){return t},e.ctor=function(t){return(0,s.map)(t.constructor,t=>t.name)},e.hasKeys=function(t){return Object.keys(t).some(e=>"string"==typeof e&&t.propertyIsEnumerable(e))},e.primitiveEntries=m,e.spread=function(t,...e){return Object.assign({},t,...(0,r.compact)(e))},e.assignMissingPrimitives=function(t,e){if(null==e)return t;for(const[n,r]of m(e))null==t[n]&&(t[n]=r);return t},e.assignNullishFields=function(t,e){if(null==e)return t;for(const[n,r]of(0,a.entries)(e))(null==t[n]||(0,o.blank)(t[n]))&&(t[n]=r);return t},e.pickMap=function(t,e,n){const r={};for(const o of e)r[o]=n(o,t[o]);return r},e.mapEntries=h,e.mapNullEntries=function(t,e,n){const r={};let o=0;for(const i of(0,a.keys)(t))if(r[i]=e(i,t[i]),o++,(0,l.gt)(o,n))break;return r},e.sortedKeys=function t(e){if(null==e||(0,c.isPrimitive)(e))return e;if(Array.isArray(e))return e.map(e=>t(e));if("object"==typeof e){const n={};for(const r of(0,p.sortIgnoreCase)((0,a.keys)(e)))n[r]=t(e[r]);return n}return e},e.deepDelete=function t(e,...n){return null==e||"object"!=typeof e?e:Array.isArray(e)?e.map(e=>t(e,...n)):h(e,(e,r)=>n.includes(e)?void 0:t(r,...n))},e.pluckCaseInsensitive=function(t,e){if("object"==typeof t){if(void 0!==t[e])return t[e];for(const n of(0,a.keys)(t).filter(t=>(0,p.equalsIgnoreCase)(t,e)))if(void 0!==t[n])return t[n]}},e.pairToObject=function(t,e){const n={};return n[t]=e,n},e.zipPojos=function(...t){const e={};for(const n of(0,r.uniq)((0,u.flatten)(t.map(a.keys))))e[n]=t.map(t=>t?.[n]);return e},e.downcaseObjectKeys=function t(e){if(null==e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(e=>t(e));const n={};for(const[r,o]of(0,a.entries)(e))n[r.toLowerCase()]=t(o);return n};const r=n(40958),o=n(22573),i=n(42659),u=n(96249),s=n(55835),l=n(31586),a=n(68708),c=n(34666),f=n(70978),d=n(48884),p=n(81168);function g(t,e){try{return t()}catch(t){return e?.((0,f.toError)(t))}}function m(t){return(0,a.keys)(t).filter(e=>(0,c.isPrimitive)(t[e])||(0,i.isDate)(t[e])).map(e=>[e,t[e]])}function h(t,e){const n={};for(const[r,o]of(0,a.entries)(t)){const t=e(r,o);null!=t&&(n[r]=t)}return n}},92636(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=n(6858),i=r(n(73024)),u=n(76760),s=n(1708),l=n(37805),a=n(41269),c=n(80061),f=n(96706);function d(t){for(const e of[__dirname,(0,u.dirname)(s.execPath)])for(const n of[(0,u.join)(e,"bin",t),(0,u.join)(e,t)])if(i.default.existsSync(n))return n;return console.error("failed to find command "+t),t}o.program.version(l.version),o.program.description("Welcome to PhotoStructure, your new home for all your photos and videos.\nFor more details, see https://photostructure.com/server/tools"),(0,f.isEnvTrue)("PS_FROM_SH")&&(o.program.option("--reinstall","Re-install PhotoStructure's third-party dependencies."),o.program.option("--debug","Emit debugging information to console (danger: noisy!)")),(0,c.addHelpFooter)(o.program).command("main",a.CliDesc.main+" (default)",{isDefault:!0,executableFile:d("main.js")}).command("info",a.CliDesc.info,{executableFile:d("info.js")}).command("fix",a.CliDesc.fix,{executableFile:d("fix.js")}).command("list",a.CliDesc.list,{executableFile:d("list.js")}).command("logcat",a.CliDesc.logcat,{executableFile:d("logcat.js")}).command("logtail",a.CliDesc.logtail,{executableFile:d("logtail.js")}).command("web",a.CliDesc.web,{executableFile:d("web.js")}).command("sync",a.CliDesc.sync,{executableFile:d("sync.js")}).parse(s.argv)},96249(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.flatten=function(t,e=[]){for(const n of(0,r.toA)(t))if(null!=n)for(const t of(0,r.toA)(n))null!=t&&e.push(t);return e};const r=n(59455)},96706(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.getEnv=u,e.isEnvTrue=function(t){return(0,r.isTrue)(u(t))},e.isEnvFalse=function(t){return(0,r.isFalse)(u(t))},e.setEnv=function(t,e){null==e?s(t):process.env[t]=e},e.deleteEnv=s;const r=n(38639),o=n(81168),i=n(83556);function u(t){for(const e of new Set([t,(0,o.ensurePrefix)((0,i.camel2snake)(t).toUpperCase(),"PS_")])){const t=process.env[e];if(null!=t)return t}}function s(t){delete process.env[t]}},98553(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.JsonRevivableClasses=void 0,e.toJsonObject=l,e.stringify=a,e.stringifyPretty=function(t,e=2){return a(t,e)},e.fromJsonObject=c,e.parseJSON_=f,e.parseJSON=function(t){try{return null==t||(0,r.blank)(t)?void 0:f(t)}catch{return}};const r=n(22573),o=n(45599),i=n(23838),u=n(31586),s=n(68708);function l(t){return(new S).apply(t)}function a(t,e){return JSON.stringify(l(t),void 0,e)}function c(t){return null==t?t:(new b).apply(t)}function f(t){return c(JSON.parse(t.toString().trim()))}class d{static classes=new Map;static add(t){this.classes.set(t.name,t),this.revivableClassNames.reset()}static getClass(t){return(0,r.blank)(t)?void 0:this.classes.get(t)}static revivableClassNames=(0,o.defer)(()=>["Map","Set","Array",...this.classes.keys()]);static isRevivable(t){return this.revivableClassNames().includes(t.constructor?.name)}static addDefaults(){this.add({name:"Date",is:t=>t instanceof Date,toJSON:t=>({ts:t.getTime()}),fromJSON:t=>(0,u.mapInt)(t?.ts,t=>new Date(t))}),this.add({name:"RegExp",is:t=>t instanceof RegExp,toJSON:t=>({source:t.source,flags:t.flags}),fromJSON:t=>new RegExp(t.source,t.flags)}),this.add({name:"Error",is:t=>t instanceof Error,toJSON:t=>(0,s.pick)(t,"message","stack","code","errno"),fromJSON(t){const e=new Error(t.message);return e.stack=t.stack,e.code=t.code,e.errno=t.errno,e}}),this.add({name:BigInt.name,is:t=>(0,u.isBigInt)(t),toJSON:t=>({n:t.toString()}),fromJSON:t=>BigInt(t.n)})}}e.JsonRevivableClasses=d,d.addDefaults();const p="_id",g="_ref",m="_ctor",h="_id[]",y=["object","bigint"];function v(t){return null!=t&&y.includes(typeof t)}class S{idCount=0;maxIdObjs=new Set;objects=new Map;idAdders=new i.MultiMap;usedRefIds=new Set;apply(t){this.findMaxId(t),this.maxIdObjs.clear();const e=this._decycle(t);return this.finalize(),this.objects.clear(),this.idAdders.clear(),this.usedRefIds.clear(),e}maybeIncrIdCount(t){(0,u.gt)(t,this.idCount)&&(this.idCount=t+1)}findMaxId(t){if(v(t)&&!this.maxIdObjs.has(t))if(this.maxIdObjs.add(t),Array.isArray(t)){let e=0;t.length>0&&(0,s.isObject)(t[e])&&h in t[e]&&(this.maybeIncrIdCount(t[e]?.[h]),e++);for(;e<t.length;e++)this.findMaxId(t[e])}else if((0,s.isObject)(t)){this.maybeIncrIdCount(t[p]);for(const e of(0,s.propertyNames)(t))this.findMaxId(t[e])}}getId(t){return Array.isArray(t)?(0,u.toGt0)(t[0]?.[h]):(0,s.isObject)(t)?(0,u.toGt0)(t[p]):void 0}_decycle(t){if(!v(t))return t;const e=this.objects.get(t);if(null!=e)return this.usedRefIds.add(e),(0,s.fromEntries)([[g,e]]);const n=this.getId(t),r=n??++this.idCount;if(this.objects.set(t,r),Array.isArray(t)){const e=[];for(let n=0;n<t.length;n++)e[n]=this._decycle(t[n]);return null==n&&this.idAdders.add(r,()=>e.unshift((0,s.fromEntries)([[h,r]]))),e}const o={};this.objects.set(o,r);const i=t.constructor?.name;if(t.constructor!==Object&&(o[m]=i),null==n&&this.idAdders.add(r,()=>o[p]=r),t instanceof Map)o._=[...t.entries()].map(([t,e])=>[this._decycle(t),this._decycle(e)]);else if(t instanceof Set)o._=[...t.values()].map(t=>this._decycle(t));else{const e=d.getClass(i),n=e?.toJSON?.(t)??t.toJSON?.()??t;for(const t of(0,s.propertyNames)(n))o[t]=this._decycle(n[t])}return o}finalize(){for(const t of this.usedRefIds)for(const e of this.idAdders.get(t)??[])e()}}class b{objectsById=new Map;later=new i.MultiMap;apply(t){const e=this.vivify(t);return this.resolveDeferredReferences(),e}getRefId(t){return(0,s.isObject)(t)?(0,u.toGt0)(t[g]):void 0}ifRefIdResolved(t,e){const n=this.getRefId(t);return null!=n&&(this.objectsById.has(n)?e(this.objectsById.get(n)):this.later.add(n,()=>e(this.objectsById.get(n))),!0)}vivify(t){if(!v(t))return t;if(null!=this.getRefId(t))throw new Error("Reference ID found in root object");if(Array.isArray(t)){const e=[];let n;t.length>0&&(0,s.isObject)(t[0])&&h in t[0]&&(n=t.shift()[h],this.objectsById.set(n,e));for(let n=0;n<t.length;n++)this.ifRefIdResolved(t[n],t=>e[n]=t)||(e[n]=this.vivify(t[n]));return e}const e=t[p],n=t[m],r=d.getClass(n),o="function"==typeof r?.fromJSON;let i;if(i="Map"===n?new Map:"Set"===n?new Set:{},(0,u.gt0)(e)&&!o&&this.objectsById.set(e,i),i instanceof Map)for(const[e,n]of t._){const t=this.vivify(e);this.ifRefIdResolved(n,e=>i.set(t,e))||i.set(t,this.vivify(n))}else if(i instanceof Set)for(const e of t._)this.ifRefIdResolved(e,t=>i.add(t))||i.add(this.vivify(e));else if(!(i instanceof Date||i instanceof RegExp))for(const e of Object.keys(t))e!==p&&e!==m&&(this.ifRefIdResolved(t[e],t=>i[e]=t)||(i[e]=this.vivify(t[e])));return o&&(i=r.fromJSON(i),(0,u.gt0)(e)&&this.objectsById.set(e,i)),i}resolveDeferredReferences(){const t=this.later.keyCount();for(let e=0;e<t;e++)for(const t of this.later.keys())if(this.objectsById.has(t)){const e=this.later.get(t);if(null!=e){this.later.delete(t);for(const t of e)t()}}}}}},e={},n=function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}(92636);module.exports=n})();